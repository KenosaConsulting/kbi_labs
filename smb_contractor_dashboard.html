<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KBI Labs - SMB Government Contractor Intelligence Platform</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-blue: #2563eb;
            --success-green: #10b981;
            --warning-orange: #f59e0b;
            --danger-red: #ef4444;
            --gray-50: #f8fafc;
            --gray-100: #f1f5f9;
            --gray-200: #e2e8f0;
            --gray-300: #cbd5e1;
            --gray-400: #94a3b8;
            --gray-500: #64748b;
            --gray-600: #475569;
            --gray-700: #334155;
            --gray-800: #1e293b;
            --gray-900: #0f172a;
        }

        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Inter', sans-serif;
            background: var(--gray-50);
            color: var(--gray-800);
            line-height: 1.6;
            font-size: 14px;
        }
        
        .app-container {
            display: flex;
            min-height: 100vh;
        }
        
        /* SIDEBAR STYLES */
        .sidebar {
            width: 280px;
            background: white;
            border-right: 1px solid var(--gray-200);
            display: flex;
            flex-direction: column;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        .logo {
            padding: 24px;
            border-bottom: 1px solid var(--gray-200);
            background: linear-gradient(135deg, var(--primary-blue) 0%, #764ba2 100%);
            color: white;
        }
        
        .logo h1 {
            font-size: 1.25rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .logo .subtitle {
            font-size: 0.75rem;
            opacity: 0.8;
            margin-top: 4px;
        }
        
        .nav-menu {
            flex: 1;
            padding: 16px 0;
        }

        .nav-section {
            margin-bottom: 24px;
        }

        .nav-section-title {
            padding: 8px 24px;
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--gray-500);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 24px;
            color: var(--gray-600);
            cursor: pointer;
            transition: all 0.2s;
            border-left: 3px solid transparent;
            font-weight: 500;
        }
        
        .nav-item:hover, .nav-item.active {
            background: var(--gray-100);
            color: var(--primary-blue);
            border-left-color: var(--primary-blue);
        }
        
        .nav-item i {
            width: 16px;
            text-align: center;
        }

        .nav-item .badge {
            margin-left: auto;
            background: var(--danger-red);
            color: white;
            font-size: 0.625rem;
            padding: 2px 6px;
            border-radius: 10px;
            font-weight: 600;
        }
        
        /* MAIN CONTENT STYLES */
        .main-content {
            flex: 1;
            overflow: auto;
            background: var(--gray-50);
        }
        
        .top-bar {
            background: white;
            padding: 16px 32px;
            border-bottom: 1px solid var(--gray-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        .top-bar h2 {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--gray-800);
        }

        .search-bar {
            flex: 1;
            max-width: 400px;
            margin: 0 32px;
            position: relative;
        }

        .search-bar input {
            width: 100%;
            padding: 10px 16px 10px 40px;
            border: 1px solid var(--gray-300);
            border-radius: 8px;
            font-size: 14px;
            background: var(--gray-50);
        }

        .search-bar i {
            position: absolute;
            left: 14px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray-400);
        }
        
        .top-bar-actions {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .notification-bell {
            position: relative;
            cursor: pointer;
            padding: 8px;
            border-radius: 6px;
            transition: background-color 0.2s;
        }

        .notification-bell:hover {
            background: var(--gray-100);
        }

        .notification-bell .badge {
            position: absolute;
            top: 4px;
            right: 4px;
            background: var(--danger-red);
            color: white;
            font-size: 0.625rem;
            padding: 2px 5px;
            border-radius: 8px;
            font-weight: 600;
        }
        
        .btn {
            padding: 8px 16px;
            border-radius: 8px;
            border: 1px solid var(--gray-300);
            background: white;
            color: var(--gray-700);
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 14px;
        }
        
        .btn:hover {
            background: var(--gray-50);
            border-color: var(--gray-400);
        }
        
        .btn-primary {
            background: var(--primary-blue);
            color: white;
            border-color: var(--primary-blue);
        }
        
        .btn-primary:hover {
            background: #1d4ed8;
        }

        .btn-success {
            background: var(--success-green);
            color: white;
            border-color: var(--success-green);
        }

        .btn-danger {
            background: var(--danger-red);
            color: white;
            border-color: var(--danger-red);
        }

        .btn-sm {
            padding: 6px 12px;
            font-size: 12px;
        }
        
        .content-area {
            padding: 32px;
        }

        /* DASHBOARD GRID */
        .dashboard-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 24px;
            margin-bottom: 32px;
        }

        .dashboard-left {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        .dashboard-right {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }
        
        /* KPI CARDS */
        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }
        
        .kpi-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--gray-200);
            position: relative;
            overflow: hidden;
        }

        .kpi-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--primary-blue);
        }

        .kpi-card.success::before { background: var(--success-green); }
        .kpi-card.warning::before { background: var(--warning-orange); }
        .kpi-card.danger::before { background: var(--danger-red); }
        
        .kpi-header {
            display: flex;
            justify-content: space-between;
            align-items:lex-start;
            margin-bottom: 12px;
        }
        
        .kpi-title {
            font-size: 0.875rem;
            color: var(--gray-600);
            font-weight: 500;
        }
        
        .kpi-icon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 14px;
        }
        
        .kpi-value {
            font-size: 1.875rem;
            font-weight: 700;
            color: var(--gray-800);
            margin-bottom: 8px;
            line-height: 1;
        }
        
        .kpi-change {
            font-size: 0.75rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .kpi-change.positive { color: var(--success-green); }
        .kpi-change.negative { color: var(--danger-red); }
        .kpi-change.neutral { color: var(--gray-500); }

        /* CARDS */
        .card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--gray-200);
            overflow: hidden;
        }
        
        .card-header {
            padding: 20px 24px;
            border-bottom: 1px solid var(--gray-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .card-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--gray-800);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .card-content {
            padding: 24px;
        }

        /* GO/NO-GO DECISION CARDS */
        .decision-grid {
            display: grid;
            gap: 16px;
        }

        .opportunity-card {
            background: white;
            border: 2px solid var(--gray-200);
            border-radius: 12px;
            padding: 20px;
            transition: all 0.2s;
            cursor: pointer;
        }

        .opportunity-card:hover {
            border-color: var(--primary-blue);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.1);
        }

        .opportunity-card.go {
            border-color: var(--success-green);
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.05) 0%, white 100%);
        }

        .opportunity-card.no-go {
            border-color: var(--danger-red);
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.05) 0%, white 100%);
        }

        .opportunity-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
        }

        .opportunity-title {
            font-weight: 600;
            color: var(--gray-800);
            font-size: 1rem;
            line-height: 1.3;
            margin-bottom: 4px;
        }

        .opportunity-agency {
            font-size: 0.875rem;
            color: var(--gray-600);
        }

        .decision-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.025em;
        }

        .decision-badge.go {
            background: var(--success-green);
            color: white;
        }

        .decision-badge.no-go {
            background: var(--danger-red);
            color: white;
        }

        .decision-badge.analyze {
            background: var(--warning-orange);
            color: white;
        }

        .opportunity-meta {
            display: flex;
            gap: 16px;
            margin: 12px 0;
            font-size: 0.875rem;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 4px;
            color: var(--gray-600);
        }

        .ai-score {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 0;
            border-top: 1px solid var(--gray-200);
            margin-top: 12px;
        }

        .score-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.875rem;
            color: white;
        }

        .score-circle.high { background: var(--success-green); }
        .score-circle.medium { background: var(--warning-orange); }
        .score-circle.low { background: var(--danger-red); }

        .score-details {
            flex: 1;
        }

        .score-label {
            font-size: 0.75rem;
            color: var(--gray-500);
            text-transform: uppercase;
            letter-spacing: 0.025em;
            font-weight: 500;
        }

        .score-text {
            font-weight: 600;
            color: var(--gray-800);
        }

        /* AGENCY PROFILE WIDGET */
        .agency-profile {
            padding: 16px;
            background: var(--gray-50);
            border-radius: 8px;
            margin-bottom: 16px;
        }

        .agency-name {
            font-weight: 600;
            color: var(--gray-800);
            margin-bottom: 8px;
        }

        .agency-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            font-size: 0.875rem;
        }

        .agency-stat {
            display: flex;
            justify-content: space-between;
        }

        .stat-label {
            color: var(--gray-600);
        }

        .stat-value {
            font-weight: 600;
            color: var(--gray-800);
        }

        /* TABLES */
        .table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .table th,
        .table td {
            text-align: left;
            padding: 12px;
            border-bottom: 1px solid var(--gray-200);
        }
        
        .table th {
            font-weight: 600;
            color: var(--gray-700);
            background: var(--gray-50);
            font-size: 0.875rem;
        }

        .table tr:hover {
            background: var(--gray-50);
        }

        /* BADGES */
        .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 500;
        }
        
        .badge-success {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success-green);
        }
        
        .badge-warning {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning-orange);
        }
        
        .badge-info {
            background: rgba(37, 99, 235, 0.1);
            color: var(--primary-blue);
        }

        .badge-danger {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger-red);
        }

        /* LOADING & EMPTY STATES */
        .loading {
            text-align: center;
            padding: 40px;
            color: var(--gray-500);
        }
        
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--gray-500);
        }
        
        .empty-state i {
            font-size: 3rem;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        /* RESPONSIVE */
        @media (max-width: 1200px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .app-container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: auto;
            }
            
            .kpi-grid {
                grid-template-columns: 1fr;
            }

            .content-area {
                padding: 16px;
            }

            .search-bar {
                display: none;
            }
        }

        /* ANIMATIONS */
        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* CUSTOM SCROLLBAR */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--gray-100);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--gray-300);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--gray-400);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useCallback } = React;

        // Utility functions
        const formatCurrency = (amount) => {
            if (amount >= 1000000) {
                return `$${(amount / 1000000).toFixed(1)}M`;
            } else if (amount >= 1000) {
                return `$${(amount / 1000).toFixed(0)}K`;
            }
            return `$${amount.toLocaleString()}`;
        };

        const formatDate = (dateString) => {
            return new Date(dateString).toLocaleDateString('en-US', {
                month: 'short',
                day: 'numeric',
                year: 'numeric',
            });
        };

        const getDaysUntil = (dateString) => {
            const date = new Date(dateString);
            const now = new Date();
            const diffTime = date.getTime() - now.getTime();
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            return diffDays;
        };

        const getScoreClass = (score) => {
            if (score >= 0.7) return 'high';
            if (score >= 0.4) return 'medium';
            return 'low';
        };

        const getDecisionType = (score, daysLeft, value) => {
            if (score >= 0.75 && daysLeft > 7) return 'go';
            if (score <= 0.3 || daysLeft < 3) return 'no-go';
            return 'analyze';
        };

        // Mock data for SMB contractor workflow
        const mockAgencyData = {
            'Department of Defense': {
                totalSpending: 145000000,
                avgContractSize: 2500000,
                smallBusinessRate: 0.23,
                competitionRate: 0.67,
                avgTimeToAward: 89
            },
            'Department of Homeland Security': {
                totalSpending: 78000000,
                avgContractSize: 1800000,
                smallBusinessRate: 0.31,
                competitionRate: 0.54,
                avgTimeToAward: 76
            },
            'NASA': {
                totalSpending: 34000000,
                avgContractSize: 950000,
                smallBusinessRate: 0.28,
                competitionRate: 0.71,
                avgTimeToAward: 92
            }
        };

        // API functions - Connected to Real Government Intelligence APIs
        const api = {
            async fetchOpportunities(filters = {}) {
                try {
                    const response = await fetch('/api/government-intelligence/procurement-opportunities');
                    if (!response.ok) throw new Error('Failed to fetch opportunities');
                    const data = await response.json();
                    return data.data?.active_opportunities || [];
                } catch (error) {
                    console.error('Error fetching opportunities:', error);
                    return [];
                }
            },

            async fetchDashboardMetrics() {
                try {
                    const response = await fetch('/api/government-intelligence/comprehensive-intelligence');
                    if (!response.ok) throw new Error('Failed to fetch comprehensive intelligence');
                    const data = await response.json();
                    
                    // Transform comprehensive intelligence to dashboard metrics format
                    const intelligence = data.data || {};
                    return {
                        totalOpportunities: intelligence.executive_summary?.active_opportunities || 0,
                        totalValue: intelligence.executive_summary?.estimated_opportunity_value || 0,
                        avgContractSize: intelligence.market_opportunities?.active_opportunities?.length > 0 ? 
                            intelligence.executive_summary?.estimated_opportunity_value / intelligence.executive_summary?.active_opportunities : 0,
                        activeAgencies: intelligence.digital_intelligence?.top_digital_agencies?.length || 0,
                        smallBusinessOpps: intelligence.market_opportunities?.small_business_opportunities?.length || 0,
                        upcomingDeadlines: Math.floor(intelligence.executive_summary?.active_opportunities * 0.3) || 0,
                        congressionalBills: intelligence.executive_summary?.congressional_bills_tracked || 0,
                        activeRegulations: intelligence.executive_summary?.contractor_relevant_regulations || 0,
                        digitalMaturityScore: intelligence.digital_intelligence?.digital_maturity_score || 0,
                        federalWebsites: intelligence.executive_summary?.total_federal_websites || 0
                    };
                } catch (error) {
                    console.error('Error fetching dashboard metrics:', error);
                    return {
                        totalOpportunities: 0,
                        totalValue: 0,
                        avgContractSize: 0,
                        activeAgencies: 0,
                        smallBusinessOpps: 0,
                        upcomingDeadlines: 0,
                        congressionalBills: 0,
                        activeRegulations: 0,
                        digitalMaturityScore: 0,
                        federalWebsites: 0
                    };
                }
            },

            async fetchCongressionalIntelligence() {
                try {
                    const response = await fetch('/api/government-intelligence/congressional-intelligence');
                    if (!response.ok) throw new Error('Failed to fetch congressional intelligence');
                    const data = await response.json();
                    return data.data || {};
                } catch (error) {
                    console.error('Error fetching congressional intelligence:', error);
                    return {};
                }
            },

            async fetchRegulatoryIntelligence() {
                try {
                    const response = await fetch('/api/government-intelligence/regulatory-intelligence');
                    if (!response.ok) throw new Error('Failed to fetch regulatory intelligence');
                    const data = await response.json();
                    return data.data || {};
                } catch (error) {
                    console.error('Error fetching regulatory intelligence:', error);
                    return {};
                }
            },

            async fetchFederalWebsites() {
                try {
                    const response = await fetch('/api/government-intelligence/federal-websites');
                    if (!response.ok) throw new Error('Failed to fetch federal websites');
                    const data = await response.json();
                    return data.data || {};
                } catch (error) {
                    console.error('Error fetching federal websites:', error);
                    return {};
                }
            },

            async fetchEnhancedGSAIntelligence() {
                try {
                    const response = await fetch('/api/government-intelligence/enhanced-gsa-intelligence');
                    if (!response.ok) throw new Error('Failed to fetch enhanced GSA intelligence');
                    const data = await response.json();
                    return data.data || {};
                } catch (error) {
                    console.error('Error fetching enhanced GSA intelligence:', error);
                    return {};
                }
            },

            async fetchGovInfoIntelligence() {
                try {
                    const response = await fetch('/api/government-intelligence/govinfo-intelligence');
                    if (!response.ok) throw new Error('Failed to fetch GovInfo intelligence');
                    const data = await response.json();
                    return data.data || {};
                } catch (error) {
                    console.error('Error fetching GovInfo intelligence:', error);
                    return {};
                }
            },

            async fetchAgencyOpportunities(agencyName) {
                try {
                    const response = await fetch(`/api/government-intelligence/agency-opportunities/${encodeURIComponent(agencyName)}`);
                    if (!response.ok) throw new Error(`Failed to fetch opportunities for ${agencyName}`);
                    const data = await response.json();
                    return data.data || [];
                } catch (error) {
                    console.error(`Error fetching agency opportunities for ${agencyName}:`, error);
                    return [];
                }
            },

            async analyzeOpportunity(opportunityId) {
                // Enhanced opportunity analysis using AI scoring from our SAM integration
                try {
                    const opportunities = await this.fetchOpportunities();
                    const opportunity = opportunities.find(opp => opp.notice_id === opportunityId);
                    
                    if (!opportunity) {
                        throw new Error('Opportunity not found');
                    }

                    return {
                        opportunityId: opportunityId,
                        probability: opportunity.ai_score || 0.5,
                        confidence: 0.8,
                        factors: {
                            naics_match: opportunity.naics_code ? true : false,
                            set_aside_eligible: opportunity.set_aside_code?.toLowerCase().includes('small business') || false,
                            estimated_value: opportunity.estimated_value || 0,
                            deadline_proximity: opportunity.response_deadline ? this.calculateDeadlineProximity(opportunity.response_deadline) : 0.5
                        },
                        recommendations: [
                            `AI Score: ${(opportunity.ai_score * 100).toFixed(1)}%`,
                            `Contract Value: $${(opportunity.estimated_value || 0).toLocaleString()}`,
                            `Agency: ${opportunity.department || 'Unknown'}`,
                            opportunity.set_aside_code ? `Set-aside: ${opportunity.set_aside_code}` : 'Open competition'
                        ]
                    };
                } catch (error) {
                    console.error('Error analyzing opportunity:', error);
                    return {
                        opportunityId: opportunityId,
                        probability: 0.5,
                        confidence: 0.5,
                        factors: {},
                        recommendations: ['Analysis unavailable']
                    };
                }
            },

            calculateDeadlineProximity(deadlineStr) {
                try {
                    const deadline = new Date(deadlineStr);
                    const now = new Date();
                    const daysUntilDeadline = (deadline - now) / (1000 * 60 * 60 * 24);
                    
                    if (daysUntilDeadline < 0) return 0; // Past deadline
                    if (daysUntilDeadline > 60) return 1; // Far future
                    return Math.max(0, 1 - (daysUntilDeadline / 60)); // Scale 0-1
                } catch {
                    return 0.5;
                }
            },

            async checkAPIHealth() {
                try {
                    const response = await fetch('/api/government-intelligence/health');
                    if (!response.ok) throw new Error('Health check failed');
                    return await response.json();
                } catch (error) {
                    console.error('API health check failed:', error);
                    return { overall_status: 'unhealthy', error: error.message };
                }
            }
        };

        // Components
        const Sidebar = ({ activeView, setActiveView }) => {
            const coreItems = [
                { id: 'dashboard', label: 'Dashboard', icon: 'fas fa-chart-line' },
                { id: 'opportunities', label: 'Go/No-Go Analysis', icon: 'fas fa-crosshairs', badge: '12' },
                { id: 'pipeline', label: 'Active Pipeline', icon: 'fas fa-stream' },
            ];

            const analysisItems = [
                { id: 'agencies', label: 'Agency Intelligence', icon: 'fas fa-building' },
                { id: 'competitors', label: 'Competitive Intel', icon: 'fas fa-users' },
                { id: 'market', label: 'Market Analysis', icon: 'fas fa-chart-area' },
                { id: 'policy', label: 'Policy & Regulatory', icon: 'fas fa-balance-scale' },
            ];

            const toolsItems = [
                { id: 'reports', label: 'Reports & Exports', icon: 'fas fa-file-alt' },
                { id: 'alerts', label: 'Smart Alerts', icon: 'fas fa-bell' },
                { id: 'settings', label: 'Settings', icon: 'fas fa-cog' },
            ];

            const NavSection = ({ title, items }) => (
                <div className="nav-section">
                    <div className="nav-section-title">{title}</div>
                    {items.map(item => (
                        <div
                            key={item.id}
                            className={`nav-item ${activeView === item.id ? 'active' : ''}`}
                            onClick={() => setActiveView(item.id)}
                        >
                            <i className={item.icon}></i>
                            <span>{item.label}</span>
                            {item.badge && <span className="badge">{item.badge}</span>}
                        </div>
                    ))}
                </div>
            );

            return (
                <div className="sidebar">
                    <div className="logo">
                        <h1><i className="fas fa-bullseye"></i> KBI Contractor</h1>
                        <div className="subtitle">SMB Intelligence Platform</div>
                    </div>
                    <nav className="nav-menu">
                        <NavSection title="Core Workflow" items={coreItems} />
                        <NavSection title="Intelligence" items={analysisItems} />
                        <NavSection title="Tools" items={toolsItems} />
                    </nav>
                </div>
            );
        };

        const KPICard = ({ title, value, change, icon, iconColor, className = '' }) => (
            <div className={`kpi-card ${className}`}>
                <div className="kpi-header">
                    <span className="kpi-title">{title}</span>
                    <div className="kpi-icon" style={{ backgroundColor: iconColor }}>
                        <i className={icon}></i>
                    </div>
                </div>
                <div className="kpi-value">{value}</div>
                {change !== undefined && (
                    <div className={`kpi-change ${change > 0 ? 'positive' : change < 0 ? 'negative' : 'neutral'}`}>
                        {change !== 0 && <i className={`fas ${change > 0 ? 'fa-arrow-up' : 'fa-arrow-down'}`}></i>}
                        {change === 0 ? 'No change' : `${Math.abs(change)}% ${change > 0 ? 'increase' : 'decrease'}`}
                    </div>
                )}
            </div>
        );

        const OpportunityDecisionCard = ({ opportunity, onAnalyze, analysis, onClick }) => {
            const daysLeft = getDaysUntil(opportunity.response_deadline);
            const score = analysis ? analysis.win_probability : (opportunity.ai_score || Math.random() * 0.8 + 0.1);
            const decisionType = getDecisionType(score, daysLeft, opportunity.estimated_value);
            const scoreClass = getScoreClass(score);

            return (
                <div className={`opportunity-card ${decisionType} fade-in`} onClick={onClick} style={{ cursor: 'pointer' }}>
                    <div className="opportunity-header">
                        <div>
                            <div className="opportunity-title">{opportunity.title}</div>
                            <div className="opportunity-agency">{opportunity.agency}</div>
                        </div>
                        <span className={`decision-badge ${decisionType}`}>
                            {decisionType === 'go' ? 'Pursue' : decisionType === 'no-go' ? 'Pass' : 'Analyze'}
                        </span>
                    </div>

                    <div className="opportunity-meta">
                        <div className="meta-item">
                            <i className="fas fa-dollar-sign"></i>
                            <span>{formatCurrency(opportunity.estimated_value || 0)}</span>
                        </div>
                        <div className="meta-item">
                            <i className="fas fa-calendar"></i>
                            <span>{daysLeft} days left</span>
                        </div>
                        <div className="meta-item">
                            <i className="fas fa-tag"></i>
                            <span>{opportunity.set_aside_type || 'Unrestricted'}</span>
                        </div>
                    </div>

                    <div className="ai-score">
                        <div className={`score-circle ${scoreClass}`}>
                            {Math.round(score * 100)}%
                        </div>
                        <div className="score-details">
                            <div className="score-label">Win Probability</div>
                            <div className="score-text">
                                {analysis ? analysis.recommendation : 'Click to analyze'}
                            </div>
                        </div>
                        <button 
                            className="btn btn-sm btn-primary"
                            onClick={(e) => {
                                e.stopPropagation();
                                onAnalyze(opportunity.id);
                            }}
                        >
                            <i className="fas fa-brain"></i>
                            {analysis ? 'Refresh' : 'Analyze'}
                        </button>
                    </div>
                </div>
            );
        };

        const AgencyProfileWidget = ({ agencyName }) => {
            const data = mockAgencyData[agencyName];
            if (!data) return null;

            return (
                <div className="agency-profile">
                    <div className="agency-name">{agencyName}</div>
                    <div className="agency-stats">
                        <div className="agency-stat">
                            <span className="stat-label">Annual Spending</span>
                            <span className="stat-value">{formatCurrency(data.totalSpending)}</span>
                        </div>
                        <div className="agency-stat">
                            <span className="stat-label">Avg Contract Size</span>
                            <span className="stat-value">{formatCurrency(data.avgContractSize)}</span>
                        </div>
                        <div className="agency-stat">
                            <span className="stat-label">Small Business Rate</span>
                            <span className="stat-value">{Math.round(data.smallBusinessRate * 100)}%</span>
                        </div>
                        <div className="agency-stat">
                            <span className="stat-label">Avg Time to Award</span>
                            <span className="stat-value">{data.avgTimeToAward} days</span>
                        </div>
                    </div>
                </div>
            );
        };

        const Dashboard = ({ metrics, opportunities, analyses, onAnalyze }) => {
            const urgentOpportunities = opportunities.filter(opp => getDaysUntil(opp.response_deadline) <= 14);
            const highValueOpportunities = opportunities.filter(opp => opp.estimated_value >= 1000000);
            
            return (
                <div className="dashboard-grid">
                    <div className="dashboard-left">
                        {/* KPI Grid */}
                        <div className="kpi-grid">
                            <KPICard
                                title="Opportunities This Week"
                                value={urgentOpportunities.length}
                                change={8}
                                icon="fas fa-crosshairs"
                                iconColor="var(--primary-blue)"
                                className="primary"
                            />
                            <KPICard
                                title="Pipeline Value"
                                value={formatCurrency(metrics?.pipeline_value || 0)}
                                change={12}
                                icon="fas fa-dollar-sign"
                                iconColor="var(--success-green)"
                                className="success"
                            />
                            <KPICard
                                title="Win Rate (90 days)"
                                value={`${Math.round((metrics?.win_rate || 0.65) * 100)}%`}
                                change={-3}
                                icon="fas fa-trophy"
                                iconColor="var(--warning-orange)"
                                className="warning"
                            />
                            <KPICard
                                title="High-Value Opps"
                                value={highValueOpportunities.length}
                                change={15}
                                icon="fas fa-gem"
                                iconColor="var(--danger-red)"
                                className="danger"
                            />
                        </div>

                        {/* Go/No-Go Decision Center */}
                        <div className="card">
                            <div className="card-header">
                                <h3 className="card-title">
                                    <i className="fas fa-crosshairs"></i>
                                    Go/No-Go Decision Queue
                                </h3>
                                <div>
                                    <button className="btn btn-sm">
                                        <i className="fas fa-filter"></i> Filter
                                    </button>
                                    <button className="btn btn-sm btn-primary" style={{ marginLeft: '8px' }}>
                                        <i className="fas fa-brain"></i> Analyze All
                                    </button>
                                </div>
                            </div>
                            <div className="card-content">
                                <div className="decision-grid">
                                    {urgentOpportunities.slice(0, 5).map(opp => (
                                        <OpportunityDecisionCard
                                            key={opp.id}
                                            opportunity={opp}
                                            analysis={analyses[opp.id]}
                                            onAnalyze={onAnalyze}
                                            onClick={() => setSelectedOpportunity(opp)}
                                        />
                                    ))}
                                </div>
                            </div>
                        </div>
                    </div>

                    <div className="dashboard-right">
                        {/* Agency Intelligence */}
                        <div className="card">
                            <div className="card-header">
                                <h3 className="card-title">
                                    <i className="fas fa-building"></i>
                                    Agency Intelligence
                                </h3>
                            </div>
                            <div className="card-content">
                                {Object.keys(mockAgencyData).map(agency => (
                                    <AgencyProfileWidget key={agency} agencyName={agency} />
                                ))}
                            </div>
                        </div>

                        {/* Market Alerts */}
                        <div className="card">
                            <div className="card-header">
                                <h3 className="card-title">
                                    <i className="fas fa-bell"></i>
                                    Smart Alerts
                                </h3>
                            </div>
                            <div className="card-content">
                                <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>
                                    <div style={{ padding: '12px', background: 'rgba(16, 185, 129, 0.1)', borderRadius: '8px', borderLeft: '4px solid var(--success-green)' }}>
                                        <strong>New Opportunity Match</strong>
                                        <p style={{ margin: '4px 0 0 0', fontSize: '0.875rem', color: 'var(--gray-600)' }}>
                                            3 new cybersecurity opportunities match your profile
                                        </p>
                                    </div>
                                    <div style={{ padding: '12px', background: 'rgba(245, 158, 11, 0.1)', borderRadius: '8px', borderLeft: '4px solid var(--warning-orange)' }}>
                                        <strong>Deadline Warning</strong>
                                        <p style={{ margin: '4px 0 0 0', fontSize: '0.875rem', color: 'var(--gray-600)' }}>
                                            DOD opportunity response due in 2 days
                                        </p>
                                    </div>
                                    <div style={{ padding: '12px', background: 'rgba(37, 99, 235, 0.1)', borderRadius: '8px', borderLeft: '4px solid var(--primary-blue)' }}>
                                        <strong>Market Intelligence</strong>
                                        <p style={{ margin: '4px 0 0 0', fontSize: '0.875rem', color: 'var(--gray-600)' }}>
                                            DHS increasing IT spending by 23% this quarter
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const GoNoGoView = ({ opportunities, analyses, onAnalyze }) => {
            const [sortBy, setSortBy] = useState('deadline');
            const [filterBy, setFilterBy] = useState('all');

            let filteredOpportunities = [...opportunities];
            
            // Filter
            if (filterBy === 'urgent') {
                filteredOpportunities = filteredOpportunities.filter(opp => getDaysUntil(opp.response_deadline) <= 14);
            } else if (filterBy === 'high-value') {
                filteredOpportunities = filteredOpportunities.filter(opp => opp.estimated_value >= 1000000);
            }

            // Sort
            filteredOpportunities.sort((a, b) => {
                if (sortBy === 'deadline') {
                    return getDaysUntil(a.response_deadline) - getDaysUntil(b.response_deadline);
                } else if (sortBy === 'value') {
                    return (b.estimated_value || 0) - (a.estimated_value || 0);
                } else if (sortBy === 'score') {
                    const scoreA = analyses[a.id]?.win_probability || a.ai_score || 0;
                    const scoreB = analyses[b.id]?.win_probability || b.ai_score || 0;
                    return scoreB - scoreA;
                }
                return 0;
            });

            return (
                <div>
                    <div style={{ display: 'flex', gap: '12px', marginBottom: '24px', padding: '16px', background: 'white', borderRadius: '8px', border: '1px solid var(--gray-200)' }}>
                        <select 
                            value={filterBy} 
                            onChange={(e) => setFilterBy(e.target.value)}
                            className="btn"
                            style={{ border: '1px solid var(--gray-300)' }}
                        >
                            <option value="all">All Opportunities</option>
                            <option value="urgent">Urgent (≤14 days)</option>
                            <option value="high-value">High Value (≥$1M)</option>
                        </select>
                        <select 
                            value={sortBy} 
                            onChange={(e) => setSortBy(e.target.value)}
                            className="btn"
                            style={{ border: '1px solid var(--gray-300)' }}
                        >
                            <option value="deadline">Sort by Deadline</option>
                            <option value="value">Sort by Value</option>
                            <option value="score">Sort by AI Score</option>
                        </select>
                        <button className="btn btn-primary" style={{ marginLeft: 'auto' }}>
                            <i className="fas fa-download"></i> Export Decisions
                        </button>
                    </div>

                    <div className="decision-grid">
                        {filteredOpportunities.map(opp => (
                            <OpportunityDecisionCard
                                key={opp.id}
                                opportunity={opp}
                                analysis={analyses[opp.id]}
                                onAnalyze={onAnalyze}
                                onClick={() => setSelectedOpportunity(opp)}
                            />
                        ))}
                    </div>
                </div>
            );
        };

        // Pipeline Management Component
        const PipelineView = ({ opportunities, analyses, onAnalyze }) => {
            const [pipelineData, setPipelineData] = useState({
                watching: [],
                analyzing: [],
                pursuing: [],
                submitted: [],
                awarded: [],
                lost: []
            });
            const [draggedItem, setDraggedItem] = useState(null);

            // Pipeline stages configuration
            const pipelineStages = [
                {
                    id: 'watching',
                    title: 'Watching',
                    subtitle: 'Monitoring for updates',
                    color: 'var(--gray-500)',
                    icon: 'fas fa-eye',
                },
                {
                    id: 'analyzing',
                    title: 'Analyzing',
                    subtitle: 'Go/No-Go decision pending',
                    color: 'var(--warning-orange)',
                    icon: 'fas fa-brain',
                },
                {
                    id: 'pursuing',
                    title: 'Pursuing',
                    subtitle: 'Active pursuit',
                    color: 'var(--primary-blue)',
                    icon: 'fas fa-rocket',
                },
                {
                    id: 'submitted',
                    title: 'Submitted',
                    subtitle: 'Awaiting results',
                    color: 'var(--success-green)',
                    icon: 'fas fa-paper-plane',
                },
                {
                    id: 'awarded',
                    title: 'Won',
                    subtitle: 'Successful awards',
                    color: 'var(--success-green)',
                    icon: 'fas fa-trophy',
                },
                {
                    id: 'lost',
                    title: 'Lost',
                    subtitle: 'Unsuccessful bids',
                    color: 'var(--danger-red)',
                    icon: 'fas fa-times-circle',
                }
            ];

            useEffect(() => {
                // Initialize pipeline with sample data
                if (opportunities.length > 0) {
                    const mockPipelineData = {
                        watching: opportunities.slice(0, 2).map(opp => ({ ...opp, stage: 'watching', notes: '', priority: 'medium' })),
                        analyzing: opportunities.slice(2, 4).map(opp => ({ ...opp, stage: 'analyzing', notes: 'AI analysis pending', priority: 'high' })),
                        pursuing: opportunities.slice(4, 5).map(opp => ({ ...opp, stage: 'pursuing', notes: 'Proposal in development', priority: 'high' })),
                        submitted: [],
                        awarded: [],
                        lost: []
                    };
                    setPipelineData(mockPipelineData);
                }
            }, [opportunities]);

            const handleDragStart = (e, opportunity, fromStage) => {
                setDraggedItem({ opportunity, fromStage });
                e.dataTransfer.effectAllowed = 'move';
            };

            const handleDragOver = (e) => {
                e.preventDefault();
                e.dataTransfer.dropEffect = 'move';
            };

            const handleDrop = (e, toStage) => {
                e.preventDefault();
                if (!draggedItem) return;

                const { opportunity, fromStage } = draggedItem;
                
                setPipelineData(prev => {
                    const newData = { ...prev };
                    newData[fromStage] = newData[fromStage].filter(opp => opp.id !== opportunity.id);
                    const updatedOpportunity = { ...opportunity, stage: toStage };
                    newData[toStage] = [...newData[toStage], updatedOpportunity];
                    return newData;
                });

                setDraggedItem(null);
            };

            const getTotalValue = (stage) => {
                return pipelineData[stage].reduce((sum, opp) => sum + (opp.estimated_value || 0), 0);
            };

            const OpportunityCard = ({ opportunity, stage }) => {
                const daysLeft = getDaysUntil(opportunity.response_deadline);
                const isUrgent = daysLeft <= 7;

                return (
                    <div
                        draggable
                        onDragStart={(e) => handleDragStart(e, opportunity, stage)}
                        style={{
                            border: `2px solid ${isUrgent ? 'var(--danger-red)' : 'var(--gray-200)'}`,
                            borderRadius: '8px',
                            padding: '12px',
                            marginBottom: '8px',
                            backgroundColor: 'white',
                            cursor: 'grab',
                            transition: 'all 0.2s'
                        }}
                        onMouseEnter={(e) => {
                            e.target.style.transform = 'translateY(-2px)';
                            e.target.style.boxShadow = '0 4px 12px rgba(0,0,0,0.15)';
                        }}
                        onMouseLeave={(e) => {
                            e.target.style.transform = 'translateY(0)';
                            e.target.style.boxShadow = '0 1px 3px rgba(0,0,0,0.1)';
                        }}
                    >
                        <div style={{ fontSize: '0.875rem', fontWeight: '600', marginBottom: '4px' }}>
                            {opportunity.title}
                        </div>
                        
                        <div style={{ fontSize: '0.75rem', color: 'var(--gray-600)', marginBottom: '8px' }}>
                            {opportunity.agency}
                        </div>

                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '8px' }}>
                            <span style={{ fontSize: '0.75rem', fontWeight: '600', color: 'var(--gray-800)' }}>
                                {formatCurrency(opportunity.estimated_value || 0)}
                            </span>
                            <span style={{ 
                                fontSize: '0.75rem', 
                                color: isUrgent ? 'var(--danger-red)' : 'var(--gray-600)',
                                fontWeight: isUrgent ? '600' : 'normal'
                            }}>
                                {daysLeft} days left
                            </span>
                        </div>

                        <div style={{ display: 'flex', gap: '4px' }}>
                            <span className="badge badge-info" style={{ fontSize: '0.625rem' }}>
                                {opportunity.set_aside_type || 'Unrestricted'}
                            </span>
                        </div>
                    </div>
                );
            };

            const PipelineColumn = ({ stage }) => {
                const count = pipelineData[stage.id].length;
                const totalValue = getTotalValue(stage.id);

                return (
                    <div
                        onDragOver={handleDragOver}
                        onDrop={(e) => handleDrop(e, stage.id)}
                        style={{
                            backgroundColor: 'var(--gray-50)',
                            borderRadius: '12px',
                            padding: '16px',
                            minHeight: '400px',
                            flex: '1',
                            minWidth: '280px'
                        }}
                    >
                        <div style={{
                            display: 'flex',
                            alignItems: 'center',
                            gap: '8px',
                            marginBottom: '16px',
                            paddingBottom: '12px',
                            borderBottom: `2px solid ${stage.color}`
                        }}>
                            <i className={stage.icon} style={{ color: stage.color, fontSize: '1.1rem' }}></i>
                            <div style={{ flex: 1 }}>
                                <div style={{ fontWeight: '600', color: 'var(--gray-800)', fontSize: '1rem' }}>
                                    {stage.title}
                                </div>
                                <div style={{ fontSize: '0.75rem', color: 'var(--gray-600)' }}>
                                    {stage.subtitle}
                                </div>
                            </div>
                            <div style={{ textAlign: 'right' }}>
                                <div style={{ fontSize: '1.25rem', fontWeight: '700', color: stage.color }}>
                                    {count}
                                </div>
                                <div style={{ fontSize: '0.75rem', color: 'var(--gray-600)' }}>
                                    {formatCurrency(totalValue)}
                                </div>
                            </div>
                        </div>

                        <div style={{ display: 'flex', flexDirection: 'column', gap: '8px' }}>
                            {pipelineData[stage.id].map(opportunity => (
                                <OpportunityCard
                                    key={opportunity.id}
                                    opportunity={opportunity}
                                    stage={stage.id}
                                />
                            ))}
                        </div>
                    </div>
                );
            };

            return (
                <div>
                    {/* Pipeline Header */}
                    <div style={{ 
                        display: 'flex', 
                        justifyContent: 'space-between', 
                        alignItems: 'center', 
                        marginBottom: '24px',
                        padding: '20px',
                        backgroundColor: 'white',
                        borderRadius: '12px',
                        border: '1px solid var(--gray-200)'
                    }}>
                        <div>
                            <h2 style={{ fontSize: '1.5rem', fontWeight: '600', color: 'var(--gray-800)', margin: 0 }}>
                                Pipeline Management
                            </h2>
                            <p style={{ color: 'var(--gray-600)', margin: '4px 0 0 0', fontSize: '0.875rem' }}>
                                Drag opportunities between stages to track your pursuit pipeline
                            </p>
                        </div>
                        <div style={{ display: 'flex', gap: '12px' }}>
                            <button className="btn">
                                <i className="fas fa-filter"></i> Filter
                            </button>
                            <button className="btn btn-primary">
                                <i className="fas fa-chart-line"></i> Pipeline Report
                            </button>
                        </div>
                    </div>

                    {/* Pipeline Statistics */}
                    <div className="kpi-grid" style={{ marginBottom: '24px' }}>
                        <KPICard
                            title="Active Opportunities"
                            value={Object.values(pipelineData).flat().length}
                            change={8}
                            icon="fas fa-stream"
                            iconColor="var(--primary-blue)"
                        />
                        <KPICard
                            title="Total Pipeline Value"
                            value={formatCurrency(Object.values(pipelineData).flat().reduce((sum, opp) => sum + (opp.estimated_value || 0), 0))}
                            change={15}
                            icon="fas fa-dollar-sign"
                            iconColor="var(--success-green)"
                        />
                        <KPICard
                            title="Pursuing This Month"
                            value={pipelineData.pursuing.length + pipelineData.submitted.length}
                            change={12}
                            icon="fas fa-rocket"
                            iconColor="var(--warning-orange)"
                        />
                        <KPICard
                            title="Win Rate (YTD)"
                            value="67%"
                            change={5}
                            icon="fas fa-trophy"
                            iconColor="var(--success-green)"
                        />
                    </div>

                    {/* Pipeline Board */}
                    <div style={{
                        display: 'flex',
                        gap: '16px',
                        overflowX: 'auto',
                        paddingBottom: '16px'
                    }}>
                        {pipelineStages.map(stage => (
                            <PipelineColumn key={stage.id} stage={stage} />
                        ))}
                    </div>
                </div>
            );
        };

        // Agency Intelligence Component
        const AgencyIntelligenceView = () => {
            const [selectedAgency, setSelectedAgency] = useState('Department of Defense');
            const [agencyOpportunities, setAgencyOpportunities] = useState([]);
            const [loading, setLoading] = useState(false);
            const [agencyProfiles, setAgencyProfiles] = useState({});
            const [federalWebsiteData, setFederalWebsiteData] = useState(null);

            // Load real agency data from federal websites and opportunities
            useEffect(() => {
                const loadAgencyData = async () => {
                    try {
                        setLoading(true);
                        const [websiteData, opportunitiesData] = await Promise.all([
                            api.fetchFederalWebsites(),
                            api.fetchOpportunities()
                        ]);

                        setFederalWebsiteData(websiteData);

                        // Transform real data into agency profiles
                        const topAgencies = websiteData.agency_stats?.top_agencies || {};
                        const transformedProfiles = {};

                        Object.keys(topAgencies).slice(0, 10).forEach((agencyName, index) => {
                            const websiteCount = topAgencies[agencyName];
                            const agencyOpps = opportunitiesData.filter(opp => 
                                opp.department?.toLowerCase().includes(agencyName.toLowerCase().split(' ')[0])
                            );

                            transformedProfiles[agencyName] = {
                                websiteCount: websiteCount,
                                totalSpending: agencyOpps.reduce((sum, opp) => sum + (opp.estimated_value || 0), 0),
                                contracts2024: agencyOpps.length,
                                avgContractSize: agencyOpps.length > 0 ? 
                                    agencyOpps.reduce((sum, opp) => sum + (opp.estimated_value || 0), 0) / agencyOpps.length : 0,
                    smallBusinessRate: 0.234,
                    competitionRate: 0.67,
                    avgTimeToAward: 89,
                    topNAICS: [
                        { code: '541512', description: 'Computer Systems Design', percentage: 18.2, avgValue: 3200000 },
                        { code: '541330', description: 'Engineering Services', percentage: 15.7, avgValue: 2100000 },
                        { code: '541511', description: 'Custom Programming', percentage: 12.4, avgValue: 1800000 },
                        { code: '561210', description: 'Facilities Support', percentage: 9.8, avgValue: 950000 }
                    ],
                    setAsideDistribution: {
                        'Small Business': 23.4,
                        '8(a)': 8.7,
                        'WOSB': 5.2,
                        'VOSB': 12.1,
                        'SDVOSB': 8.9,
                        'HUBZone': 3.2,
                        'Unrestricted': 38.5
                    },
                    spendingTrends: [
                        { month: 'Jan', spending: 11200000000 },
                        { month: 'Feb', spending: 10800000000 },
                        { month: 'Mar', spending: 12400000000 },
                        { month: 'Apr', spending: 13100000000 },
                        { month: 'May', spending: 12900000000 },
                        { month: 'Jun', spending: 13800000000 }
                    ],
                    keyContacts: [
                        { name: 'Jane Smith', title: 'Director of Small Business Programs', office: 'OSBP', email: 'jane.smith@defense.gov' },
                        { name: 'Mike Johnson', title: 'Contracting Officer', office: 'DLA', email: 'mike.johnson@dla.mil' }
                    ],
                    upcomingEvents: [
                        { date: '2024-09-15', event: 'Small Business Innovation Day', location: 'Pentagon', type: 'Networking' },
                        { date: '2024-09-22', event: 'Industry Day - Cybersecurity', location: 'Virtual', type: 'Information Session' }
                    ]
                },
                'Department of Homeland Security': {
                    totalSpending: 78000000000,
                    contracts2024: 8734,
                    avgContractSize: 1850000,
                    smallBusinessRate: 0.312,
                    competitionRate: 0.54,
                    avgTimeToAward: 76,
                    topNAICS: [
                        { code: '541330', description: 'Engineering Services', percentage: 22.1, avgValue: 1900000 },
                        { code: '541512', description: 'Computer Systems Design', percentage: 19.8, avgValue: 2400000 },
                        { code: '561210', description: 'Facilities Support', percentage: 14.3, avgValue: 850000 },
                        { code: '541690', description: 'Other Scientific Services', percentage: 11.2, avgValue: 1200000 }
                    ],
                    setAsideDistribution: {
                        'Small Business': 31.2,
                        '8(a)': 12.4,
                        'WOSB': 7.8,
                        'VOSB': 9.1,
                        'SDVOSB': 6.3,
                        'HUBZone': 4.7,
                        'Unrestricted': 28.5
                    },
                    keyContacts: [
                        { name: 'Sarah Davis', title: 'Small Business Specialist', office: 'OSDBU', email: 'sarah.davis@hq.dhs.gov' }
                    ],
                    upcomingEvents: [
                        { date: '2024-08-28', event: 'Border Security Tech Summit', location: 'Washington DC', type: 'Conference' }
                    ]
                },
                'NASA': {
                    totalSpending: 34000000000,
                    contracts2024: 3421,
                    avgContractSize: 950000,
                    smallBusinessRate: 0.278,
                    competitionRate: 0.71,
                    avgTimeToAward: 92,
                    topNAICS: [
                        { code: '541511', description: 'Custom Programming', percentage: 28.4, avgValue: 1100000 },
                        { code: '541712', description: 'R&D Physical Sciences', percentage: 24.7, avgValue: 1400000 },
                        { code: '541330', description: 'Engineering Services', percentage: 18.9, avgValue: 980000 },
                        { code: '334511', description: 'Instruments Manufacturing', percentage: 12.1, avgValue: 750000 }
                    ],
                    setAsideDistribution: {
                        'Small Business': 27.8,
                        '8(a)': 9.3,
                        'WOSB': 6.1,
                        'VOSB': 4.2,
                        'SDVOSB': 3.8,
                        'HUBZone': 2.1,
                        'Unrestricted': 46.7
                    },
                    keyContacts: [
                        { name: 'Dr. Lisa Chen', title: 'OSBP Director', office: 'HQ', email: 'lisa.chen@nasa.gov' }
                    ],
                    upcomingEvents: [
                        { date: '2024-09-10', event: 'NASA SBIR/STTR Workshop', location: 'Kennedy Space Center', type: 'Workshop' }
                    ]
                }
            };

            const currentAgency = agencyProfiles[selectedAgency];

            const AgencyMetricsCard = ({ title, value, subtitle, icon, color }) => (
                <div className="card" style={{ marginBottom: '16px' }}>
                    <div style={{ padding: '20px', display: 'flex', alignItems: 'center', gap: '16px' }}>
                        <div style={{ 
                            backgroundColor: color, 
                            color: 'white', 
                            padding: '16px', 
                            borderRadius: '12px',
                            fontSize: '1.5rem'
                        }}>
                            <i className={icon}></i>
                        </div>
                        <div style={{ flex: 1 }}>
                            <div style={{ fontSize: '0.875rem', color: 'var(--gray-600)', marginBottom: '4px' }}>
                                {title}
                            </div>
                            <div style={{ fontSize: '1.875rem', fontWeight: '700', color: 'var(--gray-800)', marginBottom: '2px' }}>
                                {value}
                            </div>
                            <div style={{ fontSize: '0.75rem', color: 'var(--gray-500)' }}>
                                {subtitle}
                            </div>
                        </div>
                    </div>
                </div>
            );

            const NAICSTable = ({ naicsData }) => (
                <div className="card">
                    <div className="card-header">
                        <h3 className="card-title">
                            <i className="fas fa-chart-pie"></i>
                            Top NAICS Codes for SMBs
                        </h3>
                    </div>
                    <div className="card-content">
                        <table className="table">
                            <thead>
                                <tr>
                                    <th>NAICS Code</th>
                                    <th>Description</th>
                                    <th>% of Contracts</th>
                                    <th>Avg Value</th>
                                    <th>Opportunity</th>
                                </tr>
                            </thead>
                            <tbody>
                                {naicsData.map((naics, index) => (
                                    <tr key={naics.code}>
                                        <td style={{ fontWeight: '600', color: 'var(--primary-blue)' }}>
                                            {naics.code}
                                        </td>
                                        <td>{naics.description}</td>
                                        <td>
                                            <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
                                                <div style={{
                                                    width: '60px',
                                                    height: '6px',
                                                    backgroundColor: 'var(--gray-200)',
                                                    borderRadius: '3px',
                                                    overflow: 'hidden'
                                                }}>
                                                    <div style={{
                                                        width: `${naics.percentage * 4}px`,
                                                        height: '100%',
                                                        backgroundColor: 'var(--success-green)',
                                                        borderRadius: '3px'
                                                    }}></div>
                                                </div>
                                                <span style={{ fontSize: '0.875rem', fontWeight: '600' }}>
                                                    {naics.percentage}%
                                                </span>
                                            </div>
                                        </td>
                                        <td style={{ fontWeight: '600' }}>
                                            {formatCurrency(naics.avgValue)}
                                        </td>
                                        <td>
                                            <span className={`badge ${
                                                naics.percentage > 15 ? 'badge-success' :
                                                naics.percentage > 10 ? 'badge-warning' : 'badge-info'
                                            }`}>
                                                {naics.percentage > 15 ? 'High' : naics.percentage > 10 ? 'Medium' : 'Low'}
                                            </span>
                                        </td>
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                    </div>
                </div>
            );

            const SetAsideChart = ({ data }) => (
                <div className="card">
                    <div className="card-header">
                        <h3 className="card-title">
                            <i className="fas fa-percentage"></i>
                            Set-Aside Distribution
                        </h3>
                    </div>
                    <div className="card-content">
                        <div style={{ display: 'grid', gap: '12px' }}>
                            {Object.entries(data).map(([type, percentage]) => (
                                <div key={type} style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
                                    <div style={{ minWidth: '120px', fontSize: '0.875rem', fontWeight: '500' }}>
                                        {type}
                                    </div>
                                    <div style={{ flex: 1, height: '8px', backgroundColor: 'var(--gray-200)', borderRadius: '4px', overflow: 'hidden' }}>
                                        <div style={{
                                            width: `${percentage * 2}%`,
                                            height: '100%',
                                            backgroundColor: type.includes('Small Business') || type.includes('8(a)') || type.includes('WOSB') || type.includes('VOSB') ? 'var(--success-green)' : 'var(--gray-400)',
                                            borderRadius: '4px'
                                        }}></div>
                                    </div>
                                    <div style={{ minWidth: '50px', textAlign: 'right', fontSize: '0.875rem', fontWeight: '600' }}>
                                        {percentage}%
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );

            return (
                <div>
                    {/* Agency Selection Header */}
                    <div style={{ 
                        display: 'flex', 
                        justifyContent: 'space-between', 
                        alignItems: 'center', 
                        marginBottom: '24px',
                        padding: '20px',
                        backgroundColor: 'white',
                        borderRadius: '12px',
                        border: '1px solid var(--gray-200)'
                    }}>
                        <div>
                            <h2 style={{ fontSize: '1.5rem', fontWeight: '600', color: 'var(--gray-800)', margin: 0 }}>
                                Agency Intelligence
                            </h2>
                            <p style={{ color: 'var(--gray-600)', margin: '4px 0 0 0', fontSize: '0.875rem' }}>
                                Deep insights into agency spending patterns and opportunities
                            </p>
                        </div>
                        <div style={{ display: 'flex', gap: '12px', alignItems: 'center' }}>
                            <select 
                                value={selectedAgency} 
                                onChange={(e) => setSelectedAgency(e.target.value)}
                                className="btn"
                                style={{ border: '1px solid var(--gray-300)', minWidth: '200px' }}
                            >
                                {Object.keys(agencyProfiles).map(agency => (
                                    <option key={agency} value={agency}>{agency}</option>
                                ))}
                            </select>
                            <button className="btn btn-primary">
                                <i className="fas fa-download"></i> Export Profile
                            </button>
                        </div>
                    </div>

                    <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr', gap: '24px' }}>
                        {/* Main Content */}
                        <div>
                            {/* Key Metrics */}
                            <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px', marginBottom: '24px' }}>
                                <AgencyMetricsCard
                                    title="Annual Spending"
                                    value={formatCurrency(currentAgency.totalSpending)}
                                    subtitle={`${currentAgency.contracts2024.toLocaleString()} contracts in 2024`}
                                    icon="fas fa-dollar-sign"
                                    color="var(--success-green)"
                                />
                                <AgencyMetricsCard
                                    title="Small Business Rate"
                                    value={`${Math.round(currentAgency.smallBusinessRate * 100)}%`}
                                    subtitle={`Target: 23% | Avg: ${formatCurrency(currentAgency.avgContractSize)}`}
                                    icon="fas fa-building"
                                    color="var(--primary-blue)"
                                />
                                <AgencyMetricsCard
                                    title="Competition Rate"
                                    value={`${Math.round(currentAgency.competitionRate * 100)}%`}
                                    subtitle={`${currentAgency.avgTimeToAward} days avg time to award`}
                                    icon="fas fa-users"
                                    color="var(--warning-orange)"
                                />
                                <AgencyMetricsCard
                                    title="SMB Opportunity Score"
                                    value="8.7/10"
                                    subtitle="Based on SB rate, competition, and contract size"
                                    icon="fas fa-star"
                                    color="var(--success-green)"
                                />
                            </div>

                            {/* NAICS Analysis */}
                            <NAICSTable naicsData={currentAgency.topNAICS} />
                        </div>

                        {/* Sidebar */}
                        <div>
                            {/* Set-Aside Distribution */}
                            <SetAsideChart data={currentAgency.setAsideDistribution} />

                            {/* Key Contacts */}
                            <div className="card" style={{ marginTop: '16px' }}>
                                <div className="card-header">
                                    <h3 className="card-title">
                                        <i className="fas fa-address-book"></i>
                                        Key Contacts
                                    </h3>
                                </div>
                                <div className="card-content">
                                    {currentAgency.keyContacts.map((contact, index) => (
                                        <div key={index} style={{ marginBottom: '16px', padding: '12px', backgroundColor: 'var(--gray-50)', borderRadius: '8px' }}>
                                            <div style={{ fontWeight: '600', color: 'var(--gray-800)', marginBottom: '4px' }}>
                                                {contact.name}
                                            </div>
                                            <div style={{ fontSize: '0.875rem', color: 'var(--gray-600)', marginBottom: '2px' }}>
                                                {contact.title}
                                            </div>
                                            <div style={{ fontSize: '0.75rem', color: 'var(--gray-500)', marginBottom: '6px' }}>
                                                {contact.office}
                                            </div>
                                            <a href={`mailto:${contact.email}`} style={{ 
                                                fontSize: '0.75rem', 
                                                color: 'var(--primary-blue)', 
                                                textDecoration: 'none' 
                                            }}>
                                                {contact.email}
                                            </a>
                                        </div>
                                    ))}
                                </div>
                            </div>

                            {/* Upcoming Events */}
                            <div className="card" style={{ marginTop: '16px' }}>
                                <div className="card-header">
                                    <h3 className="card-title">
                                        <i className="fas fa-calendar"></i>
                                        Upcoming Events
                                    </h3>
                                </div>
                                <div className="card-content">
                                    {currentAgency.upcomingEvents.map((event, index) => (
                                        <div key={index} style={{ marginBottom: '12px', padding: '12px', backgroundColor: 'var(--gray-50)', borderRadius: '8px' }}>
                                            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '4px' }}>
                                                <div style={{ fontWeight: '600', color: 'var(--gray-800)', fontSize: '0.875rem' }}>
                                                    {event.event}
                                                </div>
                                                <span className="badge badge-info" style={{ fontSize: '0.625rem' }}>
                                                    {event.type}
                                                </span>
                                            </div>
                                            <div style={{ fontSize: '0.75rem', color: 'var(--gray-600)' }}>
                                                {formatDate(event.date)} • {event.location}
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // Opportunity Detail Modal Component
        const OpportunityDetailModal = ({ opportunity, analysis, onClose, onAnalyze }) => {
            if (!opportunity) return null;

            const daysLeft = getDaysUntil(opportunity.response_deadline);
            const isUrgent = daysLeft <= 7;
            const score = analysis ? analysis.win_probability : (opportunity.ai_score || 0.5);
            const scoreClass = getScoreClass(score);

            return (
                <div style={{
                    position: 'fixed',
                    top: 0,
                    left: 0,
                    right: 0,
                    bottom: 0,
                    backgroundColor: 'rgba(0, 0, 0, 0.5)',
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'center',
                    zIndex: 1000,
                    padding: '20px'
                }}
                onClick={onClose}
                >
                    <div style={{
                        backgroundColor: 'white',
                        borderRadius: '16px',
                        maxWidth: '1000px',
                        width: '100%',
                        maxHeight: '90vh',
                        overflow: 'auto',
                        position: 'relative'
                    }}
                    onClick={(e) => e.stopPropagation()}
                    >
                        {/* Header */}
                        <div style={{
                            padding: '24px',
                            borderBottom: '1px solid var(--gray-200)',
                            display: 'flex',
                            justifyContent: 'space-between',
                            alignItems: 'flex-start',
                            gap: '16px'
                        }}>
                            <div style={{ flex: 1 }}>
                                <h2 style={{
                                    fontSize: '1.5rem',
                                    fontWeight: '600',
                                    color: 'var(--gray-800)',
                                    marginBottom: '8px',
                                    lineHeight: '1.3'
                                }}>
                                    {opportunity.title}
                                </h2>
                                <div style={{ fontSize: '1rem', color: 'var(--gray-600)', marginBottom: '12px' }}>
                                    {opportunity.agency} • {opportunity.solicitation_number}
                                </div>
                                <div style={{ display: 'flex', gap: '12px', flexWrap: 'wrap' }}>
                                    <span className="badge badge-info">
                                        {opportunity.set_aside_type || 'Unrestricted'}
                                    </span>
                                    {opportunity.naics_code && (
                                        <span className="badge badge-success">
                                            NAICS {opportunity.naics_code}
                                        </span>
                                    )}
                                    <span className={`badge ${isUrgent ? 'badge-danger' : 'badge-warning'}`}>
                                        {daysLeft} days remaining
                                    </span>
                                </div>
                            </div>
                            <button 
                                onClick={onClose}
                                style={{
                                    background: 'none',
                                    border: 'none',
                                    fontSize: '1.5rem',
                                    color: 'var(--gray-400)',
                                    cursor: 'pointer',
                                    padding: '8px',
                                    borderRadius: '8px',
                                    transition: 'all 0.2s'
                                }}
                                onMouseEnter={(e) => {
                                    e.target.style.backgroundColor = 'var(--gray-100)';
                                    e.target.style.color = 'var(--gray-600)';
                                }}
                                onMouseLeave={(e) => {
                                    e.target.style.backgroundColor = 'transparent';
                                    e.target.style.color = 'var(--gray-400)';
                                }}
                            >
                                <i className="fas fa-times"></i>
                            </button>
                        </div>

                        <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr', gap: '0' }}>
                            {/* Main Content */}
                            <div style={{ padding: '24px', borderRight: '1px solid var(--gray-200)' }}>
                                {/* Key Details */}
                                <div style={{ marginBottom: '24px' }}>
                                    <h3 style={{ fontSize: '1.125rem', fontWeight: '600', marginBottom: '16px' }}>
                                        Opportunity Details
                                    </h3>
                                    <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px' }}>
                                        <div>
                                            <div style={{ fontSize: '0.875rem', color: 'var(--gray-600)', marginBottom: '4px' }}>
                                                Estimated Value
                                            </div>
                                            <div style={{ fontSize: '1.25rem', fontWeight: '600', color: 'var(--gray-800)' }}>
                                                {formatCurrency(opportunity.estimated_value || 0)}
                                            </div>
                                        </div>
                                        <div>
                                            <div style={{ fontSize: '0.875rem', color: 'var(--gray-600)', marginBottom: '4px' }}>
                                                Response Deadline
                                            </div>
                                            <div style={{ fontSize: '1.25rem', fontWeight: '600', color: isUrgent ? 'var(--danger-red)' : 'var(--gray-800)' }}>
                                                {formatDate(opportunity.response_deadline)}
                                            </div>
                                        </div>
                                        <div>
                                            <div style={{ fontSize: '0.875rem', color: 'var(--gray-600)', marginBottom: '4px' }}>
                                                Posted Date
                                            </div>
                                            <div style={{ fontSize: '1rem', fontWeight: '500', color: 'var(--gray-700)' }}>
                                                {formatDate(opportunity.posted_date)}
                                            </div>
                                        </div>
                                        <div>
                                            <div style={{ fontSize: '0.875rem', color: 'var(--gray-600)', marginBottom: '4px' }}>
                                                Place of Performance
                                            </div>
                                            <div style={{ fontSize: '1rem', fontWeight: '500', color: 'var(--gray-700)' }}>
                                                {opportunity.place_of_performance || 'Not specified'}
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                {/* Description */}
                                <div style={{ marginBottom: '24px' }}>
                                    <h3 style={{ fontSize: '1.125rem', fontWeight: '600', marginBottom: '12px' }}>
                                        Description
                                    </h3>
                                    <div style={{
                                        fontSize: '0.875rem',
                                        lineHeight: '1.6',
                                        color: 'var(--gray-700)',
                                        backgroundColor: 'var(--gray-50)',
                                        padding: '16px',
                                        borderRadius: '8px'
                                    }}>
                                        {opportunity.description}
                                    </div>
                                </div>

                                {/* AI Analysis Results */}
                                {analysis && (
                                    <div style={{ marginBottom: '24px' }}>
                                        <h3 style={{ fontSize: '1.125rem', fontWeight: '600', marginBottom: '16px' }}>
                                            AI Analysis Results
                                        </h3>
                                        <div style={{
                                            padding: '20px',
                                            backgroundColor: 'var(--gray-50)',
                                            borderRadius: '12px',
                                            border: `2px solid ${scoreClass === 'high' ? 'var(--success-green)' : scoreClass === 'medium' ? 'var(--warning-orange)' : 'var(--danger-red)'}`
                                        }}>
                                            <div style={{ display: 'flex', alignItems: 'center', gap: '16px', marginBottom: '16px' }}>
                                                <div className={`score-circle ${scoreClass}`} style={{ width: '60px', height: '60px', fontSize: '1.125rem' }}>
                                                    {Math.round(analysis.win_probability * 100)}%
                                                </div>
                                                <div>
                                                    <div style={{ fontSize: '1.125rem', fontWeight: '600', color: 'var(--gray-800)', marginBottom: '4px' }}>
                                                        {analysis.recommendation}
                                                    </div>
                                                    <div style={{ fontSize: '0.875rem', color: 'var(--gray-600)' }}>
                                                        Confidence: {analysis.confidence}
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            {analysis.factors && (
                                                <div>
                                                    <div style={{ fontSize: '0.875rem', fontWeight: '600', marginBottom: '8px' }}>
                                                        Analysis Factors:
                                                    </div>
                                                    <div style={{ fontSize: '0.875rem', color: 'var(--gray-700)' }}>
                                                        • NAICS Match: {analysis.factors.naics_match ? '✅ Yes' : '❌ No'}<br />
                                                        • Past Performance: {analysis.factors.past_performance ? '✅ Yes' : '❌ No'}<br />
                                                        • Set-Aside Type: {analysis.factors.set_aside_type}<br />
                                                        • Contract Value: {formatCurrency(analysis.factors.opportunity_value)}
                                                    </div>
                                                </div>
                                            )}
                                        </div>
                                    </div>
                                )}
                            </div>

                            {/* Sidebar */}
                            <div style={{ padding: '24px' }}>
                                {/* AI Score */}
                                <div style={{ marginBottom: '24px' }}>
                                    <h3 style={{ fontSize: '1.125rem', fontWeight: '600', marginBottom: '16px' }}>
                                        AI Win Probability
                                    </h3>
                                    <div style={{ textAlign: 'center', marginBottom: '16px' }}>
                                        <div className={`score-circle ${scoreClass}`} style={{ 
                                            width: '80px', 
                                            height: '80px', 
                                            fontSize: '1.25rem',
                                            margin: '0 auto 12px auto'
                                        }}>
                                            {Math.round(score * 100)}%
                                        </div>
                                        <div style={{ fontSize: '0.875rem', color: 'var(--gray-600)' }}>
                                            {analysis ? analysis.confidence + ' Confidence' : 'Click Analyze for Details'}
                                        </div>
                                    </div>
                                    <button 
                                        className="btn btn-primary"
                                        style={{ width: '100%', marginBottom: '12px' }}
                                        onClick={() => onAnalyze(opportunity.id)}
                                    >
                                        <i className="fas fa-brain"></i>
                                        {analysis ? 'Refresh Analysis' : 'Run AI Analysis'}
                                    </button>
                                </div>

                                {/* Quick Actions */}
                                <div style={{ marginBottom: '24px' }}>
                                    <h3 style={{ fontSize: '1.125rem', fontWeight: '600', marginBottom: '16px' }}>
                                        Quick Actions
                                    </h3>
                                    <div style={{ display: 'flex', flexDirection: 'column', gap: '8px' }}>
                                        <button className="btn">
                                            <i className="fas fa-plus"></i> Add to Pipeline
                                        </button>
                                        <button className="btn">
                                            <i className="fas fa-bookmark"></i> Save for Later
                                        </button>
                                        <button className="btn">
                                            <i className="fas fa-share"></i> Share with Team
                                        </button>
                                        <button className="btn">
                                            <i className="fas fa-download"></i> Export Details
                                        </button>
                                    </div>
                                </div>

                                {/* Agency Info */}
                                <div>
                                    <h3 style={{ fontSize: '1.125rem', fontWeight: '600', marginBottom: '16px' }}>
                                        Agency Insights
                                    </h3>
                                    <div style={{ 
                                        padding: '16px', 
                                        backgroundColor: 'var(--gray-50)', 
                                        borderRadius: '8px',
                                        fontSize: '0.875rem'
                                    }}>
                                        <div style={{ marginBottom: '8px' }}>
                                            <strong>Average Contract Size:</strong><br />
                                            {mockAgencyData[opportunity.agency] 
                                                ? formatCurrency(mockAgencyData[opportunity.agency].avgContractSize)
                                                : 'N/A'
                                            }
                                        </div>
                                        <div style={{ marginBottom: '8px' }}>
                                            <strong>Small Business Rate:</strong><br />
                                            {mockAgencyData[opportunity.agency] 
                                                ? Math.round(mockAgencyData[opportunity.agency].smallBusinessRate * 100) + '%'
                                                : 'N/A'
                                            }
                                        </div>
                                        <div>
                                            <strong>Avg Time to Award:</strong><br />
                                            {mockAgencyData[opportunity.agency] 
                                                ? mockAgencyData[opportunity.agency].avgTimeToAward + ' days'
                                                : 'N/A'
                                            }
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // Competitive Intelligence Component
        const CompetitiveIntelligenceView = () => {
            const [selectedCompetitor, setSelectedCompetitor] = useState('Booz Allen Hamilton');
            const [analysisTimeframe, setAnalysisTimeframe] = useState('12months');
            const [selectedNAICS, setSelectedNAICS] = useState('541512');
            const [competitiveView, setCompetitiveView] = useState('overview');

            // Comprehensive competitor database
            const competitorDatabase = {
                'Booz Allen Hamilton': {
                    type: 'Large Business',
                    size: 'Fortune 100',
                    employees: 29400,
                    revenue: 8100000000,
                    governmentRevenue: 7200000000,
                    foundedYear: 1914,
                    headquarters: 'McLean, VA',
                    ceo: 'Horacio Rozanski',
                    stockSymbol: 'BAH',
                    marketCap: 12800000000,
                    contracts2024: 4847,
                    avgContractSize: 8900000,
                    topAgencies: [
                        { agency: 'Department of Defense', contracts: 1847, value: 4200000000, percentage: 58.3 },
                        { agency: 'Department of Homeland Security', contracts: 892, value: 1800000000, percentage: 25.0 },
                        { agency: 'Department of Health and Human Services', contracts: 445, value: 890000000, percentage: 12.4 },
                        { agency: 'Department of Treasury', contracts: 234, value: 310000000, percentage: 4.3 }
                    ],
                    naicsSpecialties: [
                        { code: '541512', description: 'Computer Systems Design', contracts: 1890, value: 3200000000, growth: 0.234, winRate: 0.67 },
                        { code: '541330', description: 'Engineering Services', contracts: 1245, value: 2100000000, growth: 0.156, winRate: 0.58 },
                        { code: '541511', description: 'Custom Programming', contracts: 987, value: 1800000000, growth: 0.289, winRate: 0.71 },
                        { code: '541690', description: 'Scientific Consulting', contracts: 725, value: 1100000000, growth: 0.192, winRate: 0.62 }
                    ],
                    competitiveStrengths: [
                        'Established reputation and brand recognition',
                        'Deep government relationships across agencies',
                        'Large talent pool and specialized expertise',
                        'Strong past performance record',
                        'Significant financial resources for R&D',
                        'Advanced technology and innovation capabilities'
                    ],
                    competitiveWeaknesses: [
                        'Higher overhead costs vs SMBs',
                        'Less agile decision-making process',
                        'May not compete on smaller contracts (<$1M)',
                        'Limited small business teaming opportunities',
                        'Potentially overpriced for cost-sensitive procurements'
                    ],
                    recentNews: [
                        { date: '2024-08-15', headline: 'Booz Allen Wins $800M DHS Cybersecurity Contract', impact: 'high' },
                        { date: '2024-07-22', headline: 'New AI Innovation Center Opens in Arlington', impact: 'medium' },
                        { date: '2024-06-30', headline: 'Q1 2024 Revenue Up 12% Year-over-Year', impact: 'medium' }
                    ],
                    pricingStrategy: {
                        approach: 'Premium pricing with value justification',
                        blendedRate: 185,
                        seniorRate: 275,
                        juniorRate: 125,
                        overhead: 1.45,
                        gAndA: 0.18
                    },
                    competitivePositioning: {
                        marketShare: 0.034,
                        winRateVsSMBs: 0.23,
                        averageBidScore: 8.7,
                        proposalWinRate: 0.42
                    }
                },
                'CACI International': {
                    type: 'Large Business',
                    size: 'Mid-Large',
                    employees: 23000,
                    revenue: 6400000000,
                    governmentRevenue: 6100000000,
                    foundedYear: 1962,
                    headquarters: 'Reston, VA',
                    ceo: 'John Mengucci',
                    stockSymbol: 'CACI',
                    marketCap: 8900000000,
                    contracts2024: 3234,
                    avgContractSize: 4200000,
                    topAgencies: [
                        { agency: 'Department of Defense', contracts: 1456, value: 3400000000, percentage: 55.7 },
                        { agency: 'Intelligence Community', contracts: 789, value: 1900000000, percentage: 31.1 },
                        { agency: 'Department of Homeland Security', contracts: 567, value: 520000000, percentage: 8.5 },
                        { agency: 'Department of Justice', contracts: 422, value: 280000000, percentage: 4.6 }
                    ],
                    naicsSpecialties: [
                        { code: '541512', description: 'Computer Systems Design', contracts: 1234, value: 2100000000, growth: 0.189, winRate: 0.59 },
                        { code: '541330', description: 'Engineering Services', contracts: 892, value: 1400000000, growth: 0.134, winRate: 0.52 },
                        { code: '541519', description: 'Other Computer Services', contracts: 678, value: 980000000, growth: 0.245, winRate: 0.64 },
                        { code: '561210', description: 'Security Services', contracts: 430, value: 720000000, growth: 0.178, winRate: 0.71 }
                    ],
                    competitiveStrengths: [
                        'Strong intelligence community presence',
                        'Specialized cybersecurity and IT capabilities',
                        'Agile for a large company',
                        'Strong past performance in complex programs',
                        'Growing commercial technology offerings'
                    ],
                    competitiveWeaknesses: [
                        'Less diversified than top-tier primes',
                        'Heavy dependence on classified work',
                        'Limited international presence',
                        'Smaller scale than Tier 1 competitors'
                    ],
                    recentNews: [
                        { date: '2024-08-08', headline: 'CACI Acquires Cyber Analytics Firm for $340M', impact: 'high' },
                        { date: '2024-07-15', headline: 'Wins $500M Army Intelligence Contract', impact: 'high' },
                        { date: '2024-06-20', headline: 'Opens New Software Development Center', impact: 'medium' }
                    ],
                    pricingStrategy: {
                        approach: 'Competitive pricing with technical differentiation',
                        blendedRate: 165,
                        seniorRate: 245,
                        juniorRate: 115,
                        overhead: 1.38,
                        gAndA: 0.16
                    },
                    competitivePositioning: {
                        marketShare: 0.021,
                        winRateVsSMBs: 0.31,
                        averageBidScore: 8.2,
                        proposalWinRate: 0.38
                    }
                },
                'Accenture Federal': {
                    type: 'Large Business',
                    size: 'Fortune 100',
                    employees: 15000,
                    revenue: 4200000000,
                    governmentRevenue: 4200000000,
                    foundedYear: 1989,
                    headquarters: 'Arlington, VA',
                    ceo: 'John Goodman',
                    stockSymbol: 'ACN',
                    marketCap: 189000000000,
                    contracts2024: 2890,
                    avgContractSize: 6700000,
                    topAgencies: [
                        { agency: 'Department of Defense', contracts: 967, value: 2100000000, percentage: 50.0 },
                        { agency: 'Department of Health and Human Services', contracts: 723, value: 1200000000, percentage: 28.6 },
                        { agency: 'Department of Homeland Security', contracts: 534, value: 520000000, percentage: 12.4 },
                        { agency: 'General Services Administration', contracts: 666, value: 380000000, percentage: 9.0 }
                    ],
                    naicsSpecialties: [
                        { code: '541512', description: 'Computer Systems Design', contracts: 1089, value: 1800000000, growth: 0.267, winRate: 0.61 },
                        { code: '541511', description: 'Custom Programming', contracts: 867, value: 1300000000, growth: 0.234, winRate: 0.57 },
                        { code: '541618', description: 'Management Consulting', contracts: 634, value: 780000000, growth: 0.145, winRate: 0.69 },
                        { code: '541513', description: 'Facilities Management', contracts: 300, value: 320000000, growth: 0.089, winRate: 0.43 }
                    ],
                    competitiveStrengths: [
                        'Global technology expertise and resources',
                        'Strong commercial innovation transferred to government',
                        'Extensive partner ecosystem',
                        'Advanced digital transformation capabilities',
                        'Strong financial backing from parent company'
                    ],
                    competitiveWeaknesses: [
                        'Less government-specific cultural understanding',
                        'Higher commercial pricing expectations',
                        'Complex corporate structure for government sales',
                        'Limited cleared workforce compared to traditional contractors'
                    ],
                    recentNews: [
                        { date: '2024-08-12', headline: 'Launches Federal AI Practice with $2B Investment', impact: 'high' },
                        { date: '2024-07-28', headline: 'Wins VA Digital Modernization Contract', impact: 'high' },
                        { date: '2024-06-15', headline: 'Partners with Microsoft for Government Cloud', impact: 'medium' }
                    ],
                    pricingStrategy: {
                        approach: 'Premium value-based pricing',
                        blendedRate: 195,
                        seniorRate: 295,
                        juniorRate: 135,
                        overhead: 1.52,
                        gAndA: 0.22
                    },
                    competitivePositioning: {
                        marketShare: 0.019,
                        winRateVsSMBs: 0.18,
                        averageBidScore: 8.9,
                        proposalWinRate: 0.45
                    }
                },
                'ManTech International': {
                    type: 'Large Business',
                    size: 'Mid-Large',
                    employees: 9800,
                    revenue: 2800000000,
                    governmentRevenue: 2650000000,
                    foundedYear: 1968,
                    headquarters: 'Herndon, VA',
                    ceo: 'Matt Tait',
                    stockSymbol: 'MANT',
                    marketCap: 3400000000,
                    contracts2024: 1890,
                    avgContractSize: 2100000,
                    topAgencies: [
                        { agency: 'Department of Defense', contracts: 789, value: 1400000000, percentage: 52.8 },
                        { agency: 'Intelligence Community', contracts: 456, value: 780000000, percentage: 29.4 },
                        { agency: 'Department of Homeland Security', contracts: 345, value: 290000000, percentage: 10.9 },
                        { agency: 'Department of Health and Human Services', contracts: 300, value: 180000000, percentage: 6.8 }
                    ],
                    naicsSpecialties: [
                        { code: '541512', description: 'Computer Systems Design', contracts: 678, value: 980000000, growth: 0.156, winRate: 0.54 },
                        { code: '541330', description: 'Engineering Services', contracts: 456, value: 620000000, growth: 0.123, winRate: 0.48 },
                        { code: '541519', description: 'Other Computer Services', contracts: 389, value: 450000000, growth: 0.189, winRate: 0.59 },
                        { code: '561210', description: 'Security Services', contracts: 367, value: 520000000, growth: 0.201, winRate: 0.67 }
                    ],
                    competitiveStrengths: [
                        'Strong cybersecurity and mission-critical focus',
                        'Established intelligence community relationships',
                        'Flexible and responsive organization',
                        'Strong technical expertise in niche areas',
                        'Good past performance record'
                    ],
                    competitiveWeaknesses: [
                        'Smaller scale than top-tier competitors',
                        'Limited diversification outside core markets',
                        'Dependence on classified/cleared work',
                        'Less commercial technology transfer'
                    ],
                    recentNews: [
                        { date: '2024-07-30', headline: 'Acquired by Carlyle Group for $4.2B', impact: 'high' },
                        { date: '2024-07-18', headline: 'Wins $300M Navy Cybersecurity Contract', impact: 'medium' },
                        { date: '2024-06-25', headline: 'Expands Cloud Security Capabilities', impact: 'medium' }
                    ],
                    pricingStrategy: {
                        approach: 'Competitive pricing with technical focus',
                        blendedRate: 155,
                        seniorRate: 225,
                        juniorRate: 105,
                        overhead: 1.32,
                        gAndA: 0.15
                    },
                    competitivePositioning: {
                        marketShare: 0.012,
                        winRateVsSMBs: 0.42,
                        averageBidScore: 7.8,
                        proposalWinRate: 0.35
                    }
                }
            };

            // Market intelligence data
            const marketIntelligence = {
                overallMarket: {
                    totalValue: 678000000000,
                    contracts: 387000,
                    avgContractSize: 1750000,
                    growth: 0.067,
                    competitionRate: 0.34,
                    smallBusinessRate: 0.267
                },
                sectorTrends: [
                    { sector: 'Cybersecurity', growth: 0.234, value: 89000000000, opportunity: 'high' },
                    { sector: 'Artificial Intelligence', growth: 0.456, value: 23000000000, opportunity: 'high' },
                    { sector: 'Cloud Services', growth: 0.189, value: 67000000000, opportunity: 'high' },
                    { sector: 'Software Development', growth: 0.145, value: 134000000000, opportunity: 'medium' },
                    { sector: 'Data Analytics', growth: 0.298, value: 45000000000, opportunity: 'high' },
                    { sector: 'IT Infrastructure', growth: 0.089, value: 98000000000, opportunity: 'medium' }
                ],
                competitiveLandscape: {
                    totalCompetitors: 12847,
                    largeBusinesses: 234,
                    smallBusinesses: 12613,
                    marketConcentration: 0.23, // Top 10 companies control 23% of market
                    averageWinRate: 0.18,
                    pricingPressure: 'high'
                },
                winLossAnalysis: {
                    yourCompany: {
                        totalBids: 47,
                        wins: 23,
                        losses: 21,
                        pending: 3,
                        winRate: 0.52,
                        avgBidValue: 2300000,
                        competitiveWins: 18, // wins against major competitors
                        topReasons: ['Better Technical Approach', 'Cost Competitive', 'Past Performance']
                    },
                    industryBenchmarks: {
                        averageWinRate: 0.31,
                        topPerformers: 0.67,
                        pricingAdvantage: 0.15, // 15% pricing advantage needed
                        timeToAward: 127 // days average
                    },
                    lossAnalysis: [
                        { reason: 'Price too high', frequency: 38, impact: 'high' },
                        { reason: 'Incumbent advantage', frequency: 29, impact: 'medium' },
                        { reason: 'Technical capability gap', frequency: 19, impact: 'high' },
                        { reason: 'Past performance score', frequency: 14, impact: 'medium' }
                    ]
                },
                pricingIntelligence: {
                    benchmarkData: {
                        'Cybersecurity Services': { avgRate: 165, range: [120, 220], premium: 0.23 },
                        'Software Development': { avgRate: 145, range: [95, 185], premium: 0.18 },
                        'Data Analytics': { avgRate: 155, range: [110, 200], premium: 0.21 },
                        'Cloud Migration': { avgRate: 175, range: [130, 240], premium: 0.28 }
                    },
                    competitorPricing: {
                        'Booz Allen Hamilton': { premium: 0.45, strategy: 'Value-based' },
                        'CACI': { premium: 0.28, strategy: 'Competitive' },
                        'Accenture Federal': { premium: 0.52, strategy: 'Premium' },
                        'ManTech': { premium: 0.31, strategy: 'Competitive' }
                    },
                    pricingStrategies: [
                        { strategy: 'Cost Plus', frequency: 34, avgMargin: 0.08 },
                        { strategy: 'Fixed Price', frequency: 51, avgMargin: 0.12 },
                        { strategy: 'Time & Materials', frequency: 15, avgMargin: 0.15 }
                    ]
                },
                teamingOpportunities: [
                    {
                        partner: 'TechFlow Inc',
                        compatibility: 0.89,
                        complementaryCapabilities: ['DevSecOps', 'Cloud Architecture'],
                        pastCollaborations: 3,
                        successRate: 0.67,
                        preferredRole: 'Prime'
                    },
                    {
                        partner: 'ClearanceJobs Solutions',
                        compatibility: 0.84,
                        complementaryCapabilities: ['Security Clearance', 'Personnel'],
                        pastCollaborations: 1,
                        successRate: 1.0,
                        preferredRole: 'Sub'
                    },
                    {
                        partner: 'DataViz Pro',
                        compatibility: 0.76,
                        complementaryCapabilities: ['Data Visualization', 'Business Intelligence'],
                        pastCollaborations: 0,
                        successRate: null,
                        preferredRole: 'Sub'
                    }
                ]
            };

            const currentCompetitor = competitorDatabase[selectedCompetitor];

            // Visualization Components
            const CompetitorOverviewCard = ({ competitor }) => (
                <div className="card">
                    <div className="card-header">
                        <h3 className="card-title">
                            <i className="fas fa-building"></i>
                            {selectedCompetitor}
                        </h3>
                        <span className={`badge ${competitor.type === 'Large Business' ? 'badge-info' : 'badge-success'}`}>
                            {competitor.type}
                        </span>
                    </div>
                    <div className="card-content">
                        <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr 1fr', gap: '20px' }}>
                            <div>
                                <div style={{ fontSize: '0.875rem', color: 'var(--gray-600)', marginBottom: '4px' }}>Annual Revenue</div>
                                <div style={{ fontSize: '1.5rem', fontWeight: '700', color: 'var(--success-green)' }}>
                                    {formatCurrency(competitor.revenue)}
                                </div>
                                <div style={{ fontSize: '0.75rem', color: 'var(--gray-500)' }}>
                                    {Math.round((competitor.governmentRevenue / competitor.revenue) * 100)}% Government
                                </div>
                            </div>
                            <div>
                                <div style={{ fontSize: '0.875rem', color: 'var(--gray-600)', marginBottom: '4px' }}>Employees</div>
                                <div style={{ fontSize: '1.5rem', fontWeight: '700', color: 'var(--primary-blue)' }}>
                                    {competitor.employees.toLocaleString()}
                                </div>
                                <div style={{ fontSize: '0.75rem', color: 'var(--gray-500)' }}>
                                    Founded {competitor.foundedYear}
                                </div>
                            </div>
                            <div>
                                <div style={{ fontSize: '0.875rem', color: 'var(--gray-600)', marginBottom: '4px' }}>Avg Contract Size</div>
                                <div style={{ fontSize: '1.5rem', fontWeight: '700', color: 'var(--warning-orange)' }}>
                                    {formatCurrency(competitor.avgContractSize)}
                                </div>
                                <div style={{ fontSize: '0.75rem', color: 'var(--gray-500)' }}>
                                    {competitor.contracts2024.toLocaleString()} contracts in 2024
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );

            const AgencyBreakdownChart = ({ agencies }) => (
                <div className="card">
                    <div className="card-header">
                        <h3 className="card-title">
                            <i className="fas fa-chart-pie"></i>
                            Agency Revenue Breakdown
                        </h3>
                    </div>
                    <div className="card-content">
                        <div style={{ display: 'grid', gap: '12px' }}>
                            {agencies.map((agency, index) => (
                                <div key={agency.agency} style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
                                    <div style={{ minWidth: '180px', fontSize: '0.875rem', fontWeight: '500' }}>
                                        {agency.agency}
                                    </div>
                                    <div style={{ 
                                        flex: 1, 
                                        height: '8px', 
                                        backgroundColor: 'var(--gray-200)', 
                                        borderRadius: '4px', 
                                        overflow: 'hidden' 
                                    }}>
                                        <div style={{
                                            width: `${agency.percentage}%`,
                                            height: '100%',
                                            backgroundColor: ['var(--success-green)', 'var(--primary-blue)', 'var(--warning-orange)', 'var(--danger-red)'][index] || 'var(--gray-400)',
                                            borderRadius: '4px'
                                        }}></div>
                                    </div>
                                    <div style={{ minWidth: '80px', textAlign: 'right', fontSize: '0.875rem', fontWeight: '600' }}>
                                        {agency.percentage}%
                                    </div>
                                    <div style={{ minWidth: '80px', textAlign: 'right', fontSize: '0.75rem', color: 'var(--gray-600)' }}>
                                        {formatCurrency(agency.value)}
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );

            const NAICSCompetitionMatrix = ({ naicsData }) => (
                <div className="card">
                    <div className="card-header">
                        <h3 className="card-title">
                            <i className="fas fa-crosshairs"></i>
                            NAICS Competition Matrix
                        </h3>
                    </div>
                    <div className="card-content">
                        <table className="table">
                            <thead>
                                <tr>
                                    <th>NAICS Code</th>
                                    <th>Description</th>
                                    <th>Contracts</th>
                                    <th>Value</th>
                                    <th>Growth</th>
                                    <th>Win Rate</th>
                                    <th>Threat Level</th>
                                </tr>
                            </thead>
                            <tbody>
                                {naicsData.map((naics) => (
                                    <tr key={naics.code}>
                                        <td style={{ fontWeight: '600', color: 'var(--primary-blue)' }}>
                                            {naics.code}
                                        </td>
                                        <td>{naics.description}</td>
                                        <td style={{ textAlign: 'center' }}>{naics.contracts.toLocaleString()}</td>
                                        <td style={{ fontWeight: '600' }}>{formatCurrency(naics.value)}</td>
                                        <td>
                                            <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
                                                <span style={{ 
                                                    color: naics.growth > 0.2 ? 'var(--success-green)' : 
                                                           naics.growth > 0.1 ? 'var(--warning-orange)' : 'var(--danger-red)',
                                                    fontWeight: '600'
                                                }}>
                                                    {Math.round(naics.growth * 100)}%
                                                </span>
                                                <i className={`fas ${naics.growth > 0.1 ? 'fa-arrow-up' : 'fa-arrow-down'}`} 
                                                   style={{ 
                                                       color: naics.growth > 0.1 ? 'var(--success-green)' : 'var(--danger-red)',
                                                       fontSize: '0.75rem'
                                                   }}></i>
                                            </div>
                                        </td>
                                        <td>
                                            <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
                                                <div style={{
                                                    width: '40px',
                                                    height: '6px',
                                                    backgroundColor: 'var(--gray-200)',
                                                    borderRadius: '3px',
                                                    overflow: 'hidden'
                                                }}>
                                                    <div style={{
                                                        width: `${naics.winRate * 40}px`,
                                                        height: '100%',
                                                        backgroundColor: naics.winRate > 0.6 ? 'var(--success-green)' : 
                                                                       naics.winRate > 0.4 ? 'var(--warning-orange)' : 'var(--danger-red)',
                                                        borderRadius: '3px'
                                                    }}></div>
                                                </div>
                                                <span style={{ fontSize: '0.875rem', fontWeight: '600' }}>
                                                    {Math.round(naics.winRate * 100)}%
                                                </span>
                                            </div>
                                        </td>
                                        <td>
                                            <span className={`badge ${
                                                naics.winRate > 0.6 ? 'badge-danger' :
                                                naics.winRate > 0.4 ? 'badge-warning' : 'badge-success'
                                            }`}>
                                                {naics.winRate > 0.6 ? 'High' : naics.winRate > 0.4 ? 'Medium' : 'Low'}
                                            </span>
                                        </td>
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                    </div>
                </div>
            );

            const CompetitiveStrengthsWeaknesses = ({ strengths, weaknesses }) => (
                <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '24px' }}>
                    <div className="card">
                        <div className="card-header">
                            <h3 className="card-title">
                                <i className="fas fa-shield-alt" style={{ color: 'var(--success-green)' }}></i>
                                Competitive Strengths
                            </h3>
                        </div>
                        <div className="card-content">
                            <div style={{ display: 'grid', gap: '12px' }}>
                                {strengths.map((strength, index) => (
                                    <div key={index} style={{ 
                                        display: 'flex', 
                                        alignItems: 'flex-start', 
                                        gap: '12px',
                                        padding: '12px',
                                        backgroundColor: 'rgba(16, 185, 129, 0.05)',
                                        borderRadius: '8px',
                                        border: '1px solid rgba(16, 185, 129, 0.2)'
                                    }}>
                                        <i className="fas fa-check-circle" style={{ 
                                            color: 'var(--success-green)', 
                                            marginTop: '2px',
                                            fontSize: '0.875rem'
                                        }}></i>
                                        <span style={{ fontSize: '0.875rem', lineHeight: '1.5' }}>
                                            {strength}
                                        </span>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </div>

                    <div className="card">
                        <div className="card-header">
                            <h3 className="card-title">
                                <i className="fas fa-exclamation-triangle" style={{ color: 'var(--warning-orange)' }}></i>
                                Competitive Weaknesses
                            </h3>
                        </div>
                        <div className="card-content">
                            <div style={{ display: 'grid', gap: '12px' }}>
                                {weaknesses.map((weakness, index) => (
                                    <div key={index} style={{ 
                                        display: 'flex', 
                                        alignItems: 'flex-start', 
                                        gap: '12px',
                                        padding: '12px',
                                        backgroundColor: 'rgba(245, 158, 11, 0.05)',
                                        borderRadius: '8px',
                                        border: '1px solid rgba(245, 158, 11, 0.2)'
                                    }}>
                                        <i className="fas fa-times-circle" style={{ 
                                            color: 'var(--warning-orange)', 
                                            marginTop: '2px',
                                            fontSize: '0.875rem'
                                        }}></i>
                                        <span style={{ fontSize: '0.875rem', lineHeight: '1.5' }}>
                                            {weakness}
                                        </span>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </div>
                </div>
            );

            const MarketIntelligenceOverview = () => (
                <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr', gap: '24px' }}>
                    <div>
                        <div className="card">
                            <div className="card-header">
                                <h3 className="card-title">
                                    <i className="fas fa-trending-up"></i>
                                    Market Sector Growth Analysis
                                </h3>
                            </div>
                            <div className="card-content">
                                <div style={{ display: 'grid', gap: '16px' }}>
                                    {marketIntelligence.sectorTrends.map((sector, index) => (
                                        <div key={sector.sector} style={{
                                            display: 'flex',
                                            alignItems: 'center',
                                            gap: '16px',
                                            padding: '16px',
                                            backgroundColor: 'var(--gray-50)',
                                            borderRadius: '8px',
                                            border: `1px solid ${sector.opportunity === 'high' ? 'var(--success-green)' : 'var(--warning-orange)'}`
                                        }}>
                                            <div style={{ flex: 1 }}>
                                                <div style={{ fontSize: '1rem', fontWeight: '600', marginBottom: '4px' }}>
                                                    {sector.sector}
                                                </div>
                                                <div style={{ fontSize: '0.875rem', color: 'var(--gray-600)' }}>
                                                    Market Value: {formatCurrency(sector.value)}
                                                </div>
                                            </div>
                                            <div style={{ textAlign: 'center' }}>
                                                <div style={{ 
                                                    fontSize: '1.25rem', 
                                                    fontWeight: '700',
                                                    color: sector.growth > 0.2 ? 'var(--success-green)' : 'var(--warning-orange)'
                                                }}>
                                                    +{Math.round(sector.growth * 100)}%
                                                </div>
                                                <div style={{ fontSize: '0.75rem', color: 'var(--gray-500)' }}>
                                                    Growth Rate
                                                </div>
                                            </div>
                                            <div>
                                                <span className={`badge ${
                                                    sector.opportunity === 'high' ? 'badge-success' : 'badge-warning'
                                                }`}>
                                                    {sector.opportunity} opportunity
                                                </span>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>
                    </div>

                    <div>
                        <div className="card" style={{ marginBottom: '16px' }}>
                            <div className="card-header">
                                <h3 className="card-title">
                                    <i className="fas fa-chart-pie"></i>
                                    Market Overview
                                </h3>
                            </div>
                            <div className="card-content">
                                <div style={{ display: 'grid', gap: '16px' }}>
                                    <div>
                                        <div style={{ fontSize: '0.875rem', color: 'var(--gray-600)', marginBottom: '4px' }}>
                                            Total Market Value
                                        </div>
                                        <div style={{ fontSize: '1.5rem', fontWeight: '700', color: 'var(--success-green)' }}>
                                            {formatCurrency(marketIntelligence.overallMarket.totalValue)}
                                        </div>
                                    </div>
                                    <div>
                                        <div style={{ fontSize: '0.875rem', color: 'var(--gray-600)', marginBottom: '4px' }}>
                                            Total Contracts
                                        </div>
                                        <div style={{ fontSize: '1.5rem', fontWeight: '700', color: 'var(--primary-blue)' }}>
                                            {marketIntelligence.overallMarket.contracts.toLocaleString()}
                                        </div>
                                    </div>
                                    <div>
                                        <div style={{ fontSize: '0.875rem', color: 'var(--gray-600)', marginBottom: '4px' }}>
                                            Market Growth
                                        </div>
                                        <div style={{ fontSize: '1.5rem', fontWeight: '700', color: 'var(--success-green)' }}>
                                            +{Math.round(marketIntelligence.overallMarket.growth * 100)}%
                                        </div>
                                    </div>
                                    <div>
                                        <div style={{ fontSize: '0.875rem', color: 'var(--gray-600)', marginBottom: '4px' }}>
                                            Small Business Rate
                                        </div>
                                        <div style={{ fontSize: '1.5rem', fontWeight: '700', color: 'var(--warning-orange)' }}>
                                            {Math.round(marketIntelligence.overallMarket.smallBusinessRate * 100)}%
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div className="card">
                            <div className="card-header">
                                <h3 className="card-title">
                                    <i className="fas fa-users"></i>
                                    Competitive Landscape
                                </h3>
                            </div>
                            <div className="card-content">
                                <div style={{ display: 'grid', gap: '12px' }}>
                                    <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                        <span style={{ fontSize: '0.875rem' }}>Total Competitors</span>
                                        <span style={{ fontWeight: '600' }}>
                                            {marketIntelligence.competitiveLandscape.totalCompetitors.toLocaleString()}
                                        </span>
                                    </div>
                                    <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                        <span style={{ fontSize: '0.875rem' }}>Large Businesses</span>
                                        <span style={{ fontWeight: '600' }}>
                                            {marketIntelligence.competitiveLandscape.largeBusinesses.toLocaleString()}
                                        </span>
                                    </div>
                                    <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                        <span style={{ fontSize: '0.875rem' }}>Small Businesses</span>
                                        <span style={{ fontWeight: '600' }}>
                                            {marketIntelligence.competitiveLandscape.smallBusinesses.toLocaleString()}
                                        </span>
                                    </div>
                                    <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                        <span style={{ fontSize: '0.875rem' }}>Market Concentration</span>
                                        <span style={{ fontWeight: '600' }}>
                                            {Math.round(marketIntelligence.competitiveLandscape.marketConcentration * 100)}%
                                        </span>
                                    </div>
                                    <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                        <span style={{ fontSize: '0.875rem' }}>Average Win Rate</span>
                                        <span style={{ fontWeight: '600' }}>
                                            {Math.round(marketIntelligence.competitiveLandscape.averageWinRate * 100)}%
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );

            return (
                <div>
                    {/* Header */}
                    <div style={{ 
                        display: 'flex', 
                        justifyContent: 'space-between', 
                        alignItems: 'center', 
                        marginBottom: '24px',
                        padding: '20px',
                        backgroundColor: 'white',
                        borderRadius: '12px',
                        border: '1px solid var(--gray-200)'
                    }}>
                        <div>
                            <h2 style={{ fontSize: '1.5rem', fontWeight: '600', color: 'var(--gray-800)', margin: 0 }}>
                                Competitive Intelligence & Market Analysis
                            </h2>
                            <p style={{ color: 'var(--gray-600)', margin: '4px 0 0 0', fontSize: '0.875rem' }}>
                                Deep competitive insights and market intelligence for strategic advantage
                            </p>
                        </div>
                        <div style={{ display: 'flex', gap: '12px', alignItems: 'center' }}>
                            <select 
                                value={competitiveView} 
                                onChange={(e) => setCompetitiveView(e.target.value)}
                                className="btn"
                                style={{ border: '1px solid var(--gray-300)' }}
                            >
                                <option value="overview">Overview</option>
                                <option value="competitors">Competitor Analysis</option>
                                <option value="market">Market Intelligence</option>
                                <option value="pricing">Pricing Analysis</option>
                            </select>
                            <button className="btn btn-primary">
                                <i className="fas fa-download"></i> Export Report
                            </button>
                        </div>
                    </div>

                    {/* Navigation Tabs */}
                    <div style={{ 
                        display: 'flex', 
                        gap: '4px', 
                        marginBottom: '24px',
                        backgroundColor: 'white',
                        padding: '4px',
                        borderRadius: '12px',
                        border: '1px solid var(--gray-200)'
                    }}>
                        {[
                            { id: 'overview', label: 'Market Overview', icon: 'fas fa-chart-area' },
                            { id: 'competitors', label: 'Competitor Analysis', icon: 'fas fa-crosshairs' },
                            { id: 'market', label: 'Market Intelligence', icon: 'fas fa-brain' },
                            { id: 'winloss', label: 'Win/Loss Analysis', icon: 'fas fa-trophy' },
                            { id: 'pricing', label: 'Pricing Intelligence', icon: 'fas fa-dollar-sign' },
                            { id: 'teaming', label: 'Teaming Partners', icon: 'fas fa-handshake' }
                        ].map(tab => (
                            <button
                                key={tab.id}
                                onClick={() => setCompetitiveView(tab.id)}
                                style={{
                                    flex: 1,
                                    padding: '12px 16px',
                                    border: 'none',
                                    background: competitiveView === tab.id ? 'var(--primary-blue)' : 'transparent',
                                    color: competitiveView === tab.id ? 'white' : 'var(--gray-600)',
                                    borderRadius: '8px',
                                    cursor: 'pointer',
                                    fontSize: '0.875rem',
                                    fontWeight: '500',
                                    transition: 'all 0.2s',
                                    display: 'flex',
                                    alignItems: 'center',
                                    justifyContent: 'center',
                                    gap: '8px'
                                }}
                            >
                                <i className={tab.icon}></i>
                                {tab.label}
                            </button>
                        ))}
                    </div>

                    {/* Content based on selected view */}
                    {competitiveView === 'overview' && <MarketIntelligenceOverview />}
                    
                    {competitiveView === 'competitors' && (
                        <div>
                            {/* Competitor Selection */}
                            <div style={{ marginBottom: '24px' }}>
                                <select 
                                    value={selectedCompetitor} 
                                    onChange={(e) => setSelectedCompetitor(e.target.value)}
                                    className="btn"
                                    style={{ border: '1px solid var(--gray-300)', minWidth: '300px' }}
                                >
                                    {Object.keys(competitorDatabase).map(competitor => (
                                        <option key={competitor} value={competitor}>{competitor}</option>
                                    ))}
                                </select>
                            </div>

                            <div style={{ display: 'grid', gap: '24px' }}>
                                <CompetitorOverviewCard competitor={currentCompetitor} />
                                <AgencyBreakdownChart agencies={currentCompetitor.topAgencies} />
                                <NAICSCompetitionMatrix naicsData={currentCompetitor.naicsSpecialties} />
                                <CompetitiveStrengthsWeaknesses 
                                    strengths={currentCompetitor.competitiveStrengths}
                                    weaknesses={currentCompetitor.competitiveWeaknesses}
                                />
                            </div>
                        </div>
                    )}

                    {competitiveView === 'market' && <MarketIntelligenceView />}
                    {competitiveView === 'winloss' && <WinLossAnalysisView />}
                    {competitiveView === 'pricing' && <PricingIntelligenceView />}
                    {competitiveView === 'teaming' && <TeamingPartnersView />}
                </div>
            );
        };

        // Comprehensive Market Intelligence View with Advanced Analytics
        const MarketIntelligenceView = () => {
            const [marketView, setMarketView] = useState('overview');
            const [selectedTimeframe, setSelectedTimeframe] = useState('12months');
            const [selectedAgency, setSelectedAgency] = useState('all');

            // Enhanced market intelligence data
            const advancedMarketData = {
                marketForecasting: {
                    '2024': { value: 678000000000, growth: 0.067, contracts: 387000 },
                    '2025': { value: 721000000000, growth: 0.063, contracts: 401000 },
                    '2026': { value: 767000000000, growth: 0.064, contracts: 418000 },
                    '2027': { value: 817000000000, growth: 0.065, contracts: 436000 }
                },
                agencySpending: [
                    { agency: 'Department of Defense', spending: 234000000000, growth: 0.078, contracts: 89000, avgSize: 2629000, opportunity: 'high' },
                    { agency: 'Department of Health and Human Services', spending: 67000000000, growth: 0.123, contracts: 34000, avgSize: 1970000, opportunity: 'high' },
                    { agency: 'Department of Homeland Security', spending: 45000000000, growth: 0.089, contracts: 23000, avgSize: 1956000, opportunity: 'medium' },
                    { agency: 'NASA', spending: 28000000000, growth: 0.156, contracts: 12000, avgSize: 2333000, opportunity: 'high' },
                    { agency: 'Department of Energy', spending: 34000000000, growth: 0.067, contracts: 18000, avgSize: 1888000, opportunity: 'medium' },
                    { agency: 'Veterans Affairs', spending: 43000000000, growth: 0.098, contracts: 21000, avgSize: 2047000, opportunity: 'high' }
                ],
                contractTiming: {
                    averageTimeToAward: 127,
                    byAgency: {
                        'DOD': 134,
                        'DHS': 118,
                        'NASA': 142,
                        'VA': 109,
                        'DOE': 125
                    },
                    seasonalPatterns: [
                        { month: 'Jan', volume: 0.08, avgAward: 98 },
                        { month: 'Feb', volume: 0.07, avgAward: 105 },
                        { month: 'Mar', volume: 0.09, avgAward: 112 },
                        { month: 'Apr', volume: 0.08, avgAward: 119 },
                        { month: 'May', volume: 0.09, avgAward: 127 },
                        { month: 'Jun', volume: 0.11, avgAward: 134 },
                        { month: 'Jul', volume: 0.09, avgAward: 141 },
                        { month: 'Aug', volume: 0.08, avgAward: 148 },
                        { month: 'Sep', volume: 0.13, avgAward: 155 },
                        { month: 'Oct', volume: 0.10, avgAward: 145 },
                        { month: 'Nov', volume: 0.06, avgAward: 138 },
                        { month: 'Dec', volume: 0.05, avgAward: 131 }
                    ]
                },
                emergingOpportunities: [
                    {
                        sector: 'Quantum Computing',
                        maturity: 'emerging',
                        marketSize: 2800000000,
                        growthRate: 0.89,
                        keyAgencies: ['DOD', 'NSA', 'DOE'],
                        riskLevel: 'medium',
                        timeToMarket: 18
                    },
                    {
                        sector: 'Space Technology',
                        maturity: 'growing',
                        marketSize: 12400000000,
                        growthRate: 0.34,
                        keyAgencies: ['NASA', 'Space Force', 'NOAA'],
                        riskLevel: 'low',
                        timeToMarket: 12
                    },
                    {
                        sector: 'Biometric Security',
                        maturity: 'maturing',
                        marketSize: 8900000000,
                        growthRate: 0.23,
                        keyAgencies: ['DHS', 'CBP', 'TSA'],
                        riskLevel: 'low',
                        timeToMarket: 6
                    }
                ],
                marketConcentration: {
                    herfindahlIndex: 0.12, // Low concentration = competitive market
                    top10Share: 0.23,
                    top50Share: 0.67,
                    smallBusinessShare: 0.267,
                    concentrationTrend: -0.02 // Becoming less concentrated
                }
            };

            return (
                <div style={{ display: 'grid', gap: '24px' }}>
                    {/* Market Intelligence Header with Controls */}
                    <div className="card">
                        <div className="card-header">
                            <div>
                                <h3 className="card-title">Advanced Market Intelligence</h3>
                                <p style={{ color: 'var(--gray-600)', fontSize: '0.875rem', margin: 0 }}>
                                    Comprehensive market analysis with predictive insights
                                </p>
                            </div>
                            <div style={{ display: 'flex', gap: '12px', alignItems: 'center' }}>
                                <select 
                                    value={selectedTimeframe} 
                                    onChange={(e) => setSelectedTimeframe(e.target.value)}
                                    className="btn"
                                    style={{ border: '1px solid var(--gray-300)' }}
                                >
                                    <option value="6months">6 Months</option>
                                    <option value="12months">12 Months</option>
                                    <option value="24months">24 Months</option>
                                </select>
                                <select 
                                    value={selectedAgency} 
                                    onChange={(e) => setSelectedAgency(e.target.value)}
                                    className="btn"
                                    style={{ border: '1px solid var(--gray-300)' }}
                                >
                                    <option value="all">All Agencies</option>
                                    <option value="dod">Department of Defense</option>
                                    <option value="dhs">Department of Homeland Security</option>
                                    <option value="nasa">NASA</option>
                                </select>
                            </div>
                        </div>
                        <div className="card-content">
                            {/* Market Intelligence Tabs */}
                            <div style={{
                                display: 'flex',
                                gap: '4px',
                                marginBottom: '24px',
                                padding: '4px',
                                borderRadius: '12px',
                                border: '1px solid var(--gray-200)'
                            }}>
                                {[
                                    { id: 'overview', label: 'Market Overview', icon: 'fas fa-chart-area' },
                                    { id: 'forecasting', label: 'Market Forecasting', icon: 'fas fa-crystal-ball' },
                                    { id: 'agencies', label: 'Agency Analysis', icon: 'fas fa-building' },
                                    { id: 'timing', label: 'Award Timing', icon: 'fas fa-clock' },
                                    { id: 'emerging', label: 'Emerging Sectors', icon: 'fas fa-rocket' },
                                    { id: 'concentration', label: 'Market Structure', icon: 'fas fa-sitemap' }
                                ].map(tab => (
                                    <button
                                        key={tab.id}
                                        onClick={() => setMarketView(tab.id)}
                                        style={{
                                            flex: 1,
                                            padding: '8px 12px',
                                            border: 'none',
                                            background: marketView === tab.id ? 'var(--primary-blue)' : 'transparent',
                                            color: marketView === tab.id ? 'white' : 'var(--gray-600)',
                                            borderRadius: '8px',
                                            cursor: 'pointer',
                                            fontSize: '0.75rem',
                                            fontWeight: '500',
                                            transition: 'all 0.2s',
                                            display: 'flex',
                                            flexDirection: 'column',
                                            alignItems: 'center',
                                            gap: '4px'
                                        }}
                                    >
                                        <i className={tab.icon}></i>
                                        {tab.label}
                                    </button>
                                ))}
                            </div>

                            {/* Market Overview */}
                            {marketView === 'overview' && (
                                <div style={{ display: 'grid', gap: '24px' }}>
                                    <div className="kpi-grid">
                                        <KPICard
                                            title="Total Market Value"
                                            value={formatCurrency(marketIntelligence.overallMarket.totalValue)}
                                            change={marketIntelligence.overallMarket.growth * 100}
                                            icon="fas fa-chart-line"
                                            iconColor="var(--primary-blue)"
                                        />
                                        <KPICard
                                            title="Market Concentration"
                                            value={`${Math.round(advancedMarketData.marketConcentration.herfindahlIndex * 100)}/100`}
                                            change={advancedMarketData.marketConcentration.concentrationTrend * 100}
                                            icon="fas fa-sitemap"
                                            iconColor="var(--success-green)"
                                        />
                                        <KPICard
                                            title="Small Business Share"
                                            value={`${Math.round(advancedMarketData.marketConcentration.smallBusinessShare * 100)}%`}
                                            change={3}
                                            icon="fas fa-store"
                                            iconColor="var(--warning-orange)"
                                        />
                                        <KPICard
                                            title="Avg Award Time"
                                            value={`${advancedMarketData.contractTiming.averageTimeToAward} days`}
                                            change={-5}
                                            icon="fas fa-hourglass-half"
                                            iconColor="var(--danger-red)"
                                        />
                                    </div>

                                    {/* High-Growth Sectors */}
                                    <div className="card">
                                        <div className="card-header">
                                            <h4 className="card-title">High-Growth Market Sectors</h4>
                                        </div>
                                        <div className="card-content">
                                            <div style={{ display: 'grid', gap: '16px' }}>
                                                {marketIntelligence.sectorTrends.map(sector => (
                                                    <div key={sector.sector} style={{
                                                        display: 'flex',
                                                        justifyContent: 'space-between',
                                                        alignItems: 'center',
                                                        padding: '16px',
                                                        backgroundColor: 'var(--gray-50)',
                                                        borderRadius: '8px',
                                                        border: `2px solid ${sector.opportunity === 'high' ? 'var(--success-green)' : 'var(--gray-200)'}`
                                                    }}>
                                                        <div>
                                                            <div style={{ fontWeight: '600' }}>{sector.sector}</div>
                                                            <div style={{ fontSize: '0.875rem', color: 'var(--gray-600)' }}>
                                                                Market Value: {formatCurrency(sector.value)}
                                                            </div>
                                                        </div>
                                                        <div style={{ textAlign: 'right' }}>
                                                            <div style={{ 
                                                                fontSize: '1.25rem', 
                                                                fontWeight: '700',
                                                                color: sector.growth > 0.2 ? 'var(--success-green)' : 'var(--warning-orange)'
                                                            }}>
                                                                +{Math.round(sector.growth * 100)}%
                                                            </div>
                                                            <div style={{ 
                                                                fontSize: '0.75rem', 
                                                                color: 'white',
                                                                backgroundColor: sector.opportunity === 'high' ? 'var(--success-green)' : 'var(--warning-orange)',
                                                                padding: '2px 8px',
                                                                borderRadius: '12px'
                                                            }}>
                                                                {sector.opportunity.toUpperCase()} OPPORTUNITY
                                                            </div>
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* Market Forecasting */}
                            {marketView === 'forecasting' && (
                                <div style={{ display: 'grid', gap: '24px' }}>
                                    <div className="card">
                                        <div className="card-header">
                                            <h4 className="card-title">4-Year Market Projection</h4>
                                        </div>
                                        <div className="card-content">
                                            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(4, 1fr)', gap: '16px', marginBottom: '24px' }}>
                                                {Object.entries(advancedMarketData.marketForecasting).map(([year, data]) => (
                                                    <div key={year} style={{
                                                        textAlign: 'center',
                                                        padding: '20px',
                                                        backgroundColor: year === '2024' ? 'var(--primary-blue)' : 'var(--gray-50)',
                                                        color: year === '2024' ? 'white' : 'var(--gray-800)',
                                                        borderRadius: '12px',
                                                        border: year === '2024' ? 'none' : '1px solid var(--gray-200)'
                                                    }}>
                                                        <div style={{ fontSize: '1.25rem', fontWeight: '700', marginBottom: '8px' }}>
                                                            {year}
                                                        </div>
                                                        <div style={{ fontSize: '1.5rem', fontWeight: '700', marginBottom: '4px' }}>
                                                            {formatCurrency(data.value)}
                                                        </div>
                                                        <div style={{ fontSize: '0.875rem', opacity: 0.8 }}>
                                                            +{Math.round(data.growth * 100)}% growth
                                                        </div>
                                                        <div style={{ fontSize: '0.75rem', opacity: 0.7, marginTop: '8px' }}>
                                                            {data.contracts.toLocaleString()} contracts
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>

                                            <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '24px' }}>
                                                <div>
                                                    <h5 style={{ marginBottom: '12px' }}>Key Growth Drivers</h5>
                                                    <div style={{ display: 'grid', gap: '8px' }}>
                                                        {[
                                                            'Digital Transformation Initiatives',
                                                            'Cybersecurity Modernization',
                                                            'AI/ML Integration Requirements',
                                                            'Cloud Migration Programs'
                                                        ].map(driver => (
                                                            <div key={driver} style={{
                                                                display: 'flex',
                                                                alignItems: 'center',
                                                                gap: '8px',
                                                                fontSize: '0.875rem'
                                                            }}>
                                                                <i className="fas fa-arrow-up" style={{ color: 'var(--success-green)' }}></i>
                                                                {driver}
                                                            </div>
                                                        ))}
                                                    </div>
                                                </div>
                                                <div>
                                                    <h5 style={{ marginBottom: '12px' }}>Market Risks</h5>
                                                    <div style={{ display: 'grid', gap: '8px' }}>
                                                        {[
                                                            'Budget Appropriation Delays',
                                                            'Regulatory Changes',
                                                            'Economic Uncertainty',
                                                            'Political Transitions'
                                                        ].map(risk => (
                                                            <div key={risk} style={{
                                                                display: 'flex',
                                                                alignItems: 'center',
                                                                gap: '8px',
                                                                fontSize: '0.875rem'
                                                            }}>
                                                                <i className="fas fa-exclamation-triangle" style={{ color: 'var(--warning-orange)' }}></i>
                                                                {risk}
                                                            </div>
                                                        ))}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* Agency Analysis */}
                            {marketView === 'agencies' && (
                                <div className="card">
                                    <div className="card-header">
                                        <h4 className="card-title">Agency Spending Analysis</h4>
                                    </div>
                                    <div className="card-content">
                                        <div style={{ display: 'grid', gap: '16px' }}>
                                            {advancedMarketData.agencySpending.map(agency => (
                                                <div key={agency.agency} style={{
                                                    display: 'grid',
                                                    gridTemplateColumns: '2fr 1fr 1fr 1fr 1fr',
                                                    gap: '16px',
                                                    alignItems: 'center',
                                                    padding: '16px',
                                                    backgroundColor: 'var(--gray-50)',
                                                    borderRadius: '8px',
                                                    border: `2px solid ${agency.opportunity === 'high' ? 'var(--success-green)' : 'var(--gray-200)'}`
                                                }}>
                                                    <div>
                                                        <div style={{ fontWeight: '600', marginBottom: '4px' }}>{agency.agency}</div>
                                                        <div style={{ 
                                                            fontSize: '0.75rem', 
                                                            color: 'white',
                                                            backgroundColor: agency.opportunity === 'high' ? 'var(--success-green)' : 'var(--warning-orange)',
                                                            padding: '2px 8px',
                                                            borderRadius: '12px',
                                                            width: 'fit-content'
                                                        }}>
                                                            {agency.opportunity.toUpperCase()}
                                                        </div>
                                                    </div>
                                                    <div style={{ textAlign: 'center' }}>
                                                        <div style={{ fontSize: '1.125rem', fontWeight: '600' }}>
                                                            {formatCurrency(agency.spending)}
                                                        </div>
                                                        <div style={{ fontSize: '0.75rem', color: 'var(--gray-600)' }}>Total Spending</div>
                                                    </div>
                                                    <div style={{ textAlign: 'center' }}>
                                                        <div style={{ 
                                                            fontSize: '1.125rem', 
                                                            fontWeight: '600',
                                                            color: agency.growth > 0.1 ? 'var(--success-green)' : 'var(--warning-orange)'
                                                        }}>
                                                            +{Math.round(agency.growth * 100)}%
                                                        </div>
                                                        <div style={{ fontSize: '0.75rem', color: 'var(--gray-600)' }}>Growth Rate</div>
                                                    </div>
                                                    <div style={{ textAlign: 'center' }}>
                                                        <div style={{ fontSize: '1.125rem', fontWeight: '600' }}>
                                                            {agency.contracts.toLocaleString()}
                                                        </div>
                                                        <div style={{ fontSize: '0.75rem', color: 'var(--gray-600)' }}>Contracts</div>
                                                    </div>
                                                    <div style={{ textAlign: 'center' }}>
                                                        <div style={{ fontSize: '1.125rem', fontWeight: '600' }}>
                                                            {formatCurrency(agency.avgSize)}
                                                        </div>
                                                        <div style={{ fontSize: '0.75rem', color: 'var(--gray-600)' }}>Avg Size</div>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* Award Timing Analysis */}
                            {marketView === 'timing' && (
                                <div style={{ display: 'grid', gap: '24px' }}>
                                    <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '24px' }}>
                                        <div className="card">
                                            <div className="card-header">
                                                <h4 className="card-title">Award Timing by Agency</h4>
                                            </div>
                                            <div className="card-content">
                                                <div style={{ display: 'grid', gap: '12px' }}>
                                                    {Object.entries(advancedMarketData.contractTiming.byAgency).map(([agency, days]) => (
                                                        <div key={agency} style={{
                                                            display: 'flex',
                                                            justifyContent: 'space-between',
                                                            alignItems: 'center',
                                                            padding: '12px 0',
                                                            borderBottom: '1px solid var(--gray-200)'
                                                        }}>
                                                            <span style={{ fontWeight: '500' }}>{agency}</span>
                                                            <span style={{ 
                                                                fontWeight: '600',
                                                                color: days < 120 ? 'var(--success-green)' : days > 140 ? 'var(--danger-red)' : 'var(--warning-orange)'
                                                            }}>
                                                                {days} days
                                                            </span>
                                                        </div>
                                                    ))}
                                                </div>
                                            </div>
                                        </div>

                                        <div className="card">
                                            <div className="card-header">
                                                <h4 className="card-title">Seasonal Award Patterns</h4>
                                            </div>
                                            <div className="card-content">
                                                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(4, 1fr)', gap: '8px' }}>
                                                    {advancedMarketData.contractTiming.seasonalPatterns.map(month => (
                                                        <div key={month.month} style={{
                                                            textAlign: 'center',
                                                            padding: '12px 8px',
                                                            backgroundColor: month.volume > 0.1 ? 'var(--success-green)' : 'var(--gray-50)',
                                                            color: month.volume > 0.1 ? 'white' : 'var(--gray-800)',
                                                            borderRadius: '8px',
                                                            fontSize: '0.875rem'
                                                        }}>
                                                            <div style={{ fontWeight: '600' }}>{month.month}</div>
                                                            <div>{Math.round(month.volume * 100)}%</div>
                                                        </div>
                                                    ))}
                                                </div>
                                                <div style={{ marginTop: '16px', fontSize: '0.875rem', color: 'var(--gray-600)' }}>
                                                    <strong>Peak Seasons:</strong> September (13%), June (11%), October (10%)
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* Emerging Opportunities */}
                            {marketView === 'emerging' && (
                                <div className="card">
                                    <div className="card-header">
                                        <h4 className="card-title">Emerging Market Opportunities</h4>
                                    </div>
                                    <div className="card-content">
                                        <div style={{ display: 'grid', gap: '20px' }}>
                                            {advancedMarketData.emergingOpportunities.map(sector => (
                                                <div key={sector.sector} style={{
                                                    padding: '20px',
                                                    border: `2px solid ${sector.riskLevel === 'low' ? 'var(--success-green)' : 'var(--warning-orange)'}`,
                                                    borderRadius: '12px',
                                                    backgroundColor: sector.riskLevel === 'low' ? 'rgba(16, 185, 129, 0.05)' : 'rgba(245, 158, 11, 0.05)'
                                                }}>
                                                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '16px' }}>
                                                        <div>
                                                            <h5 style={{ fontSize: '1.125rem', fontWeight: '600', margin: '0 0 4px 0' }}>
                                                                {sector.sector}
                                                            </h5>
                                                            <div style={{ fontSize: '0.875rem', color: 'var(--gray-600)' }}>
                                                                Market Maturity: {sector.maturity}
                                                            </div>
                                                        </div>
                                                        <div style={{ textAlign: 'right' }}>
                                                            <div style={{ 
                                                                fontSize: '1.5rem', 
                                                                fontWeight: '700',
                                                                color: 'var(--primary-blue)'
                                                            }}>
                                                                +{Math.round(sector.growthRate * 100)}%
                                                            </div>
                                                            <div style={{ fontSize: '0.75rem', color: 'var(--gray-600)' }}>
                                                                Growth Rate
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr 1fr', gap: '16px', marginBottom: '16px' }}>
                                                        <div>
                                                            <div style={{ fontSize: '0.875rem', color: 'var(--gray-600)' }}>Market Size</div>
                                                            <div style={{ fontSize: '1.125rem', fontWeight: '600' }}>
                                                                {formatCurrency(sector.marketSize)}
                                                            </div>
                                                        </div>
                                                        <div>
                                                            <div style={{ fontSize: '0.875rem', color: 'var(--gray-600)' }}>Time to Market</div>
                                                            <div style={{ fontSize: '1.125rem', fontWeight: '600' }}>
                                                                {sector.timeToMarket} months
                                                            </div>
                                                        </div>
                                                        <div>
                                                            <div style={{ fontSize: '0.875rem', color: 'var(--gray-600)' }}>Risk Level</div>
                                                            <div style={{ 
                                                                fontSize: '1.125rem', 
                                                                fontWeight: '600',
                                                                color: sector.riskLevel === 'low' ? 'var(--success-green)' : 'var(--warning-orange)'
                                                            }}>
                                                                {sector.riskLevel.toUpperCase()}
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div>
                                                        <div style={{ fontSize: '0.875rem', fontWeight: '500', marginBottom: '8px' }}>
                                                            Key Agencies:
                                                        </div>
                                                        <div style={{ display: 'flex', gap: '8px', flexWrap: 'wrap' }}>
                                                            {sector.keyAgencies.map(agency => (
                                                                <span key={agency} style={{
                                                                    padding: '4px 12px',
                                                                    backgroundColor: 'var(--primary-blue)',
                                                                    color: 'white',
                                                                    borderRadius: '16px',
                                                                    fontSize: '0.75rem',
                                                                    fontWeight: '500'
                                                                }}>
                                                                    {agency}
                                                                </span>
                                                            ))}
                                                        </div>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* Market Structure Analysis */}
                            {marketView === 'concentration' && (
                                <div style={{ display: 'grid', gap: '24px' }}>
                                    <div className="kpi-grid">
                                        <KPICard
                                            title="Market Concentration (HHI)"
                                            value={`${Math.round(advancedMarketData.marketConcentration.herfindahlIndex * 100)}/100`}
                                            change={advancedMarketData.marketConcentration.concentrationTrend * 100}
                                            icon="fas fa-sitemap"
                                            iconColor="var(--primary-blue)"
                                        />
                                        <KPICard
                                            title="Top 10 Share"
                                            value={`${Math.round(advancedMarketData.marketConcentration.top10Share * 100)}%`}
                                            change={-2}
                                            icon="fas fa-chart-pie"
                                            iconColor="var(--warning-orange)"
                                        />
                                        <KPICard
                                            title="Top 50 Share"
                                            value={`${Math.round(advancedMarketData.marketConcentration.top50Share * 100)}%`}
                                            change={-1}
                                            icon="fas fa-layer-group"
                                            iconColor="var(--success-green)"
                                        />
                                        <KPICard
                                            title="Small Business Share"
                                            value={`${Math.round(advancedMarketData.marketConcentration.smallBusinessShare * 100)}%`}
                                            change={3}
                                            icon="fas fa-store"
                                            iconColor="var(--danger-red)"
                                        />
                                    </div>

                                    <div className="card">
                                        <div className="card-header">
                                            <h4 className="card-title">Market Structure Insights</h4>
                                        </div>
                                        <div className="card-content">
                                            <div style={{ display: 'grid', gap: '16px' }}>
                                                <div style={{ 
                                                    padding: '16px',
                                                    backgroundColor: 'var(--success-green)',
                                                    color: 'white',
                                                    borderRadius: '8px'
                                                }}>
                                                    <div style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '8px' }}>
                                                        <i className="fas fa-check-circle"></i>
                                                        <strong>Competitive Market</strong>
                                                    </div>
                                                    <div style={{ fontSize: '0.875rem', opacity: 0.9 }}>
                                                        Low concentration (HHI: 12/100) indicates a competitive marketplace with opportunities for new entrants.
                                                    </div>
                                                </div>

                                                <div style={{ 
                                                    padding: '16px',
                                                    backgroundColor: 'var(--primary-blue)',
                                                    color: 'white',
                                                    borderRadius: '8px'
                                                }}>
                                                    <div style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '8px' }}>
                                                        <i className="fas fa-arrow-up"></i>
                                                        <strong>Growing Small Business Participation</strong>
                                                    </div>
                                                    <div style={{ fontSize: '0.875rem', opacity: 0.9 }}>
                                                        Small business share increased 3% YoY, reaching 26.7% of total market value.
                                                    </div>
                                                </div>

                                                <div style={{ 
                                                    padding: '16px',
                                                    backgroundColor: 'var(--warning-orange)',
                                                    color: 'white',
                                                    borderRadius: '8px'
                                                }}>
                                                    <div style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '8px' }}>
                                                        <i className="fas fa-balance-scale"></i>
                                                        <strong>Market Deconcentration Trend</strong>
                                                    </div>
                                                    <div style={{ fontSize: '0.875rem', opacity: 0.9 }}>
                                                        Top 10 companies control 23% of market (down 2%), showing increasing fragmentation.
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        // Win/Loss Analysis View
        const WinLossAnalysisView = () => (
            <div style={{ display: 'grid', gap: '24px' }}>
                {/* Performance Overview */}
                <div className="kpi-grid">
                    <KPICard
                        title="Your Win Rate"
                        value={`${Math.round(marketIntelligence.winLossAnalysis.yourCompany.winRate * 100)}%`}
                        change={Math.round((marketIntelligence.winLossAnalysis.yourCompany.winRate - marketIntelligence.winLossAnalysis.industryBenchmarks.averageWinRate) * 100)}
                        icon="fas fa-trophy"
                        iconColor="var(--success-green)"
                    />
                    <KPICard
                        title="Industry Average"
                        value={`${Math.round(marketIntelligence.winLossAnalysis.industryBenchmarks.averageWinRate * 100)}%`}
                        icon="fas fa-chart-bar"
                        iconColor="var(--gray-500)"
                    />
                    <KPICard
                        title="Top Performers"
                        value={`${Math.round(marketIntelligence.winLossAnalysis.industryBenchmarks.topPerformers * 100)}%`}
                        icon="fas fa-star"
                        iconColor="var(--warning-orange)"
                    />
                    <KPICard
                        title="Competitive Wins"
                        value={`${marketIntelligence.winLossAnalysis.yourCompany.competitiveWins}`}
                        change={12}
                        icon="fas fa-crosshairs"
                        iconColor="var(--primary-blue)"
                    />
                </div>

                {/* Win/Loss Breakdown */}
                <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '24px' }}>
                    <div className="card">
                        <div className="card-header">
                            <h3 className="card-title">Bid Performance</h3>
                        </div>
                        <div className="card-content">
                            <div style={{ display: 'grid', gap: '12px' }}>
                                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                                    <span>Total Bids</span>
                                    <span style={{ fontWeight: '600' }}>{marketIntelligence.winLossAnalysis.yourCompany.totalBids}</span>
                                </div>
                                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                                    <span style={{ color: 'var(--success-green)' }}>Wins</span>
                                    <span style={{ fontWeight: '600', color: 'var(--success-green)' }}>
                                        {marketIntelligence.winLossAnalysis.yourCompany.wins}
                                    </span>
                                </div>
                                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                                    <span style={{ color: 'var(--danger-red)' }}>Losses</span>
                                    <span style={{ fontWeight: '600', color: 'var(--danger-red)' }}>
                                        {marketIntelligence.winLossAnalysis.yourCompany.losses}
                                    </span>
                                </div>
                                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                                    <span style={{ color: 'var(--warning-orange)' }}>Pending</span>
                                    <span style={{ fontWeight: '600', color: 'var(--warning-orange)' }}>
                                        {marketIntelligence.winLossAnalysis.yourCompany.pending}
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div className="card">
                        <div className="card-header">
                            <h3 className="card-title">Top Loss Reasons</h3>
                        </div>
                        <div className="card-content">
                            <div style={{ display: 'grid', gap: '12px' }}>
                                {marketIntelligence.winLossAnalysis.lossAnalysis.map(reason => (
                                    <div key={reason.reason} style={{
                                        display: 'flex',
                                        justifyContent: 'space-between',
                                        alignItems: 'center',
                                        padding: '8px 0',
                                        borderBottom: '1px solid var(--gray-200)'
                                    }}>
                                        <div>
                                            <div style={{ fontWeight: '500' }}>{reason.reason}</div>
                                            <div style={{ 
                                                fontSize: '0.75rem', 
                                                color: reason.impact === 'high' ? 'var(--danger-red)' : 'var(--warning-orange)'
                                            }}>
                                                {reason.impact.toUpperCase()} IMPACT
                                            </div>
                                        </div>
                                        <div style={{ fontWeight: '600' }}>{reason.frequency}%</div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </div>
                </div>

                {/* Success Factors */}
                <div className="card">
                    <div className="card-header">
                        <h3 className="card-title">Your Top Success Factors</h3>
                    </div>
                    <div className="card-content">
                        <div style={{ display: 'flex', gap: '16px', flexWrap: 'wrap' }}>
                            {marketIntelligence.winLossAnalysis.yourCompany.topReasons.map(reason => (
                                <div key={reason} style={{
                                    padding: '8px 16px',
                                    backgroundColor: 'var(--success-green)',
                                    color: 'white',
                                    borderRadius: '20px',
                                    fontSize: '0.875rem',
                                    fontWeight: '500'
                                }}>
                                    {reason}
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            </div>
        );

        // Pricing Intelligence View
        const PricingIntelligenceView = () => (
            <div style={{ display: 'grid', gap: '24px' }}>
                {/* Service Rate Benchmarks */}
                <div className="card">
                    <div className="card-header">
                        <h3 className="card-title">Service Rate Benchmarks ($/hour)</h3>
                    </div>
                    <div className="card-content">
                        <div style={{ display: 'grid', gap: '16px' }}>
                            {Object.entries(marketIntelligence.pricingIntelligence.benchmarkData).map(([service, data]) => (
                                <div key={service} style={{
                                    display: 'flex',
                                    justifyContent: 'space-between',
                                    alignItems: 'center',
                                    padding: '16px',
                                    backgroundColor: 'var(--gray-50)',
                                    borderRadius: '8px'
                                }}>
                                    <div>
                                        <div style={{ fontWeight: '600' }}>{service}</div>
                                        <div style={{ fontSize: '0.875rem', color: 'var(--gray-600)' }}>
                                            Range: ${data.range[0]} - ${data.range[1]}
                                        </div>
                                    </div>
                                    <div style={{ textAlign: 'right' }}>
                                        <div style={{ fontSize: '1.25rem', fontWeight: '700', color: 'var(--primary-blue)' }}>
                                            ${data.avgRate}
                                        </div>
                                        <div style={{ fontSize: '0.75rem', color: 'var(--success-green)' }}>
                                            +{Math.round(data.premium * 100)}% premium
                                        </div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>

                {/* Competitor Pricing Strategies */}
                <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '24px' }}>
                    <div className="card">
                        <div className="card-header">
                            <h3 className="card-title">Competitor Pricing</h3>
                        </div>
                        <div className="card-content">
                            <div style={{ display: 'grid', gap: '12px' }}>
                                {Object.entries(marketIntelligence.pricingIntelligence.competitorPricing).map(([competitor, pricing]) => (
                                    <div key={competitor} style={{
                                        display: 'flex',
                                        justifyContent: 'space-between',
                                        alignItems: 'center',
                                        padding: '12px 0',
                                        borderBottom: '1px solid var(--gray-200)'
                                    }}>
                                        <div>
                                            <div style={{ fontWeight: '500' }}>{competitor}</div>
                                            <div style={{ fontSize: '0.75rem', color: 'var(--gray-600)' }}>
                                                {pricing.strategy}
                                            </div>
                                        </div>
                                        <div style={{ 
                                            fontSize: '0.875rem', 
                                            fontWeight: '600',
                                            color: pricing.premium > 0.4 ? 'var(--danger-red)' : 'var(--warning-orange)'
                                        }}>
                                            +{Math.round(pricing.premium * 100)}%
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </div>

                    <div className="card">
                        <div className="card-header">
                            <h3 className="card-title">Contract Types & Margins</h3>
                        </div>
                        <div className="card-content">
                            <div style={{ display: 'grid', gap: '12px' }}>
                                {marketIntelligence.pricingIntelligence.pricingStrategies.map(strategy => (
                                    <div key={strategy.strategy} style={{
                                        display: 'flex',
                                        justifyContent: 'space-between',
                                        alignItems: 'center',
                                        padding: '12px 0',
                                        borderBottom: '1px solid var(--gray-200)'
                                    }}>
                                        <div>
                                            <div style={{ fontWeight: '500' }}>{strategy.strategy}</div>
                                            <div style={{ fontSize: '0.75rem', color: 'var(--gray-600)' }}>
                                                {strategy.frequency}% of contracts
                                            </div>
                                        </div>
                                        <div style={{ 
                                            fontSize: '0.875rem', 
                                            fontWeight: '600',
                                            color: 'var(--success-green)'
                                        }}>
                                            {Math.round(strategy.avgMargin * 100)}% margin
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        );

        // Teaming Partners View
        const TeamingPartnersView = () => (
            <div style={{ display: 'grid', gap: '24px' }}>
                <div className="card">
                    <div className="card-header">
                        <h3 className="card-title">Recommended Teaming Partners</h3>
                        <p style={{ color: 'var(--gray-600)', fontSize: '0.875rem', margin: 0 }}>
                            Based on complementary capabilities and past performance
                        </p>
                    </div>
                    <div className="card-content">
                        <div style={{ display: 'grid', gap: '20px' }}>
                            {marketIntelligence.teamingOpportunities.map(partner => (
                                <div key={partner.partner} style={{
                                    padding: '20px',
                                    border: `2px solid ${partner.compatibility > 0.8 ? 'var(--success-green)' : 'var(--gray-200)'}`,
                                    borderRadius: '12px',
                                    backgroundColor: partner.compatibility > 0.8 ? 'rgba(16, 185, 129, 0.05)' : 'white'
                                }}>
                                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '16px' }}>
                                        <div>
                                            <h4 style={{ fontSize: '1.125rem', fontWeight: '600', margin: '0 0 4px 0' }}>
                                                {partner.partner}
                                            </h4>
                                            <div style={{ fontSize: '0.875rem', color: 'var(--gray-600)' }}>
                                                Preferred Role: {partner.preferredRole}
                                            </div>
                                        </div>
                                        <div style={{ textAlign: 'right' }}>
                                            <div style={{ 
                                                fontSize: '1.5rem', 
                                                fontWeight: '700',
                                                color: partner.compatibility > 0.8 ? 'var(--success-green)' : 'var(--warning-orange)'
                                            }}>
                                                {Math.round(partner.compatibility * 100)}%
                                            </div>
                                            <div style={{ fontSize: '0.75rem', color: 'var(--gray-600)' }}>
                                                Compatibility
                                            </div>
                                        </div>
                                    </div>

                                    <div style={{ marginBottom: '16px' }}>
                                        <div style={{ fontSize: '0.875rem', fontWeight: '500', marginBottom: '8px' }}>
                                            Complementary Capabilities:
                                        </div>
                                        <div style={{ display: 'flex', gap: '8px', flexWrap: 'wrap' }}>
                                            {partner.complementaryCapabilities.map(capability => (
                                                <span key={capability} style={{
                                                    padding: '4px 12px',
                                                    backgroundColor: 'var(--primary-blue)',
                                                    color: 'white',
                                                    borderRadius: '16px',
                                                    fontSize: '0.75rem',
                                                    fontWeight: '500'
                                                }}>
                                                    {capability}
                                                </span>
                                            ))}
                                        </div>
                                    </div>

                                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                                        <div style={{ fontSize: '0.875rem', color: 'var(--gray-600)' }}>
                                            Past Collaborations: {partner.pastCollaborations}
                                            {partner.successRate && (
                                                <span style={{ color: 'var(--success-green)', marginLeft: '12px' }}>
                                                    Success Rate: {Math.round(partner.successRate * 100)}%
                                                </span>
                                            )}
                                        </div>
                                        <button className="btn btn-primary" style={{ fontSize: '0.875rem' }}>
                                            <i className="fas fa-handshake"></i> Connect
                                        </button>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            </div>
        );

        // Senior Analyst Market Analysis View
        const SeniorAnalystMarketView = () => {
            const [analysisView, setAnalysisView] = useState('performance');
            const [selectedNAICS, setSelectedNAICS] = useState('all');
            const [analysisTimeframe, setAnalysisTimeframe] = useState('fy2024');

            // Comprehensive market analysis data designed for senior analysts
            const seniorAnalystData = {
                contractPerformance: {
                    performanceMetrics: {
                        onTimeDelivery: 0.847,
                        budgetCompliance: 0.823,
                        qualityScore: 0.891,
                        customerSatisfaction: 0.876
                    },
                    trendAnalysis: {
                        valueGrowth: 0.067,
                        volumeGrowth: 0.043,
                        averageSizeGrowth: 0.023,
                        competitionIntensity: 0.34
                    }
                },
                naicsAnalysis: [
                    {
                        code: '541511',
                        title: 'Custom Computer Programming Services',
                        marketSize: 45600000000,
                        contracts: 23400,
                        avgValue: 1948000,
                        growth: 0.189,
                        competition: 'high',
                        smbShare: 0.34,
                        topPlayers: ['Booz Allen', 'CACI', 'SAIC'],
                        opportunities: 847,
                        forecastGrowth: 0.156
                    },
                    {
                        code: '541512',
                        title: 'Computer Systems Design Services', 
                        marketSize: 67800000000,
                        contracts: 18900,
                        avgValue: 3587000,
                        growth: 0.234,
                        competition: 'high',
                        smbShare: 0.21,
                        topPlayers: ['Accenture Federal', 'IBM', 'Deloitte'],
                        opportunities: 623,
                        forecastGrowth: 0.198
                    },
                    {
                        code: '541330',
                        title: 'Engineering Services',
                        marketSize: 89300000000,
                        contracts: 45600,
                        avgValue: 1958000,
                        growth: 0.098,
                        competition: 'medium',
                        smbShare: 0.28,
                        topPlayers: ['Jacobs', 'AECOM', 'Parsons'],
                        opportunities: 1234,
                        forecastGrowth: 0.087
                    },
                    {
                        code: '541690',
                        title: 'Other Scientific and Technical Consulting',
                        marketSize: 34500000000,
                        contracts: 28700,
                        avgValue: 1202000,
                        growth: 0.145,
                        competition: 'medium',
                        smbShare: 0.42,
                        topPlayers: ['Mitre', 'IDA', 'Rand Corporation'],
                        opportunities: 987,
                        forecastGrowth: 0.134
                    }
                ]
            };

            return (
                <div style={{ display: 'grid', gap: '24px' }}>
                    {/* Senior Analyst Header */}
                    <div className="card">
                        <div className="card-header">
                            <div>
                                <h3 className="card-title">
                                    <i className="fas fa-chart-area" style={{ marginRight: '8px', color: 'var(--primary-blue)' }}></i>
                                    Senior Market Analysis
                                </h3>
                                <p style={{ color: 'var(--gray-600)', fontSize: '0.875rem', margin: 0 }}>
                                    Executive-level market intelligence for strategic decision-making
                                </p>
                            </div>
                            <div style={{ display: 'flex', gap: '12px', alignItems: 'center' }}>
                                <select 
                                    value={analysisTimeframe} 
                                    onChange={(e) => setAnalysisTimeframe(e.target.value)}
                                    className="btn"
                                    style={{ border: '1px solid var(--gray-300)' }}
                                >
                                    <option value="fy2024">FY 2024</option>
                                    <option value="fy2023">FY 2023</option>
                                    <option value="3year">3-Year Trend</option>
                                </select>
                                <select 
                                    value={selectedNAICS} 
                                    onChange={(e) => setSelectedNAICS(e.target.value)}
                                    className="btn"
                                    style={{ border: '1px solid var(--gray-300)' }}
                                >
                                    <option value="all">All NAICS</option>
                                    <option value="541511">541511 - Programming</option>
                                    <option value="541512">541512 - Systems Design</option>
                                    <option value="541330">541330 - Engineering</option>
                                </select>
                                <button className="btn btn-primary">
                                    <i className="fas fa-download"></i> Export Analysis
                                </button>
                            </div>
                        </div>
                        <div className="card-content">
                            {/* Analysis Navigation Tabs */}
                            <div style={{
                                display: 'flex',
                                gap: '4px',
                                marginBottom: '24px',
                                padding: '4px',
                                borderRadius: '12px',
                                border: '1px solid var(--gray-200)'
                            }}>
                                {[
                                    { id: 'performance', label: 'Performance Analytics', icon: 'fas fa-chart-line' },
                                    { id: 'naics', label: 'NAICS Deep Dive', icon: 'fas fa-industry' },
                                    { id: 'forecasting', label: 'Spend Forecasting', icon: 'fas fa-chart-area' },
                                    { id: 'positioning', label: 'Competitive Matrix', icon: 'fas fa-crosshairs' },
                                    { id: 'pipeline', label: 'Pipeline Analytics', icon: 'fas fa-funnel-dollar' },
                                    { id: 'vehicles', label: 'Contract Vehicles', icon: 'fas fa-file-contract' },
                                    { id: 'pastperf', label: 'Past Performance', icon: 'fas fa-medal' }
                                ].map(tab => (
                                    <button
                                        key={tab.id}
                                        onClick={() => setAnalysisView(tab.id)}
                                        style={{
                                            flex: 1,
                                            padding: '8px 12px',
                                            border: 'none',
                                            background: analysisView === tab.id ? 'var(--primary-blue)' : 'transparent',
                                            color: analysisView === tab.id ? 'white' : 'var(--gray-600)',
                                            borderRadius: '8px',
                                            cursor: 'pointer',
                                            fontSize: '0.75rem',
                                            fontWeight: '500',
                                            transition: 'all 0.2s',
                                            display: 'flex',
                                            flexDirection: 'column',
                                            alignItems: 'center',
                                            gap: '4px'
                                        }}
                                    >
                                        <i className={tab.icon}></i>
                                        {tab.label}
                                    </button>
                                ))}
                            </div>

                            {/* Performance Analytics */}
                            {analysisView === 'performance' && (
                                <div style={{ display: 'grid', gap: '24px' }}>
                                    <div className="kpi-grid">
                                        <KPICard
                                            title="Market Performance Index"
                                            value={`${Math.round(seniorAnalystData.contractPerformance.performanceMetrics.onTimeDelivery * 100)}`}
                                            change={4.2}
                                            icon="fas fa-tachometer-alt"
                                            iconColor="var(--primary-blue)"
                                        />
                                        <KPICard
                                            title="Budget Compliance Rate"
                                            value={`${Math.round(seniorAnalystData.contractPerformance.performanceMetrics.budgetCompliance * 100)}%`}
                                            change={-2.1}
                                            icon="fas fa-balance-scale"
                                            iconColor="var(--warning-orange)"
                                        />
                                        <KPICard
                                            title="Quality Score"
                                            value={`${Math.round(seniorAnalystData.contractPerformance.performanceMetrics.qualityScore * 100)}%`}
                                            change={3.7}
                                            icon="fas fa-star"
                                            iconColor="var(--success-green)"
                                        />
                                        <KPICard
                                            title="Customer Satisfaction"
                                            value={`${Math.round(seniorAnalystData.contractPerformance.performanceMetrics.customerSatisfaction * 100)}%`}
                                            change={1.8}
                                            icon="fas fa-thumbs-up"
                                            iconColor="var(--success-green)"
                                        />
                                    </div>

                                    <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '24px' }}>
                                        <div className="card">
                                            <div className="card-header">
                                                <h4 className="card-title">Market Trend Analysis</h4>
                                            </div>
                                            <div className="card-content">
                                                <div style={{ display: 'grid', gap: '16px' }}>
                                                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                                                        <span>Market Value Growth</span>
                                                        <span style={{ 
                                                            fontSize: '1.25rem', 
                                                            fontWeight: '700',
                                                            color: 'var(--success-green)'
                                                        }}>
                                                            +{Math.round(seniorAnalystData.contractPerformance.trendAnalysis.valueGrowth * 100)}%
                                                        </span>
                                                    </div>
                                                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                                                        <span>Contract Volume Growth</span>
                                                        <span style={{ 
                                                            fontSize: '1.25rem', 
                                                            fontWeight: '700',
                                                            color: 'var(--success-green)'
                                                        }}>
                                                            +{Math.round(seniorAnalystData.contractPerformance.trendAnalysis.volumeGrowth * 100)}%
                                                        </span>
                                                    </div>
                                                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                                                        <span>Avg Contract Size Growth</span>
                                                        <span style={{ 
                                                            fontSize: '1.25rem', 
                                                            fontWeight: '700',
                                                            color: 'var(--primary-blue)'
                                                        }}>
                                                            +{Math.round(seniorAnalystData.contractPerformance.trendAnalysis.averageSizeGrowth * 100)}%
                                                        </span>
                                                    </div>
                                                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                                                        <span>Competition Intensity</span>
                                                        <span style={{ 
                                                            fontSize: '1.25rem', 
                                                            fontWeight: '700',
                                                            color: 'var(--danger-red)'
                                                        }}>
                                                            {Math.round(seniorAnalystData.contractPerformance.trendAnalysis.competitionIntensity * 100)}%
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div className="card">
                                            <div className="card-header">
                                                <h4 className="card-title">Strategic Executive Insights</h4>
                                            </div>
                                            <div className="card-content">
                                                <div style={{ display: 'grid', gap: '12px' }}>
                                                    <div style={{ 
                                                        padding: '12px',
                                                        backgroundColor: 'var(--success-green)',
                                                        color: 'white',
                                                        borderRadius: '8px',
                                                        fontSize: '0.875rem'
                                                    }}>
                                                        <div style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '4px' }}>
                                                            <i className="fas fa-arrow-up"></i>
                                                            <strong>Market Expansion</strong>
                                                        </div>
                                                        6.7% value growth indicates robust market expansion driven by digital transformation initiatives.
                                                    </div>
                                                    <div style={{ 
                                                        padding: '12px',
                                                        backgroundColor: 'var(--warning-orange)',
                                                        color: 'white',
                                                        borderRadius: '8px',
                                                        fontSize: '0.875rem'
                                                    }}>
                                                        <div style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '4px' }}>
                                                            <i className="fas fa-exclamation-triangle"></i>
                                                            <strong>Competition Alert</strong>
                                                        </div>
                                                        34% competition intensity requires strategic differentiation for successful market entry.
                                                    </div>
                                                    <div style={{ 
                                                        padding: '12px',
                                                        backgroundColor: 'var(--primary-blue)',
                                                        color: 'white',
                                                        borderRadius: '8px',
                                                        fontSize: '0.875rem'
                                                    }}>
                                                        <div style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '4px' }}>
                                                            <i className="fas fa-lightbulb"></i>
                                                            <strong>Quality Opportunity</strong>
                                                        </div>
                                                        89% quality scores present premium positioning opportunities for value-based differentiation.
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* NAICS Deep Dive */}
                            {analysisView === 'naics' && (
                                <div className="card">
                                    <div className="card-header">
                                        <h4 className="card-title">NAICS Market Penetration Analysis</h4>
                                        <p style={{ color: 'var(--gray-600)', fontSize: '0.875rem', margin: 0 }}>
                                            Strategic market analysis by NAICS code with competitive positioning
                                        </p>
                                    </div>
                                    <div className="card-content">
                                        <div style={{ display: 'grid', gap: '20px' }}>
                                            {seniorAnalystData.naicsAnalysis.map(naics => (
                                                <div key={naics.code} style={{
                                                    padding: '20px',
                                                    border: `2px solid ${naics.growth > 0.15 ? 'var(--success-green)' : 'var(--gray-200)'}`,
                                                    borderRadius: '12px',
                                                    backgroundColor: naics.growth > 0.15 ? 'rgba(16, 185, 129, 0.05)' : 'white'
                                                }}>
                                                    <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr 1fr 1fr 1fr', gap: '16px', alignItems: 'center', marginBottom: '16px' }}>
                                                        <div>
                                                            <div style={{ fontWeight: '600', fontSize: '1rem', marginBottom: '4px' }}>
                                                                {naics.code} - {naics.title}
                                                            </div>
                                                            <div style={{ fontSize: '0.875rem', color: 'var(--gray-600)' }}>
                                                                {naics.contracts.toLocaleString()} contracts • {naics.opportunities} opportunities
                                                            </div>
                                                        </div>
                                                        <div style={{ textAlign: 'center' }}>
                                                            <div style={{ fontSize: '1rem', fontWeight: '600' }}>
                                                                {formatCurrency(naics.marketSize)}
                                                            </div>
                                                            <div style={{ fontSize: '0.75rem', color: 'var(--gray-600)' }}>Market Size</div>
                                                        </div>
                                                        <div style={{ textAlign: 'center' }}>
                                                            <div style={{ 
                                                                fontSize: '1rem', 
                                                                fontWeight: '600',
                                                                color: naics.growth > 0.15 ? 'var(--success-green)' : 'var(--warning-orange)'
                                                            }}>
                                                                +{Math.round(naics.growth * 100)}%
                                                            </div>
                                                            <div style={{ fontSize: '0.75rem', color: 'var(--gray-600)' }}>YoY Growth</div>
                                                        </div>
                                                        <div style={{ textAlign: 'center' }}>
                                                            <div style={{ fontSize: '1rem', fontWeight: '600' }}>
                                                                {formatCurrency(naics.avgValue)}
                                                            </div>
                                                            <div style={{ fontSize: '0.75rem', color: 'var(--gray-600)' }}>Avg Value</div>
                                                        </div>
                                                        <div style={{ textAlign: 'center' }}>
                                                            <div style={{ 
                                                                fontSize: '1rem', 
                                                                fontWeight: '600',
                                                                color: naics.smbShare > 0.3 ? 'var(--success-green)' : 'var(--danger-red)'
                                                            }}>
                                                                {Math.round(naics.smbShare * 100)}%
                                                            </div>
                                                            <div style={{ fontSize: '0.75rem', color: 'var(--gray-600)' }}>SMB Share</div>
                                                        </div>
                                                        <div style={{ textAlign: 'center' }}>
                                                            <div style={{ 
                                                                fontSize: '0.875rem', 
                                                                color: 'white',
                                                                backgroundColor: naics.competition === 'high' ? 'var(--danger-red)' : 'var(--warning-orange)',
                                                                padding: '4px 8px',
                                                                borderRadius: '12px'
                                                            }}>
                                                                {naics.competition.toUpperCase()}
                                                            </div>
                                                            <div style={{ fontSize: '0.75rem', color: 'var(--gray-600)', marginTop: '4px' }}>Competition</div>
                                                        </div>
                                                    </div>

                                                    <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px' }}>
                                                        <div>
                                                            <div style={{ fontSize: '0.875rem', fontWeight: '500', marginBottom: '8px' }}>
                                                                Market Leaders:
                                                            </div>
                                                            <div style={{ display: 'flex', gap: '8px', flexWrap: 'wrap' }}>
                                                                {naics.topPlayers.map(player => (
                                                                    <span key={player} style={{
                                                                        padding: '4px 10px',
                                                                        backgroundColor: 'var(--gray-100)',
                                                                        color: 'var(--gray-700)',
                                                                        borderRadius: '12px',
                                                                        fontSize: '0.75rem',
                                                                        fontWeight: '500'
                                                                    }}>
                                                                        {player}
                                                                    </span>
                                                                ))}
                                                            </div>
                                                        </div>
                                                        <div style={{ textAlign: 'right' }}>
                                                            <div style={{ fontSize: '0.875rem', color: 'var(--gray-600)' }}>3-Year CAGR Forecast</div>
                                                            <div style={{ 
                                                                fontSize: '1.125rem', 
                                                                fontWeight: '600',
                                                                color: naics.forecastGrowth > 0.12 ? 'var(--success-green)' : 'var(--primary-blue)'
                                                            }}>
                                                                +{Math.round(naics.forecastGrowth * 100)}%
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* Placeholder for additional analysis views */}
                            {(analysisView === 'forecasting' || analysisView === 'positioning' || 
                              analysisView === 'pipeline' || analysisView === 'vehicles' || 
                              analysisView === 'pastperf') && (
                                <div className="card">
                                    <div className="card-content">
                                        <div className="empty-state">
                                            <i className="fas fa-chart-line" style={{ fontSize: '3rem', color: 'var(--primary-blue)', marginBottom: '16px' }}></i>
                                            <h3>{analysisView === 'forecasting' ? 'Advanced Spend Forecasting Models' : 
                                                 analysisView === 'positioning' ? 'Competitive Positioning Matrix' :
                                                 analysisView === 'pipeline' ? 'Pipeline Analytics Dashboard' :
                                                 analysisView === 'vehicles' ? 'Contract Vehicle Intelligence' :
                                                 'Past Performance Correlation Engine'}</h3>
                                            <p style={{ color: 'var(--gray-600)', marginBottom: '16px' }}>
                                                Advanced {analysisView} analytics designed specifically for senior market analysts at government contracting firms.
                                            </p>
                                            <button className="btn btn-primary">
                                                <i className="fas fa-rocket"></i> Request Priority Development
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        // Policy & Regulatory Intelligence View
        const PolicyRegulatoryIntelligenceView = () => {
            const [policyView, setPolicyView] = useState('overview');
            const [selectedCongress, setSelectedCongress] = useState('118th');
            const [policyTimeframe, setPolicyTimeframe] = useState('current');
            const [policyIntelligenceData, setPolicyIntelligenceData] = useState(null);
            const [loading, setLoading] = useState(true);

            // Load real policy and regulatory intelligence data
            useEffect(() => {
                const loadPolicyData = async () => {
                    try {
                        setLoading(true);
                        const [congressionalData, regulatoryData, comprehensiveData] = await Promise.all([
                            api.fetchCongressionalIntelligence(),
                            api.fetchRegulatoryIntelligence(),
                            api.fetchDashboardMetrics()
                        ]);

                        // Transform real data into policy intelligence format
                        const transformedData = {
                            congressionalOverview: {
                                currentCongress: '118th',
                                activeBills: congressionalData.summary?.total_contractor_bills || 234,
                                contractorRelevantBills: congressionalData.summary?.total_contractor_bills || 47,
                                passedLegislation: Math.floor((congressionalData.summary?.total_contractor_bills || 47) * 0.25),
                                budgetStatus: 'continuing_resolution',
                                nextKeyDates: {
                                    appropriationsDeadline: '2024-03-08',
                                    defenseAuthDeadline: '2024-04-15',
                                    procurementReformHearing: '2024-02-28'
                                }
                            },
                            budgetImpactAnalysis: {
                                fy2024: {
                                    totalDiscretionary: 1700000000000,
                                    defenseSpending: 886000000000,
                                    nonDefenseSpending: 814000000000,
                                    contractingImpact: 0.678,
                                    changePriorYear: -0.023,
                                    riskFactors: ['Continuing Resolution', 'Debt Ceiling', 'Sequestration']
                                },
                                proposedChanges: [
                                    {
                                        program: 'Cybersecurity Infrastructure',
                                        currentBudget: 12400000000,
                                        proposedChange: 0.18,
                                        likelihood: 'high',
                                        contractorImpact: 'positive',
                                        timeline: 'FY2025'
                                    },
                                    {
                                        program: 'AI/ML Research Programs',
                                        currentBudget: 3200000000,
                                        proposedChange: 0.34,
                                        likelihood: 'medium',
                                        contractorImpact: 'positive',
                                        timeline: 'FY2025'
                                    }
                                ]
                            },
                            regulatoryChanges: regulatoryData.recent_regulations?.slice(0, 3).map(reg => ({
                                regulation: reg.title || 'Regulatory Update',
                                agency: reg.agency_names?.[0] || 'Federal Agency',
                                status: reg.publication_date ? 'Published' : 'Proposed Rule',
                                effectiveDate: reg.publication_date || '2024-03-15',
                                impact: reg.contractor_relevance_score > 0.7 ? 'high' : 'medium',
                                contractorRequirements: [
                                    'Compliance Assessment Required',
                                    'Documentation Updates',
                                    'Process Review'
                                ],
                                estimatedCost: Math.floor(reg.contractor_relevance_score * 100000),
                                affectedNAICS: ['541511', '541512', '541330'],
                                complianceDeadline: reg.effective_date || '2024-09-15'
                            })) || [
                                {
                                    regulation: 'FAR Case 2023-006: Cybersecurity Requirements',
                                    agency: 'GSA',
                                    status: 'Final Rule',
                                    effectiveDate: '2024-03-15',
                                    impact: 'high',
                                    contractorRequirements: [
                                        'CMMC Level 2 Certification',
                                        'Supply Chain Risk Management',
                                        'Incident Response Procedures'
                                    ],
                                    estimatedCost: 125000,
                                    affectedNAICS: ['541511', '541512', '541330'],
                                    complianceDeadline: '2024-09-15'
                                }
                            ],
                            policyAlerts: [
                                {
                                    type: 'congressional',
                                    priority: 'high',
                                    title: 'Defense Authorization Bill Markup',
                                    description: 'Critical provisions affecting contractor certification requirements',
                                    deadline: '2024-03-15',
                                    actionItems: ['Review certification requirements', 'Prepare compliance documentation']
                                },
                                {
                                    type: 'regulatory',
                                    priority: 'medium',
                                    title: 'New Cybersecurity Standards',
                                    description: 'Updated CMMC requirements for DOD contractors',
                                    deadline: '2024-06-01',
                                    actionItems: ['Assess current security posture', 'Plan certification timeline']
                                }
                            ],
                            complianceRequirements: {
                                immediate: [
                                    {
                                        requirement: 'CMMC 2.0 Readiness Assessment',
                                        deadline: '2024-03-01',
                                        status: 'overdue',
                                        criticality: 'high',
                                        estimatedCost: 25000,
                                        resources: ['Security Assessment', 'Gap Analysis', 'Remediation Plan']
                                    }
                                ],
                                upcoming: [
                                    {
                                        requirement: 'Supply Chain Risk Assessment',
                                        deadline: '2024-06-15',
                                        status: 'pending',
                                        criticality: 'medium',
                                        estimatedCost: 15000,
                                        resources: ['Vendor Screening', 'Risk Documentation', 'Mitigation Strategy']
                                    }
                                ]
                            },
                            legislativeCalendar: [
                                {
                                    date: '2024-03-08',
                                    event: 'Government Funding Deadline',
                                    type: 'appropriations',
                                    relevance: 'critical',
                                    description: 'Government funding deadline - potential for continuing resolution'
                                },
                                {
                                    date: '2024-03-12',
                                    event: 'Senate Defense Appropriations Markup',
                                    type: 'markup',
                                    relevance: 'high',
                                    description: 'Defense spending priorities and contractor funding decisions'
                                },
                                {
                                    date: '2024-04-15',
                                    event: 'NDAA Markup Period Begins',
                                    type: 'legislative',
                                    relevance: 'high',
                                    description: 'National Defense Authorization Act development'
                                }
                            ]
                        };

                        setPolicyIntelligenceData(transformedData);
                    } catch (error) {
                        console.error('Error loading policy data:', error);
                        // Fallback to basic structure
                        setPolicyIntelligenceData({
                            congressionalOverview: {
                                currentCongress: '118th',
                                activeBills: 0,
                                contractorRelevantBills: 0,
                                passedLegislation: 0,
                                budgetStatus: 'unknown',
                                nextKeyDates: {}
                            },
                            budgetImpactAnalysis: { fy2024: {}, proposedChanges: [] },
                            regulatoryChanges: [],
                            policyAlerts: [],
                            complianceRequirements: { immediate: [], upcoming: [] },
                            legislativeCalendar: []
                        });
                    } finally {
                        setLoading(false);
                    }
                };

                loadPolicyData();
            }, []);

            if (loading) {
                return (
                    <div className="loading-container" style={{ 
                        display: 'flex', 
                        justifyContent: 'center', 
                        alignItems: 'center', 
                        height: '400px',
                        fontSize: '1.1rem',
                        color: 'var(--gray-600)'
                    }}>
                        <i className="fas fa-spinner fa-spin" style={{ marginRight: '12px' }}></i>
                        Loading Policy & Regulatory Intelligence...
                    </div>
                );
            }

            if (!policyIntelligenceData) {
                return (
                    <div className="error-container" style={{ 
                        display: 'flex', 
                        justifyContent: 'center', 
                        alignItems: 'center', 
                        height: '400px',
                        fontSize: '1.1rem',
                        color: 'var(--danger-red)'
                    }}>
                        <i className="fas fa-exclamation-triangle" style={{ marginRight: '12px' }}></i>
                        Failed to load policy intelligence data
                    </div>
                );
            }

            // Use the loaded data (policyIntelligenceData is now dynamic)

            return (
                <div style={{ display: 'grid', gap: '24px' }}>
                    {/* Policy Intelligence Header */}
                    <div className="card">
                        <div className="card-header">
                            <div>
                                <h3 className="card-title">
                                    <i className="fas fa-balance-scale" style={{ marginRight: '8px', color: 'var(--primary-blue)' }}></i>
                                    Policy & Regulatory Intelligence
                                </h3>
                                <p style={{ color: 'var(--gray-600)', fontSize: '0.875rem', margin: 0 }}>
                                    Congressional policy tracking and regulatory compliance intelligence
                                </p>
                            </div>
                            <div style={{ display: 'flex', gap: '12px', alignItems: 'center' }}>
                                <select 
                                    value={selectedCongress} 
                                    onChange={(e) => setSelectedCongress(e.target.value)}
                                    className="btn"
                                    style={{ border: '1px solid var(--gray-300)' }}
                                >
                                    <option value="118th">118th Congress</option>
                                    <option value="117th">117th Congress</option>
                                </select>
                                <select 
                                    value={policyTimeframe} 
                                    onChange={(e) => setPolicyTimeframe(e.target.value)}
                                    className="btn"
                                    style={{ border: '1px solid var(--gray-300)' }}
                                >
                                    <option value="current">Current Session</option>
                                    <option value="upcoming">Upcoming</option>
                                    <option value="historical">Historical</option>
                                </select>
                                <button className="btn btn-primary">
                                    <i className="fas fa-bell"></i> Set Alert
                                </button>
                            </div>
                        </div>
                        <div className="card-content">
                            {/* Policy Navigation Tabs */}
                            <div style={{
                                display: 'flex',
                                gap: '4px',
                                marginBottom: '24px',
                                padding: '4px',
                                borderRadius: '12px',
                                border: '1px solid var(--gray-200)'
                            }}>
                                {[
                                    { id: 'overview', label: 'Congressional Overview', icon: 'fas fa-capitol-building' },
                                    { id: 'budget', label: 'Budget Impact', icon: 'fas fa-money-bill-wave' },
                                    { id: 'regulatory', label: 'Regulatory Changes', icon: 'fas fa-gavel' },
                                    { id: 'alerts', label: 'Policy Alerts', icon: 'fas fa-exclamation-triangle' },
                                    { id: 'compliance', label: 'Compliance Tracker', icon: 'fas fa-clipboard-check' },
                                    { id: 'calendar', label: 'Legislative Calendar', icon: 'fas fa-calendar-alt' },
                                    { id: 'correlation', label: 'Policy-Opportunity Engine', icon: 'fas fa-project-diagram' }
                                ].map(tab => (
                                    <button
                                        key={tab.id}
                                        onClick={() => setPolicyView(tab.id)}
                                        style={{
                                            flex: 1,
                                            padding: '8px 12px',
                                            border: 'none',
                                            background: policyView === tab.id ? 'var(--primary-blue)' : 'transparent',
                                            color: policyView === tab.id ? 'white' : 'var(--gray-600)',
                                            borderRadius: '8px',
                                            cursor: 'pointer',
                                            fontSize: '0.75rem',
                                            fontWeight: '500',
                                            transition: 'all 0.2s',
                                            display: 'flex',
                                            flexDirection: 'column',
                                            alignItems: 'center',
                                            gap: '4px'
                                        }}
                                    >
                                        <i className={tab.icon}></i>
                                        {tab.label}
                                    </button>
                                ))}
                            </div>

                            {/* Congressional Overview */}
                            {policyView === 'overview' && (
                                <div style={{ display: 'grid', gap: '24px' }}>
                                    <div className="kpi-grid">
                                        <KPICard
                                            title="Active Bills Tracking"
                                            value={policyIntelligenceData.congressionalOverview.activeBills}
                                            change={12}
                                            icon="fas fa-file-alt"
                                            iconColor="var(--primary-blue)"
                                        />
                                        <KPICard
                                            title="Contractor-Relevant Bills"
                                            value={policyIntelligenceData.congressionalOverview.contractorRelevantBills}
                                            change={8}
                                            icon="fas fa-balance-scale"
                                            iconColor="var(--warning-orange)"
                                        />
                                        <KPICard
                                            title="Passed This Session"
                                            value={policyIntelligenceData.congressionalOverview.passedLegislation}
                                            change={-3}
                                            icon="fas fa-check-circle"
                                            iconColor="var(--success-green)"
                                        />
                                        <KPICard
                                            title="Budget Status"
                                            value="Continuing Resolution"
                                            icon="fas fa-exclamation-triangle"
                                            iconColor="var(--danger-red)"
                                        />
                                    </div>

                                    <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '24px' }}>
                                        <div className="card">
                                            <div className="card-header">
                                                <h4 className="card-title">Critical Upcoming Dates</h4>
                                            </div>
                                            <div className="card-content">
                                                <div style={{ display: 'grid', gap: '16px' }}>
                                                    {Object.entries(policyIntelligenceData.congressionalOverview.nextKeyDates).map(([event, date]) => (
                                                        <div key={event} style={{
                                                            display: 'flex',
                                                            justifyContent: 'space-between',
                                                            alignItems: 'center',
                                                            padding: '12px',
                                                            backgroundColor: 'var(--gray-50)',
                                                            borderRadius: '8px'
                                                        }}>
                                                            <span style={{ fontWeight: '500', textTransform: 'capitalize' }}>
                                                                {event.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase())}
                                                            </span>
                                                            <span style={{ 
                                                                color: 'var(--primary-blue)', 
                                                                fontWeight: '600' 
                                                            }}>
                                                                {new Date(date).toLocaleDateString()}
                                                            </span>
                                                        </div>
                                                    ))}
                                                </div>
                                            </div>
                                        </div>

                                        <div className="card">
                                            <div className="card-header">
                                                <h4 className="card-title">Policy Impact Assessment</h4>
                                            </div>
                                            <div className="card-content">
                                                <div style={{ display: 'grid', gap: '12px' }}>
                                                    <div style={{ 
                                                        padding: '12px',
                                                        backgroundColor: 'var(--success-green)',
                                                        color: 'white',
                                                        borderRadius: '8px',
                                                        fontSize: '0.875rem'
                                                    }}>
                                                        <div style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '4px' }}>
                                                            <i className="fas fa-arrow-up"></i>
                                                            <strong>Cybersecurity Funding</strong>
                                                        </div>
                                                        +18% increase proposed for cybersecurity infrastructure programs affecting IT contractors.
                                                    </div>
                                                    <div style={{ 
                                                        padding: '12px',
                                                        backgroundColor: 'var(--warning-orange)',
                                                        color: 'white',
                                                        borderRadius: '8px',
                                                        fontSize: '0.875rem'
                                                    }}>
                                                        <div style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '4px' }}>
                                                            <i className="fas fa-exclamation-triangle"></i>
                                                            <strong>Regulatory Burden</strong>
                                                        </div>
                                                        New compliance requirements estimated to cost contractors $125K+ annually.
                                                    </div>
                                                    <div style={{ 
                                                        padding: '12px',
                                                        backgroundColor: 'var(--primary-blue)',
                                                        color: 'white',
                                                        borderRadius: '8px',
                                                        fontSize: '0.875rem'
                                                    }}>
                                                        <div style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '4px' }}>
                                                            <i className="fas fa-balance-scale"></i>
                                                            <strong>Small Business Focus</strong>
                                                        </div>
                                                        Congressional emphasis on increasing small business participation to 25%+.
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* Budget Impact Analysis */}
                            {policyView === 'budget' && (
                                <div style={{ display: 'grid', gap: '24px' }}>
                                    <div className="card">
                                        <div className="card-header">
                                            <h4 className="card-title">FY2024 Budget Impact Analysis</h4>
                                        </div>
                                        <div className="card-content">
                                            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '20px', marginBottom: '24px' }}>
                                                <div style={{ textAlign: 'center', padding: '20px', backgroundColor: 'var(--gray-50)', borderRadius: '12px' }}>
                                                    <div style={{ fontSize: '1.5rem', fontWeight: '700', color: 'var(--primary-blue)', marginBottom: '8px' }}>
                                                        {formatCurrency(policyIntelligenceData.budgetImpactAnalysis.fy2024.totalDiscretionary)}
                                                    </div>
                                                    <div style={{ fontSize: '0.875rem', color: 'var(--gray-600)' }}>Total Discretionary</div>
                                                </div>
                                                <div style={{ textAlign: 'center', padding: '20px', backgroundColor: 'var(--gray-50)', borderRadius: '12px' }}>
                                                    <div style={{ fontSize: '1.5rem', fontWeight: '700', color: 'var(--success-green)', marginBottom: '8px' }}>
                                                        {formatCurrency(policyIntelligenceData.budgetImpactAnalysis.fy2024.defenseSpending)}
                                                    </div>
                                                    <div style={{ fontSize: '0.875rem', color: 'var(--gray-600)' }}>Defense Spending</div>
                                                </div>
                                                <div style={{ textAlign: 'center', padding: '20px', backgroundColor: 'var(--gray-50)', borderRadius: '12px' }}>
                                                    <div style={{ fontSize: '1.5rem', fontWeight: '700', color: 'var(--warning-orange)', marginBottom: '8px' }}>
                                                        {Math.round(policyIntelligenceData.budgetImpactAnalysis.fy2024.contractingImpact * 100)}%
                                                    </div>
                                                    <div style={{ fontSize: '0.875rem', color: 'var(--gray-600)' }}>Goes to Contracts</div>
                                                </div>
                                            </div>

                                            <div>
                                                <h5 style={{ marginBottom: '16px' }}>Proposed Budget Changes (FY2025)</h5>
                                                <div style={{ display: 'grid', gap: '16px' }}>
                                                    {policyIntelligenceData.budgetImpactAnalysis.proposedChanges.map(change => (
                                                        <div key={change.program} style={{
                                                            padding: '16px',
                                                            border: `2px solid ${change.contractorImpact === 'positive' ? 'var(--success-green)' : 'var(--danger-red)'}`,
                                                            borderRadius: '8px',
                                                            backgroundColor: change.contractorImpact === 'positive' ? 'rgba(16, 185, 129, 0.05)' : 'rgba(239, 68, 68, 0.05)'
                                                        }}>
                                                            <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr 1fr', gap: '16px', alignItems: 'center' }}>
                                                                <div>
                                                                    <div style={{ fontWeight: '600', marginBottom: '4px' }}>{change.program}</div>
                                                                    <div style={{ fontSize: '0.875rem', color: 'var(--gray-600)' }}>
                                                                        Current: {formatCurrency(change.currentBudget)}
                                                                    </div>
                                                                </div>
                                                                <div style={{ textAlign: 'center' }}>
                                                                    <div style={{ 
                                                                        fontSize: '1.125rem', 
                                                                        fontWeight: '600',
                                                                        color: change.proposedChange > 0 ? 'var(--success-green)' : 'var(--danger-red)'
                                                                    }}>
                                                                        {change.proposedChange > 0 ? '+' : ''}{Math.round(change.proposedChange * 100)}%
                                                                    </div>
                                                                    <div style={{ fontSize: '0.75rem', color: 'var(--gray-600)' }}>Change</div>
                                                                </div>
                                                                <div style={{ textAlign: 'center' }}>
                                                                    <div style={{ 
                                                                        fontSize: '0.875rem', 
                                                                        color: 'white',
                                                                        backgroundColor: change.likelihood === 'high' ? 'var(--success-green)' : 'var(--warning-orange)',
                                                                        padding: '4px 8px',
                                                                        borderRadius: '12px'
                                                                    }}>
                                                                        {change.likelihood.toUpperCase()}
                                                                    </div>
                                                                    <div style={{ fontSize: '0.75rem', color: 'var(--gray-600)', marginTop: '4px' }}>Likelihood</div>
                                                                </div>
                                                                <div style={{ textAlign: 'center' }}>
                                                                    <div style={{ fontSize: '0.875rem', fontWeight: '600' }}>{change.timeline}</div>
                                                                    <div style={{ fontSize: '0.75rem', color: 'var(--gray-600)' }}>Timeline</div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    ))}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* Regulatory Changes */}
                            {policyView === 'regulatory' && (
                                <div className="card">
                                    <div className="card-header">
                                        <h4 className="card-title">Active Regulatory Changes</h4>
                                        <p style={{ color: 'var(--gray-600)', fontSize: '0.875rem', margin: 0 }}>
                                            Federal regulations affecting government contractors
                                        </p>
                                    </div>
                                    <div className="card-content">
                                        <div style={{ display: 'grid', gap: '20px' }}>
                                            {policyIntelligenceData.regulatoryChanges.map(reg => (
                                                <div key={reg.regulation} style={{
                                                    padding: '20px',
                                                    border: `2px solid ${reg.impact === 'high' ? 'var(--danger-red)' : 'var(--warning-orange)'}`,
                                                    borderRadius: '12px',
                                                    backgroundColor: reg.impact === 'high' ? 'rgba(239, 68, 68, 0.05)' : 'rgba(245, 158, 11, 0.05)'
                                                }}>
                                                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '16px' }}>
                                                        <div>
                                                            <h5 style={{ fontSize: '1.125rem', fontWeight: '600', margin: '0 0 4px 0' }}>
                                                                {reg.regulation}
                                                            </h5>
                                                            <div style={{ fontSize: '0.875rem', color: 'var(--gray-600)', marginBottom: '8px' }}>
                                                                {reg.agency} • {reg.status} • Effective: {new Date(reg.effectiveDate).toLocaleDateString()}
                                                            </div>
                                                        </div>
                                                        <div style={{ display: 'flex', gap: '8px' }}>
                                                            <div style={{ 
                                                                fontSize: '0.875rem', 
                                                                color: 'white',
                                                                backgroundColor: reg.impact === 'high' ? 'var(--danger-red)' : 'var(--warning-orange)',
                                                                padding: '4px 8px',
                                                                borderRadius: '12px'
                                                            }}>
                                                                {reg.impact.toUpperCase()} IMPACT
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px', marginBottom: '16px' }}>
                                                        <div>
                                                            <div style={{ fontSize: '0.875rem', fontWeight: '500', marginBottom: '8px' }}>
                                                                Compliance Requirements:
                                                            </div>
                                                            <ul style={{ fontSize: '0.875rem', color: 'var(--gray-600)', paddingLeft: '16px' }}>
                                                                {reg.contractorRequirements.map(req => (
                                                                    <li key={req} style={{ marginBottom: '4px' }}>{req}</li>
                                                                ))}
                                                            </ul>
                                                        </div>
                                                        <div>
                                                            <div style={{ display: 'grid', gap: '8px' }}>
                                                                <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                                    <span style={{ fontSize: '0.875rem' }}>Estimated Cost:</span>
                                                                    <span style={{ fontWeight: '600' }}>{formatCurrency(reg.estimatedCost)}</span>
                                                                </div>
                                                                <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                                    <span style={{ fontSize: '0.875rem' }}>Compliance Deadline:</span>
                                                                    <span style={{ fontWeight: '600', color: 'var(--danger-red)' }}>
                                                                        {new Date(reg.complianceDeadline).toLocaleDateString()}
                                                                    </span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div>
                                                        <div style={{ fontSize: '0.875rem', fontWeight: '500', marginBottom: '8px' }}>
                                                            Affected NAICS Codes:
                                                        </div>
                                                        <div style={{ display: 'flex', gap: '8px' }}>
                                                            {reg.affectedNAICS.map(naics => (
                                                                <span key={naics} style={{
                                                                    padding: '4px 10px',
                                                                    backgroundColor: 'var(--primary-blue)',
                                                                    color: 'white',
                                                                    borderRadius: '12px',
                                                                    fontSize: '0.75rem',
                                                                    fontWeight: '500'
                                                                }}>
                                                                    {naics}
                                                                </span>
                                                            ))}
                                                        </div>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* Policy Alerts */}
                            {policyView === 'alerts' && (
                                <div className="card">
                                    <div className="card-header">
                                        <h4 className="card-title">Active Policy Alerts</h4>
                                        <p style={{ color: 'var(--gray-600)', fontSize: '0.875rem', margin: 0 }}>
                                            Time-sensitive policy developments requiring attention
                                        </p>
                                    </div>
                                    <div className="card-content">
                                        <div style={{ display: 'grid', gap: '16px' }}>
                                            {policyIntelligenceData.policyAlerts.map((alert, index) => (
                                                <div key={index} style={{
                                                    padding: '16px',
                                                    border: `2px solid ${alert.priority === 'high' ? 'var(--danger-red)' : 'var(--warning-orange)'}`,
                                                    borderRadius: '8px',
                                                    backgroundColor: alert.priority === 'high' ? 'rgba(239, 68, 68, 0.05)' : 'rgba(245, 158, 11, 0.05)'
                                                }}>
                                                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '12px' }}>
                                                        <div>
                                                            <h6 style={{ fontWeight: '600', marginBottom: '4px' }}>{alert.title}</h6>
                                                            <div style={{ fontSize: '0.875rem', color: 'var(--gray-600)' }}>
                                                                {new Date(alert.date).toLocaleDateString()} • {alert.type.replace('_', ' ').toUpperCase()}
                                                            </div>
                                                        </div>
                                                        <div style={{ 
                                                            fontSize: '0.75rem', 
                                                            color: 'white',
                                                            backgroundColor: alert.priority === 'high' ? 'var(--danger-red)' : 'var(--warning-orange)',
                                                            padding: '4px 8px',
                                                            borderRadius: '12px'
                                                        }}>
                                                            {alert.priority.toUpperCase()}
                                                        </div>
                                                    </div>
                                                    <div style={{ fontSize: '0.875rem', marginBottom: '8px' }}>{alert.impact}</div>
                                                    <div style={{ fontSize: '0.875rem', fontWeight: '500', color: 'var(--primary-blue)' }}>
                                                        Action Required: {alert.actionRequired}
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* Compliance Tracker */}
                            {policyView === 'compliance' && (
                                <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '24px' }}>
                                    <div className="card">
                                        <div className="card-header">
                                            <h4 className="card-title">Immediate Action Required</h4>
                                        </div>
                                        <div className="card-content">
                                            <div style={{ display: 'grid', gap: '16px' }}>
                                                {policyIntelligenceData.complianceRequirements.immediate.map((req, index) => (
                                                    <div key={index} style={{
                                                        padding: '16px',
                                                        border: '2px solid var(--danger-red)',
                                                        borderRadius: '8px',
                                                        backgroundColor: 'rgba(239, 68, 68, 0.05)'
                                                    }}>
                                                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '8px' }}>
                                                            <h6 style={{ fontWeight: '600' }}>{req.requirement}</h6>
                                                            <div style={{ 
                                                                fontSize: '0.75rem', 
                                                                color: 'white',
                                                                backgroundColor: 'var(--danger-red)',
                                                                padding: '4px 8px',
                                                                borderRadius: '12px'
                                                            }}>
                                                                {req.priority.toUpperCase()}
                                                            </div>
                                                        </div>
                                                        <div style={{ fontSize: '0.875rem', color: 'var(--gray-600)', marginBottom: '8px' }}>
                                                            {req.description}
                                                        </div>
                                                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                                                            <span style={{ fontSize: '0.875rem', fontWeight: '600', color: 'var(--danger-red)' }}>
                                                                Due: {new Date(req.deadline).toLocaleDateString()}
                                                            </span>
                                                            <span style={{ fontSize: '0.875rem', fontWeight: '600' }}>
                                                                Cost: {formatCurrency(req.cost)}
                                                            </span>
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    </div>

                                    <div className="card">
                                        <div className="card-header">
                                            <h4 className="card-title">Upcoming Requirements</h4>
                                        </div>
                                        <div className="card-content">
                                            <div style={{ display: 'grid', gap: '16px' }}>
                                                {policyIntelligenceData.complianceRequirements.upcoming.map((req, index) => (
                                                    <div key={index} style={{
                                                        padding: '16px',
                                                        border: '2px solid var(--warning-orange)',
                                                        borderRadius: '8px',
                                                        backgroundColor: 'rgba(245, 158, 11, 0.05)'
                                                    }}>
                                                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '8px' }}>
                                                            <h6 style={{ fontWeight: '600' }}>{req.requirement}</h6>
                                                            <div style={{ 
                                                                fontSize: '0.75rem', 
                                                                color: 'white',
                                                                backgroundColor: req.priority === 'high' ? 'var(--danger-red)' : 'var(--warning-orange)',
                                                                padding: '4px 8px',
                                                                borderRadius: '12px'
                                                            }}>
                                                                {req.priority.toUpperCase()}
                                                            </div>
                                                        </div>
                                                        <div style={{ fontSize: '0.875rem', color: 'var(--gray-600)', marginBottom: '8px' }}>
                                                            {req.description}
                                                        </div>
                                                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                                                            <span style={{ fontSize: '0.875rem', fontWeight: '600' }}>
                                                                Due: {new Date(req.deadline).toLocaleDateString()}
                                                            </span>
                                                            <span style={{ fontSize: '0.875rem', fontWeight: '600' }}>
                                                                Cost: {formatCurrency(req.cost)}
                                                            </span>
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* Legislative Calendar */}
                            {policyView === 'calendar' && (
                                <div className="card">
                                    <div className="card-header">
                                        <h4 className="card-title">Legislative Calendar</h4>
                                        <p style={{ color: 'var(--gray-600)', fontSize: '0.875rem', margin: 0 }}>
                                            Key congressional events affecting government contractors
                                        </p>
                                    </div>
                                    <div className="card-content">
                                        <div style={{ display: 'grid', gap: '16px' }}>
                                            {policyIntelligenceData.legislativeCalendar.map((event, index) => (
                                                <div key={index} style={{
                                                    padding: '16px',
                                                    border: `2px solid ${event.relevance === 'critical' ? 'var(--danger-red)' : event.relevance === 'high' ? 'var(--warning-orange)' : 'var(--gray-200)'}`,
                                                    borderRadius: '8px',
                                                    backgroundColor: event.relevance === 'critical' ? 'rgba(239, 68, 68, 0.05)' : event.relevance === 'high' ? 'rgba(245, 158, 11, 0.05)' : 'white'
                                                }}>
                                                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '8px' }}>
                                                        <div>
                                                            <h6 style={{ fontWeight: '600', marginBottom: '4px' }}>{event.event}</h6>
                                                            <div style={{ fontSize: '0.875rem', color: 'var(--gray-600)' }}>
                                                                {new Date(event.date).toLocaleDateString()} • {event.type.toUpperCase()}
                                                            </div>
                                                        </div>
                                                        <div style={{ 
                                                            fontSize: '0.75rem', 
                                                            color: 'white',
                                                            backgroundColor: event.relevance === 'critical' ? 'var(--danger-red)' : event.relevance === 'high' ? 'var(--warning-orange)' : 'var(--gray-500)',
                                                            padding: '4px 8px',
                                                            borderRadius: '12px'
                                                        }}>
                                                            {event.relevance.toUpperCase()}
                                                        </div>
                                                    </div>
                                                    <div style={{ fontSize: '0.875rem' }}>{event.description}</div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* Policy-Opportunity Correlation Engine */}
                            {policyView === 'correlation' && (
                                <div style={{ display: 'grid', gap: '24px' }}>
                                    {/* Overview Section */}
                                    <div className="card">
                                        <div className="card-header">
                                            <div>
                                                <h4 className="card-title">
                                                    <i className="fas fa-project-diagram" style={{ color: 'var(--primary-blue)' }}></i>
                                                    Policy-Opportunity Correlation Engine
                                                </h4>
                                                <p style={{ color: 'var(--gray-600)', fontSize: '0.875rem', margin: 0 }}>
                                                    AI-powered analysis connecting policy changes to business opportunities
                                                </p>
                                            </div>
                                            <button className="btn btn-primary">
                                                <i className="fas fa-sync-alt"></i> Refresh Analysis
                                            </button>
                                        </div>
                                        <div className="card-content">
                                            <div className="kpi-grid">
                                                <KPICard
                                                    title="Active Policy Correlations"
                                                    value="23"
                                                    change={15}
                                                    icon="fas fa-link"
                                                    iconColor="var(--primary-blue)"
                                                />
                                                <KPICard
                                                    title="High-Impact Opportunities"
                                                    value="8"
                                                    change={3}
                                                    icon="fas fa-star"
                                                    iconColor="var(--warning-orange)"
                                                />
                                                <KPICard
                                                    title="Policy-Driven Value"
                                                    value="$47.2M"
                                                    change={28}
                                                    icon="fas fa-dollar-sign"
                                                    iconColor="var(--success-green)"
                                                />
                                                <KPICard
                                                    title="Correlation Confidence"
                                                    value="87%"
                                                    icon="fas fa-brain"
                                                    iconColor="var(--gray-600)"
                                                />
                                            </div>
                                        </div>
                                    </div>

                                    {/* Policy Impact Matrix */}
                                    <div className="card">
                                        <div className="card-header">
                                            <h4 className="card-title">Policy Impact Matrix</h4>
                                            <div style={{ display: 'flex', gap: '8px' }}>
                                                <button className="btn btn-sm">
                                                    <i className="fas fa-download"></i> Export
                                                </button>
                                                <button className="btn btn-sm">
                                                    <i className="fas fa-filter"></i> Filter
                                                </button>
                                            </div>
                                        </div>
                                        <div className="card-content">
                                            <div style={{ 
                                                display: 'grid', 
                                                gridTemplateColumns: 'repeat(auto-fit, minmax(350px, 1fr))', 
                                                gap: '16px' 
                                            }}>
                                                {[
                                                    {
                                                        policy: "NDAA 2024 Cybersecurity Provisions",
                                                        opportunities: 5,
                                                        totalValue: 28500000,
                                                        impact: "critical",
                                                        timeline: "Q2 2024",
                                                        correlatedOpps: [
                                                            "Advanced Cybersecurity Solutions for Defense Networks",
                                                            "Zero Trust Architecture Implementation",
                                                            "CMMC Compliance Assessment Services"
                                                        ]
                                                    },
                                                    {
                                                        policy: "AI in Government Initiative",
                                                        opportunities: 3,
                                                        totalValue: 15200000,
                                                        impact: "high",
                                                        timeline: "Q3 2024",
                                                        correlatedOpps: [
                                                            "Satellite Data Analysis and Processing Services",
                                                            "AI-Powered Fraud Detection System",
                                                            "Machine Learning Platform Development"
                                                        ]
                                                    },
                                                    {
                                                        policy: "Infrastructure Investment Act",
                                                        opportunities: 7,
                                                        totalValue: 42300000,
                                                        impact: "critical",
                                                        timeline: "Q1-Q4 2024",
                                                        correlatedOpps: [
                                                            "Smart Grid Modernization Program",
                                                            "Broadband Infrastructure Expansion",
                                                            "Transportation Analytics Platform"
                                                        ]
                                                    },
                                                    {
                                                        policy: "Small Business Innovation Research",
                                                        opportunities: 4,
                                                        totalValue: 8900000,
                                                        impact: "medium",
                                                        timeline: "Ongoing",
                                                        correlatedOpps: [
                                                            "Research and Development Services",
                                                            "Prototype Development Program",
                                                            "Innovation Lab Support Services"
                                                        ]
                                                    }
                                                ].map((correlation, index) => (
                                                    <div key={index} style={{
                                                        padding: '20px',
                                                        border: `2px solid ${correlation.impact === 'critical' ? 'var(--danger-red)' : correlation.impact === 'high' ? 'var(--warning-orange)' : 'var(--gray-300)'}`,
                                                        borderRadius: '12px',
                                                        backgroundColor: correlation.impact === 'critical' ? 'rgba(239, 68, 68, 0.05)' : correlation.impact === 'high' ? 'rgba(245, 158, 11, 0.05)' : 'white'
                                                    }}>
                                                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '12px' }}>
                                                            <div>
                                                                <h6 style={{ fontWeight: '600', marginBottom: '4px' }}>{correlation.policy}</h6>
                                                                <div style={{ fontSize: '0.875rem', color: 'var(--gray-600)' }}>
                                                                    {correlation.opportunities} opportunities • {formatCurrency(correlation.totalValue)}
                                                                </div>
                                                            </div>
                                                            <div style={{ 
                                                                fontSize: '0.75rem', 
                                                                color: 'white',
                                                                backgroundColor: correlation.impact === 'critical' ? 'var(--danger-red)' : correlation.impact === 'high' ? 'var(--warning-orange)' : 'var(--gray-500)',
                                                                padding: '4px 8px',
                                                                borderRadius: '12px'
                                                            }}>
                                                                {correlation.impact.toUpperCase()}
                                                            </div>
                                                        </div>
                                                        
                                                        <div style={{ 
                                                            fontSize: '0.75rem', 
                                                            color: 'var(--gray-600)', 
                                                            marginBottom: '12px',
                                                            display: 'flex',
                                                            alignItems: 'center',
                                                            gap: '4px'
                                                        }}>
                                                            <i className="fas fa-clock"></i>
                                                            Timeline: {correlation.timeline}
                                                        </div>

                                                        <div style={{ marginBottom: '12px' }}>
                                                            <div style={{ 
                                                                fontSize: '0.75rem', 
                                                                fontWeight: '600', 
                                                                color: 'var(--gray-700)',
                                                                marginBottom: '8px'
                                                            }}>
                                                                CORRELATED OPPORTUNITIES:
                                                            </div>
                                                            {correlation.correlatedOpps.map((opp, oppIndex) => (
                                                                <div key={oppIndex} style={{
                                                                    fontSize: '0.75rem',
                                                                    padding: '4px 8px',
                                                                    backgroundColor: 'var(--gray-100)',
                                                                    borderRadius: '6px',
                                                                    marginBottom: '4px',
                                                                    cursor: 'pointer',
                                                                    transition: 'background-color 0.2s'
                                                                }}>
                                                                    <i className="fas fa-link" style={{ marginRight: '6px', color: 'var(--primary-blue)' }}></i>
                                                                    {opp}
                                                                </div>
                                                            ))}
                                                        </div>

                                                        <div style={{ display: 'flex', gap: '8px', marginTop: '12px' }}>
                                                            <button className="btn btn-sm btn-primary" style={{ flex: 1 }}>
                                                                <i className="fas fa-eye"></i> View Details
                                                            </button>
                                                            <button className="btn btn-sm" style={{ flex: 1 }}>
                                                                <i className="fas fa-plus"></i> Track Policy
                                                            </button>
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    </div>

                                    {/* Predictive Correlation Insights */}
                                    <div className="card">
                                        <div className="card-header">
                                            <h4 className="card-title">
                                                <i className="fas fa-crystal-ball" style={{ color: 'var(--primary-blue)' }}></i>
                                                Predictive Correlation Insights
                                            </h4>
                                            <button className="btn btn-sm">
                                                <i className="fas fa-cog"></i> Configure AI
                                            </button>
                                        </div>
                                        <div className="card-content">
                                            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))', gap: '20px' }}>
                                                <div style={{ 
                                                    padding: '16px', 
                                                    backgroundColor: 'var(--gray-50)', 
                                                    borderRadius: '8px',
                                                    border: '1px solid var(--gray-200)'
                                                }}>
                                                    <h6 style={{ 
                                                        fontWeight: '600', 
                                                        marginBottom: '8px',
                                                        display: 'flex',
                                                        alignItems: 'center',
                                                        gap: '6px'
                                                    }}>
                                                        <i className="fas fa-trending-up" style={{ color: 'var(--success-green)' }}></i>
                                                        Emerging Opportunities
                                                    </h6>
                                                    <p style={{ fontSize: '0.875rem', color: 'var(--gray-600)', marginBottom: '12px' }}>
                                                        AI predicts 12 new opportunities will emerge from current policy discussions
                                                    </p>
                                                    <div style={{ fontSize: '0.75rem' }}>
                                                        <div>• Quantum Computing Initiative → $15M est. value</div>
                                                        <div>• Clean Energy Tax Credits → $22M est. value</div>
                                                        <div>• Digital Identity Standards → $8M est. value</div>
                                                    </div>
                                                </div>

                                                <div style={{ 
                                                    padding: '16px', 
                                                    backgroundColor: 'rgba(245, 158, 11, 0.05)', 
                                                    borderRadius: '8px',
                                                    border: '1px solid var(--warning-orange)'
                                                }}>
                                                    <h6 style={{ 
                                                        fontWeight: '600', 
                                                        marginBottom: '8px',
                                                        display: 'flex',
                                                        alignItems: 'center',
                                                        gap: '6px'
                                                    }}>
                                                        <i className="fas fa-exclamation-triangle" style={{ color: 'var(--warning-orange)' }}></i>
                                                        Policy Risk Alerts
                                                    </h6>
                                                    <p style={{ fontSize: '0.875rem', color: 'var(--gray-600)', marginBottom: '12px' }}>
                                                        3 tracked opportunities at risk due to policy changes
                                                    </p>
                                                    <div style={{ fontSize: '0.75rem' }}>
                                                        <div>• Budget reconciliation delays → 5 opps affected</div>
                                                        <div>• Regulatory review holds → 2 opps delayed</div>
                                                        <div>• Congressional priorities shift → 1 opp cancelled</div>
                                                    </div>
                                                </div>

                                                <div style={{ 
                                                    padding: '16px', 
                                                    backgroundColor: 'rgba(37, 99, 235, 0.05)', 
                                                    borderRadius: '8px',
                                                    border: '1px solid var(--primary-blue)'
                                                }}>
                                                    <h6 style={{ 
                                                        fontWeight: '600', 
                                                        marginBottom: '8px',
                                                        display: 'flex',
                                                        alignItems: 'center',
                                                        gap: '6px'
                                                    }}>
                                                        <i className="fas fa-lightbulb" style={{ color: 'var(--primary-blue)' }}></i>
                                                        Strategic Recommendations
                                                    </h6>
                                                    <p style={{ fontSize: '0.875rem', color: 'var(--gray-600)', marginBottom: '12px' }}>
                                                        AI-generated strategic guidance based on policy trends
                                                    </p>
                                                    <div style={{ fontSize: '0.75rem' }}>
                                                        <div>• Focus on cybersecurity capabilities</div>
                                                        <div>• Develop AI/ML service offerings</div>
                                                        <div>• Build small business partnerships</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    {/* Correlation Timeline */}
                                    <div className="card">
                                        <div className="card-header">
                                            <h4 className="card-title">
                                                <i className="fas fa-timeline" style={{ color: 'var(--primary-blue)' }}></i>
                                                Policy-Opportunity Timeline
                                            </h4>
                                            <div style={{ display: 'flex', gap: '8px' }}>
                                                <select className="btn" style={{ border: '1px solid var(--gray-300)' }}>
                                                    <option>Next 30 Days</option>
                                                    <option>Next 90 Days</option>
                                                    <option>Next 6 Months</option>
                                                </select>
                                                <button className="btn btn-primary">
                                                    <i className="fas fa-bell"></i> Set Alerts
                                                </button>
                                            </div>
                                        </div>
                                        <div className="card-content">
                                            <div style={{ position: 'relative', paddingLeft: '20px' }}>
                                                {/* Timeline line */}
                                                <div style={{
                                                    position: 'absolute',
                                                    left: '8px',
                                                    top: '10px',
                                                    bottom: '10px',
                                                    width: '2px',
                                                    backgroundColor: 'var(--gray-300)'
                                                }}></div>
                                                
                                                {[
                                                    {
                                                        date: "March 15, 2024",
                                                        event: "NDAA Cybersecurity Requirements Finalized",
                                                        impact: "5 new opportunities expected",
                                                        type: "policy"
                                                    },
                                                    {
                                                        date: "March 28, 2024",
                                                        event: "DHS Security Framework Released",
                                                        impact: "Border Security Tech opportunity opens",
                                                        type: "opportunity"
                                                    },
                                                    {
                                                        date: "April 10, 2024",
                                                        event: "AI Executive Order Implementation",
                                                        impact: "NASA AI opportunity value increases 40%",
                                                        type: "correlation"
                                                    },
                                                    {
                                                        date: "April 22, 2024",
                                                        event: "Small Business Set-Aside Changes",
                                                        impact: "3 opportunities now SB eligible",
                                                        type: "policy"
                                                    }
                                                ].map((item, index) => (
                                                    <div key={index} style={{ 
                                                        position: 'relative', 
                                                        marginBottom: '24px',
                                                        paddingLeft: '20px'
                                                    }}>
                                                        {/* Timeline dot */}
                                                        <div style={{
                                                            position: 'absolute',
                                                            left: '-7px',
                                                            top: '8px',
                                                            width: '14px',
                                                            height: '14px',
                                                            borderRadius: '50%',
                                                            backgroundColor: item.type === 'policy' ? 'var(--primary-blue)' : 
                                                                           item.type === 'opportunity' ? 'var(--success-green)' : 'var(--warning-orange)',
                                                            border: '2px solid white',
                                                            boxShadow: '0 0 0 2px var(--gray-300)'
                                                        }}></div>
                                                        
                                                        <div style={{ 
                                                            backgroundColor: 'white',
                                                            padding: '12px',
                                                            borderRadius: '8px',
                                                            border: '1px solid var(--gray-200)',
                                                            boxShadow: '0 1px 3px rgba(0, 0, 0, 0.1)'
                                                        }}>
                                                            <div style={{ 
                                                                fontSize: '0.75rem', 
                                                                color: 'var(--gray-500)', 
                                                                marginBottom: '4px' 
                                                            }}>
                                                                {item.date}
                                                            </div>
                                                            <div style={{ 
                                                                fontWeight: '600', 
                                                                marginBottom: '4px' 
                                                            }}>
                                                                {item.event}
                                                            </div>
                                                            <div style={{ 
                                                                fontSize: '0.875rem', 
                                                                color: 'var(--gray-600)' 
                                                            }}>
                                                                {item.impact}
                                                            </div>
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [activeView, setActiveView] = useState('dashboard');
            const [metrics, setMetrics] = useState(null);
            const [opportunities, setOpportunities] = useState([]);
            const [analyses, setAnalyses] = useState({});
            const [loading, setLoading] = useState(true);
            const [selectedOpportunity, setSelectedOpportunity] = useState(null);

            useEffect(() => {
                const loadData = async () => {
                    try {
                        const [metricsData, opportunitiesData] = await Promise.all([
                            api.fetchDashboardMetrics(),
                            api.fetchOpportunities({ limit: 20 })
                        ]);
                        
                        setMetrics(metricsData);
                        setOpportunities(opportunitiesData);
                    } catch (error) {
                        console.error('Error loading data:', error);
                    } finally {
                        setLoading(false);
                    }
                };

                loadData();
            }, []);

            const handleAnalyze = async (opportunityId) => {
                try {
                    const analysis = await api.analyzeOpportunity(opportunityId);
                    setAnalyses(prev => ({
                        ...prev,
                        [opportunityId]: analysis
                    }));
                } catch (error) {
                    console.error('Error analyzing opportunity:', error);
                }
            };

            const renderContent = () => {
                if (loading) {
                    return (
                        <div className="loading">
                            <i className="fas fa-spinner fa-spin pulse"></i>
                            <p>Loading your intelligence dashboard...</p>
                        </div>
                    );
                }

                switch (activeView) {
                    case 'dashboard':
                        return (
                            <Dashboard 
                                metrics={metrics} 
                                opportunities={opportunities}
                                analyses={analyses}
                                onAnalyze={handleAnalyze}
                            />
                        );
                    case 'opportunities':
                        return (
                            <GoNoGoView 
                                opportunities={opportunities}
                                analyses={analyses}
                                onAnalyze={handleAnalyze}
                            />
                        );
                    case 'pipeline':
                        return (
                            <PipelineView
                                opportunities={opportunities}
                                analyses={analyses}
                                onAnalyze={handleAnalyze}
                            />
                        );
                    case 'agencies':
                        return <AgencyIntelligenceView />;
                    case 'competitors':
                        return <CompetitiveIntelligenceView />;
                    case 'market':
                        return <SeniorAnalystMarketView />;
                    case 'policy':
                        return <PolicyRegulatoryIntelligenceView />;
                    default:
                        return (
                            <div className="card">
                                <div className="card-content">
                                    <div className="empty-state">
                                        <i className="fas fa-tools"></i>
                                        <h3>{activeView.charAt(0).toUpperCase() + activeView.slice(1)}</h3>
                                        <p>This feature is under development for SMB contractors.</p>
                                        <button className="btn btn-primary" style={{ marginTop: '16px' }}>
                                            Request Feature
                                        </button>
                                    </div>
                                </div>
                            </div>
                        );
                }
            };

            return (
                <div className="app-container">
                    <Sidebar activeView={activeView} setActiveView={setActiveView} />
                    <div className="main-content">
                        <div className="top-bar">
                            <h2>{activeView === 'opportunities' ? 'Go/No-Go Analysis' : activeView.charAt(0).toUpperCase() + activeView.slice(1)}</h2>
                            <div className="search-bar">
                                <i className="fas fa-search"></i>
                                <input type="text" placeholder="Search opportunities, agencies..." />
                            </div>
                            <div className="top-bar-actions">
                                <div className="notification-bell">
                                    <i className="fas fa-bell"></i>
                                    <span className="badge">3</span>
                                </div>
                                <button className="btn">
                                    <i className="fas fa-user"></i> Profile
                                </button>
                            </div>
                        </div>
                        <div className="content-area">
                            {renderContent()}
                        </div>
                    </div>

                    {/* Opportunity Detail Modal */}
                    {selectedOpportunity && (
                        <OpportunityDetailModal
                            opportunity={selectedOpportunity}
                            analysis={analyses[selectedOpportunity.id]}
                            onClose={() => setSelectedOpportunity(null)}
                            onAnalyze={handleAnalyze}
                        />
                    )}
                </div>
            );
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>