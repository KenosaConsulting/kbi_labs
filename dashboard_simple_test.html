<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Dashboard Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-result { margin: 10px 0; padding: 10px; border-radius: 5px; }
        .success { background: #d4edda; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; border: 1px solid #f5c6cb; }
        .loading { background: #fff3cd; border: 1px solid #ffeaa7; }
    </style>
</head>
<body>
    <h1>üîß Simple Dashboard Test</h1>
    <div id="results"></div>
    
    <script>
        async function testDashboard() {
            const results = document.getElementById('results');
            results.innerHTML = '<div class="test-result loading">Testing dashboard APIs...</div>';
            
            try {
                // Test health first
                console.log('Testing health endpoint...');
                const healthResponse = await fetch('/api/government-intelligence/health');
                const healthData = await healthResponse.json();
                
                results.innerHTML += `<div class="test-result success">
                    ‚úÖ Health Check: ${healthData.overall_status}<br>
                    API Keys: ${Object.keys(healthData.api_keys_available).length} available
                </div>`;
                
                // Test comprehensive intelligence
                console.log('Testing comprehensive intelligence...');
                const compResponse = await fetch('/api/government-intelligence/comprehensive-intelligence');
                const compData = await compResponse.json();
                
                if (compData.status === 'success') {
                    const summary = compData.data.executive_summary;
                    results.innerHTML += `<div class="test-result success">
                        ‚úÖ Comprehensive Intelligence Working<br>
                        Active Opportunities: ${summary.active_opportunities}<br>
                        Federal Websites: ${summary.total_federal_websites}<br>
                        Regulations: ${summary.contractor_relevant_regulations}
                    </div>`;
                } else {
                    throw new Error('Comprehensive intelligence failed');
                }
                
                // Test procurement opportunities
                console.log('Testing procurement opportunities...');
                const procResponse = await fetch('/api/government-intelligence/procurement-opportunities');
                const procData = await procResponse.json();
                
                if (procData.status === 'success') {
                    results.innerHTML += `<div class="test-result success">
                        ‚úÖ Procurement Opportunities Working<br>
                        Active: ${procData.data.summary.total_active_opportunities}<br>
                        Small Business: ${procData.data.summary.small_business_opportunities}
                    </div>`;
                } else {
                    throw new Error('Procurement opportunities failed');
                }
                
                results.innerHTML += '<div class="test-result success"><strong>‚úÖ All APIs Working! Dashboard should load properly.</strong></div>';
                results.innerHTML += '<div class="test-result success"><a href="/dashboard" target="_blank" style="color: #007bff; font-size: 18px;">üöÄ Open Main Dashboard</a></div>';
                
            } catch (error) {
                console.error('Test failed:', error);
                results.innerHTML += `<div class="test-result error">‚ùå Error: ${error.message}</div>`;
            }
        }
        
        // Run test on load
        window.onload = testDashboard;
    </script>
</body>
</html>