<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KBI Labs - Minimal Dashboard Test</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; }
        .header { background: linear-gradient(135deg, #2563eb 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 10px; margin-bottom: 20px; }
        .card { background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .loading { color: #6b7280; font-style: italic; }
        .error { color: #ef4444; font-weight: bold; }
        .success { color: #10b981; font-weight: bold; }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        function MinimalDashboard() {
            const [status, setStatus] = useState('loading');
            const [data, setData] = useState(null);
            const [error, setError] = useState(null);
            
            useEffect(() => {
                console.log('Minimal dashboard mounted');
                testConnection();
            }, []);
            
            const testConnection = async () => {
                try {
                    console.log('Testing API connection...');
                    setStatus('loading');
                    
                    // Test health endpoint
                    const healthResponse = await fetch('/api/government-intelligence/health');
                    if (!healthResponse.ok) {
                        throw new Error(`Health check failed: ${healthResponse.status}`);
                    }
                    const healthData = await healthResponse.json();
                    console.log('Health check passed:', healthData);
                    
                    // Test comprehensive intelligence
                    const compResponse = await fetch('/api/government-intelligence/comprehensive-intelligence');
                    if (!compResponse.ok) {
                        throw new Error(`Comprehensive intelligence failed: ${compResponse.status}`);
                    }
                    const compData = await compResponse.json();
                    console.log('Comprehensive intelligence loaded:', compData);
                    
                    setData({
                        health: healthData,
                        intelligence: compData.data
                    });
                    setStatus('success');
                    
                } catch (err) {
                    console.error('API test failed:', err);
                    setError(err.message);
                    setStatus('error');
                }
            };
            
            return (
                <div className="container">
                    <div className="header">
                        <h1>üöÄ KBI Labs - Minimal Dashboard Test</h1>
                        <p>Testing React + API Integration</p>
                    </div>
                    
                    {status === 'loading' && (
                        <div className="card">
                            <div className="loading">üîÑ Loading dashboard data...</div>
                        </div>
                    )}
                    
                    {status === 'error' && (
                        <div className="card">
                            <div className="error">‚ùå Error: {error}</div>
                            <button onClick={testConnection} style={{marginTop: '10px', padding: '10px 20px', background: '#2563eb', color: 'white', border: 'none', borderRadius: '5px', cursor: 'pointer'}}>
                                Retry
                            </button>
                        </div>
                    )}
                    
                    {status === 'success' && data && (
                        <div className="card">
                            <div className="success">‚úÖ Dashboard API Connection Working!</div>
                            <h3>Health Status</h3>
                            <p>Overall Status: {data.health.overall_status}</p>
                            <p>API Keys Available: {Object.keys(data.health.api_keys_available).length}</p>
                            
                            <h3>Intelligence Summary</h3>
                            <p>Active Opportunities: {data.intelligence.executive_summary.active_opportunities}</p>
                            <p>Federal Websites: {data.intelligence.executive_summary.total_federal_websites}</p>
                            <p>Regulations: {data.intelligence.executive_summary.contractor_relevant_regulations}</p>
                            
                            <div style={{marginTop: '20px', padding: '15px', background: '#f0f9ff', border: '1px solid #0ea5e9', borderRadius: '8px'}}>
                                <strong>‚úÖ React + APIs Working!</strong><br/>
                                If this loads but the main dashboard doesn't, the issue is likely in the main dashboard's complex React components or styling.
                                <br/><br/>
                                <a href="/dashboard" target="_blank" style={{color: '#2563eb', fontSize: '16px'}}>üîó Try Main Dashboard Again</a>
                            </div>
                        </div>
                    )}
                </div>
            );
        }
        
        // Log React mount
        console.log('React script loaded, mounting minimal dashboard...');
        ReactDOM.render(<MinimalDashboard />, document.getElementById('root'));
    </script>
</body>
</html>